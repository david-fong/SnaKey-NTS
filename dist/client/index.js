var snakey3=function(e){function t(t){for(var n,s,a=t[0],r=t[1],i=0,c=[];i<a.length;i++)s=a[i],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&c.push(o[s][0]),o[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(l&&l(t);c.length;)c.shift()()}var n={},s={3:0},o={3:0};function a(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.e=function(e){var t=[];s[e]?t.push(s[e]):0!==s[e]&&{0:1}[e]&&t.push(s[e]=new Promise((function(t,n){for(var o="chunk/"+({0:"game/offline~game/online",1:"game/offline",2:"game/online",4:"lang/Cellphone-ts",5:"lang/Emote-ts",6:"lang/English-ts",7:"lang/Japanese-ts",8:"lang/Korean-ts",9:"lang/Morse-ts"}[e]||e)+".css",r=a.p+o,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var l=(d=i[c]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(l===o||l===r))return t()}var u=document.getElementsByTagName("style");for(c=0;c<u.length;c++){var d;if((l=(d=u[c]).getAttribute("data-href"))===o||l===r)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var o=t&&t.target&&t.target.src||r,a=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=o,delete s[e],h.parentNode.removeChild(h),n(a)},h.href=r,document.getElementsByTagName("head")[0].appendChild(h)})).then((function(){s[e]=0})));var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,s){n=o[e]=[t,s]}));t.push(n[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.src=function(e){return a.p+"chunk/"+({0:"game/offline~game/online",1:"game/offline",2:"game/online",4:"lang/Cellphone-ts",5:"lang/Emote-ts",6:"lang/English-ts",7:"lang/Japanese-ts",8:"lang/Korean-ts",9:"lang/Morse-ts"}[e]||e)+".js"}(e);var l=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+s+": "+a+")",l.name="ChunkLoadError",l.type=s,l.request=a,n[1](l)}o[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="dist/client/",a.oe=function(e){throw console.error(e),e};var r=window.webpackJsonpsnakey3=window.webpackJsonpsnakey3||[],i=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var l=i;return a(a.s=6)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var s,o=n(1);!function(e){let t,n,s,o,a,r;e.GLOBAL_IDS={PUBLIC_GAME_HOST_URLS:"public-game-hosts-list",CURRENT_HOST_GROUPS:"current-host-groups-list"},function(e){e.Class={TEXT_SELECT_DISABLED:"text-select-disabled",FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents",INPUT_GROUP:"sk-input-group",INPUT_GROUP_ITEM:"sk-input-group-item"},e.Dataset={COLOUR_SCHEME:"skColourScheme"}}(t=e.General||(e.General={})),function(e){e.Class={BASE:"tile",POINTER_HB:"tile__pointer-hitbox",LANG_CHAR_WRAP:"tile__char",LANG_SEQ:"tile__seq"},e.Dataset={HEALTH:"health"}}(n=e.Tile||(e.Tile={})),function(e){e.Class={GRID:"game-grid",IMPL_BODY:"game-grid-impl-body",KBD_DC:"game-grid-kbd-dc",KBD_DC_ICON:"game-grid-kbd-dc__icon",PAUSE_OL:"game-grid-pause-overlay",PAUSE_OL_ICON:"game-grid-pause-overlay__icon"},e.Dataset={IMPL_COORD_SYS:"coordSys",GAME_STATE:{KEY:"gameState",VALUES:{PLAYING:"playing",PAUSED:"paused",OVER:"over"}}}}(s=e.Grid||(e.Grid={})),function(e){e.Class={BASE:"player",FACE:"player__face",DOWNED_OVERLAY:"player__downed-overlay",SHORT_SPOTLIGHT:"player__spotlight-short",LONG_SPOTLIGHT:"player__spotlight-long"},e.Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"}}(o=e.Player||(e.Player={})),function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"sk-screen"},e.Dataset={CURRENT:"current"},function(e){let t,n,s;!function(e){e.Class={BASE:"screen-home",NAV:"screen-home--nav",NAV_PLAY_OFFLINE:"screen-home--nav--play-offline",NAV_PLAY_ONLINE:"screen-home--nav--play-online",NAV_HOW_TO_PLAY:"screen-home--nav--how-to-play",NAV_HOW_TO_HOST:"screen-home--nav--how-to-host",NAV_COLOURS:"screen-home--nav--colour-scheme",NAV_VIEW_REPO:"screen-home--nav--goto-repo",NAV_RPT_ISSUE:"screen-home--nav--report-issue"}}(t=e.Home||(e.Home={})),function(e){e.Class={BASE:"screen-play",GRID_CONTAINER:"screen-play--grid-container",CONTROLS_BAR:"screen-play--controls-bar",PLAYERS_BAR:"screen-play--players-bar"}}(n=e.PlayGame||(e.PlayGame={})),function(e){e.Class={BASE:"screen-joiner",CONTENT_WRAPPER:"screen-joiner--content-wrapper",HOST_URL:"screen-joiner--host-url",GROUP_NAME:"screen-joiner--group-name",PASSPHRASE:"screen-joiner--passphrase",NEXT_BUTTON:"screen-joiner--next-button"}}(s=e.GroupJoiner||(e.GroupJoiner={}))}(t=e.Impl||(e.Impl={}))}(a=e.Screen||(e.Screen={})),function(e){e.Class={BASE:"sk-pick-one",OPT_BASE:"sk-pick-one--opt"}}(r=e.SkPickOne||(e.SkPickOne={}))}(s||(s={})),Object.freeze(s.Player.Dataset.DOWNED),Object(o.d)(s)},function(e,t,n){"use strict";var s;function o(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function a(e){for(const t of Object.getOwnPropertyNames(e)){const n=e[t];"object"==typeof n&&a(n)}return Object.freeze(e)}n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.NEVER="Never happens. See comment in source."}(s||(s={}));class r{}!function(e){let t;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,function(e){e.NULL=void 0}(t=e.Id||(e.Id={})),e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType}(r||(r={})),Object.freeze(r),Object.freeze(r.prototype);class i{}!function(e){let t,n,s;!function(e){e.REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$")}(t=e.Seq||(e.Seq={})),function(e){e.NULL=Object.freeze({char:"",seq:""})}(n=e.CharSeqPair||(e.CharSeqPair={})),function(e){e.SEQ="SEQ",e.CHAR="CHAR",e.WEIGHT="WEIGHT"}(s=e.BalancingScheme||(e.BalancingScheme={})),e.__RemapTemplates=Object.freeze({IDENTITY:e=>e,TO_LOWER:e=>e.toLowerCase()}),e.__RemapTemplates,e.FrontendDescs=Object.freeze([{id:"engl-low",module:"English",export:"Lowercase",numLeaves:26,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"English Lowercase (QWERTY)",blurb:""},{id:"engl-mix",module:"English",export:"MixedCase",numLeaves:52,remapFunc:e.__RemapTemplates.IDENTITY,displayName:"English Mixed-Case (QWERTY)",blurb:""},{id:"japn-hir",module:"Japanese",export:"Hiragana",numLeaves:71,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"Japanese Hiragana",blurb:""},{id:"japn-kat",module:"Japanese",export:"Katakana",numLeaves:70,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"Japanese Katakana",blurb:""},{id:"kore-dub",module:"Korean",export:"Dubeolsik",numLeaves:9177,remapFunc:e.__RemapTemplates.IDENTITY,displayName:"Korean Dubeolsik (두벌식 키보드)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},{id:"kore-sub",module:"Korean",export:"Sebeolsik",numLeaves:10206,remapFunc:e.__RemapTemplates.IDENTITY,displayName:"Korean Sebeolsik (세벌식 최종 키보드)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},{id:"kore-rom",module:"Korean",export:"Romanization",numLeaves:3990,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (국어의 로마자 표기법; 國語의 로마字 表記法) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"}].map(e=>Object.freeze(e))),e.FrontendDescs,e.GET_FRONTEND_DESC_BY_ID=function(t){const n=e.FrontendDescs.find(e=>e.id===t);if(!n)throw new Error(`Frontend descriptor of language with id "${t}" not found.`);return n}}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype)},function(e,t,n){"use strict";var s;n.d(t,"a",(function(){return s})),function(e){let t,n,s,o;!function(e){e.SERVER="SERVER",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(t=e.Type||(e.Type={})),function(e){e.EVENT_NAME="game-create"}(n=e.CtorArgs||(e.CtorArgs={})),function(e){e.EVENT_NAME="game-reset"}(s=e.Serialization||(e.Serialization={})),function(e){e.PLAYING="PLAYING",e.PAUSED="PAUSED",e.OVER="OVER"}(o=e.Status||(e.Status={})),e.K=Object.freeze({HEALTH_UPDATE_CHANCE:.1,PCT_MOVES_THAT_ARE_BOOST:.05,HEALTH_EFFECT_FOR_DOWNED_PLAYER:.6,EVENT_RECORD_WRAPPING_BUFFER_LENGTH:128,EVENT_RECORD_FORWARD_WINDOW_LENGTH:64})}(s||(s={})),Object.freeze(s)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var s,o=n(1);!function(e){let t;!function(e){e.EUCLID2="EUCLID2",e.BEEHIVE="BEEHIVE"}(t=e.System||(e.System={}));class n{constructor(e){}}e.Abstract=n,function(t){class n extends e.Abstract{}t.Mathy=n}(n=e.Abstract||(e.Abstract={})),Object.freeze(n),Object.freeze(n.prototype)}(s||(s={})),Object.freeze(s);var a,r,i,c,l=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},u=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class d{constructor(e){a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),c.set(this,void 0),this.coord=e,l(this,a,o.b.Id.NULL)}reset(){this.evictOccupant(),this.lastKnownUpdateId=0,this.freeHealth=0,this.setLangCharSeqPair(o.a.CharSeqPair.NULL)}__setOccupant(e,t){l(this,a,e)}get isOccupied(){return this.occupantId!==o.b.Id.NULL}evictOccupant(){l(this,a,o.b.Id.NULL)}get occupantId(){return u(this,a)}get freeHealth(){return u(this,r)}set freeHealth(e){l(this,r,e)}setLangCharSeqPair(e){l(this,i,e.char),l(this,c,e.seq)}get langChar(){return u(this,i)}get langSeq(){return u(this,c)}}a=new WeakMap,r=new WeakMap,i=new WeakMap,c=new WeakMap,Object.freeze(d),Object.freeze(d.prototype)},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"OmHooks",(function(){return r.a})),n.d(t,"top",(function(){return ae}));var s,o,a,r=n(0),i=function(e,t,n,s){return new(n||(n=Promise))((function(o,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function i(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((s=s.apply(e,t||[])).next())}))},c=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},l=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class u{constructor(e,t,n,a){s.set(this,void 0),o.set(this,void 0),this.screenId=e,this.toplevel=t,c(this,s,n),this.requestGoToScreen=a,c(this,o,!1)}get initialScreen(){return this.screenId}enter(e){return i(this,void 0,void 0,(function*(){if(!l(this,o)){const e=this.baseElem=document.createElement("div");e.classList.add(r.a.Screen.Class.BASE),this.__lazyLoad(),l(this,s).appendChild(e);const t=this.screenId.replace(/[A-Z]/g,e=>" "+e);{const n=t.toUpperCase();e.insertAdjacentHTML("beforebegin",`\x3c!-- ${n} SCREEN --\x3e`)}{const n=t.split(" ").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join(" ");e.setAttribute("aria-label",n+" Screen")}c(this,o,!0)}const t=new window.URL(window.location.href);t.hash=this.screenId,history.replaceState(null,"",t.href),yield this.__abstractOnBeforeEnter(e),window.requestAnimationFrame(e=>{this.baseElem.dataset[r.a.Screen.Dataset.CURRENT]="",this.baseElem.setAttribute("aria-hidden","false")})}))}leave(){return!!this.__abstractOnBeforeLeave()&&(delete this.baseElem.dataset[r.a.Screen.Dataset.CURRENT],this.baseElem.setAttribute("aria-hidden","true"),!0)}__abstractOnBeforeEnter(e){return i(this,void 0,void 0,(function*(){}))}__abstractOnBeforeLeave(){return!0}}s=new WeakMap,o=new WeakMap,function(e){let t;!function(e){e.HOME="home",e.HOW_TO_PLAY="howToPlay",e.HOW_TO_HOST="howToHost",e.COLOUR_CTRL="colourControl",e.SETUP_OFFLINE="setupOffline",e.PLAY_OFFLINE="playOffline",e.GROUP_JOINER="groupJoiner",e.SETUP_ONLINE="setupOnline",e.GROUP_LOBBY="groupLobby",e.PLAY_ONLINE="playOnline"}(t=e.Id||(e.Id={}))}(u||(u={})),Object.freeze(u),Object.freeze(u.prototype);class d extends u{__lazyLoad(){const e=r.a.Screen.Impl.Home.Class;this.baseElem.classList.add(r.a.General.Class.CENTER_CONTENTS,e.BASE);const t=this.navElem=document.createElement("div");t.classList.add(r.a.General.Class.TEXT_SELECT_DISABLED,r.a.General.Class.INPUT_GROUP,e.NAV),t.setAttribute("role","navigation"),t.addEventListener("pointerleave",()=>{var e;(null===(e=document.activeElement)||void 0===e?void 0:e.parentElement)===t&&document.activeElement.blur()});const n=(e,n)=>{e.classList.add(r.a.General.Class.CENTER_CONTENTS,r.a.General.Class.INPUT_GROUP_ITEM,n.cssClass),e.textContent=n.text,e.addEventListener("pointerenter",()=>{window.requestAnimationFrame(t=>{e.focus()}),this.toplevel.sfx}),t.appendChild(e)};[{text:"Offline Single-player",cssClass:e.NAV_PLAY_OFFLINE,screenId:u.Id.SETUP_OFFLINE},{text:"Online Multi-player",cssClass:e.NAV_PLAY_ONLINE,screenId:u.Id.GROUP_JOINER},{text:"How To Play",cssClass:e.NAV_HOW_TO_PLAY,screenId:u.Id.HOW_TO_PLAY},{text:"How To Host",cssClass:e.NAV_HOW_TO_HOST,screenId:u.Id.HOW_TO_HOST},{text:"Colour Schemes",cssClass:e.NAV_COLOURS,screenId:u.Id.COLOUR_CTRL}].map(e=>Object.freeze(e)).forEach(e=>{const t=document.createElement("button");t.onclick=e.screenId instanceof Function?e.screenId:()=>{this.requestGoToScreen(e.screenId,{})},n(t,e)}),[{text:"Visit\nRepo",cssClass:e.NAV_VIEW_REPO,href:new window.URL("https://github.com/david-fong/SnaKey-NTS")},{text:"Report\nIssue",cssClass:e.NAV_RPT_ISSUE,href:new window.URL("https://github.com/david-fong/SnaKey-NTS/issues")}].map(e=>Object.freeze(e)).forEach(e=>{const t=document.createElement("a");t.href=e.href.toString(),t.referrerPolicy="strict-origin-when-cross-origin",t.rel="noopener",t.target="_blank",n(t,e)}),this.baseElem.appendChild(t)}}Object.freeze(d),Object.freeze(d.prototype);class h extends u{__lazyLoad(){}}Object.freeze(h),Object.freeze(h.prototype);class p extends u{__lazyLoad(){}}(p||(p={})).INSTRUCTIONS_STEPS=Object.freeze(["$ npm install 'https://github.com/david-fong/SnaKey-NTS#gh-pages'","$ npm run start","send the url to your friends"]),Object.freeze(p),Object.freeze(p.prototype),function(e){let t;e.LocalKeys=Object.freeze({MUSIC_VOLUME:"musicVolume",SFX_VOLUME:"sfxVolume",COLOUR_ID:"colourSchemeId",COLOUR_LITERAL:"colourSchemeStyleLiteral",GAME_PRESET:"gamePresetId",USERNAME:"username",AVATAR:"avatarId"}),e.SessionKeys=Object.freeze({}),function(e){let t;e.DB_NAME="snakeyDB",function(e){e.STORE_NAME="userGamePresets"}(t=e.UserGamePresetStore||(e.UserGamePresetStore={})),Object.freeze(t)}(t=e.IDB||(e.IDB={})),Object.freeze(t)}(a||(a={})),Object.freeze(a);var m,E,O,f,_,g,v,b=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},S=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class T{constructor(){m.set(this,void 0),E.set(this,void 0),O.set(this,void 0);const e=document.createElement("div");e.tabIndex=0,e.classList.add(r.a.SkPickOne.Class.BASE),e.addEventListener("keydown",this.onKeyDown.bind(this)),e.setAttribute("role","listbox"),e.addEventListener("pointerenter",t=>{window.requestAnimationFrame(t=>{e.focus()})}),this.baseElem=e,this.options=[]}addOption(e){this.options.push(e),this.baseElem.appendChild(e.baseElem),e.baseElem.addEventListener("pointerenter",this.hoverOpt.bind(this,e)),e.baseElem.addEventListener("click",this.selectOpt.bind(this,e,!0)),e.__registerParent(this.onOptDisabledChange.bind(this))}hoverOpt(e){var t;this.hoveredOpt!==e&&(null===(t=this.hoveredOpt)||void 0===t||t.baseElem.setAttribute("aria-active-descendant","false"),b(this,E,e),this.hoveredOpt.baseElem.setAttribute("aria-active-descendant","true"))}selectOpt(e,t=!0){var n;if(!e)throw new Error("opt must be defined");this.hoverOpt(e),this.confirmedOpt!==e&&(null===(n=this.confirmedOpt)||void 0===n||n.baseElem.setAttribute("aria-selected","false"),b(this,m,e),this.confirmedOpt.baseElem.setAttribute("aria-selected","true"),t&&this.__onSelectOpt(e))}get confirmedOpt(){return S(this,m)}get hoveredOpt(){return S(this,E)}onOptDisabledChange(e){this.confirmedOpt===e&&(this.validity=!e.disabled)}set validity(e){this.validity!==e&&(this.baseElem.setAttribute("aria-invalid",e?"false":"true"),b(this,O,e))}get validity(){return S(this,O)}onKeyDown(e){if(" "===e.key||"Enter"===e.key)return this.selectOpt(this.hoveredOpt),e.preventDefault(),!1;{const t=this.options.indexOf(this.hoveredOpt);if("ArrowDown"===e.key||"Down"===e.key)for(let n=t+1;n<this.options.length;n++){const t=this.options[n];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}else if("ArrowUp"===e.key||"Up"===e.key)for(let n=t-1;n>=0;n--){const t=this.options[n];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}}return!0}}m=new WeakMap,E=new WeakMap,O=new WeakMap,f=T||(T={}),_=new WeakMap,g=new WeakMap,f.__Option=class{constructor(){_.set(this,void 0),g.set(this,void 0);const e=this.baseElem=document.createElement("div");e.classList.add(r.a.SkPickOne.Class.OPT_BASE),e.setAttribute("role","option"),b(this,_,!1)}__registerParent(e){b(this,g,e)}get disabled(){return S(this,_)}set disabled(e){this.disabled!==e&&(this.baseElem.setAttribute("aria-disabled",e?"true":"false"),b(this,_,e),S(this,g).call(this,this))}},Object.freeze(f),Object.freeze(f.prototype),Object.freeze(T),Object.freeze(T.prototype),n(5);class y extends u{constructor(){super(...arguments),this.canBeInitialScreen=!0}__lazyLoad(){const e=new y.PickOne;this.baseElem.appendChild(e.baseElem),this.sel=e;const t=localStorage.getItem(a.LocalKeys.COLOUR_ID);t&&this.sel.selectOpt(this.sel.getOptById(t),!1)}}!function(e){class t extends T{constructor(){if(super(),this.garageDoorElem=document.getElementById(r.a.Screen.Id.SCREEN_TINT),!this.garageDoorElem)throw new Error;this.garageDoorElem.style.transitionDuration=v.SMOOTH_CHANGE_DURATION/3+"ms",v.Schemes.forEach(e=>{this.addOption(new t.Option(e))}),this.selectOpt(this.getOptById("snakey"),!1)}__onHoverOpt(e){}__onSelectOpt(e){localStorage.setItem(a.LocalKeys.COLOUR_ID,e.desc.id),localStorage.setItem(a.LocalKeys.COLOUR_LITERAL,e.cssLiteral);const t=v.SMOOTH_CHANGE_DURATION/3+80;setTimeout(()=>{this.garageDoorElem.style.opacity=1..toString(),setTimeout(()=>{document.documentElement.dataset[r.a.General.Dataset.COLOUR_SCHEME]=e.desc.id,setTimeout(()=>{this.garageDoorElem.style.opacity=(0).toString()},t)},t)},t)}getOptById(e){return this.options.find(t=>t.desc.id===e)}}e.PickOne=t,function(e){class t extends T.__Option{constructor(e){super(),this.desc=e}}e.Option=t,Object.freeze(t),Object.freeze(t.prototype)}(t=e.PickOne||(e.PickOne={})),Object.freeze(t),Object.freeze(t.prototype)}(y||(y={})),Object.freeze(y),Object.freeze(y.prototype),function(e){e.Swatch=Object.freeze(["mainFg","mainBg","tileFg","tileBg","tileBd","healthFg","healthBg","pFaceMe","pFaceMeOpp","pFaceTeammate","pFaceImtlTeammate","pFaceOpponent","pFaceImtlOpponent"]),e.Schemes=Object.freeze([{id:"snakey",displayName:"Snakey",author:"N.W."},{id:"smooth-stone",displayName:"Smooth Stone",author:"Dav"}].map(e=>Object.freeze(e))),e.SMOOTH_CHANGE_DURATION=2e3}(v||(v={})),Object.freeze(v);var N=n(1),L=n(3);class I extends u{__lazyLoad(){this.langSel=new I.LangPickOne,this.baseElem.appendChild(this.langSel.baseElem);const e=this.nextBtn=document.createElement("button");e.textContent="Next",this.baseElem.appendChild(e)}}!function(e){class t extends T{constructor(){super(),N.a.FrontendDescs.forEach(e=>{this.addOption(new t.Option(e))}),this.selectOpt(this.options[0])}__onHoverOpt(e){}__onSelectOpt(e){}}e.LangPickOne=t,function(e){class t extends T.__Option{constructor(e){super(),this.desc=e,this.baseElem.textContent=e.displayName}}e.Option=t,Object.freeze(t),Object.freeze(t.prototype)}(t=e.LangPickOne||(e.LangPickOne={}))}(I||(I={})),Object.freeze(I),Object.freeze(I.prototype);class C extends I{__abstractOnBeforeEnter(e){return this.nextBtn.onclick=e=>{const t=Object.assign({},C.DEFAULT_PRESET);t.langId=this.langSel.confirmedOpt.desc.id,this.requestGoToScreen(u.Id.PLAY_OFFLINE,t)},Promise.resolve()}}(C||(C={})).DEFAULT_PRESET={coordSys:L.a.System.EUCLID2,gridDimensions:{height:21,width:21},averageFreeHealthPerTile:1/45,langBalancingScheme:N.a.BalancingScheme.WEIGHT,langId:"engl-low",playerDescs:[{isALocalOperator:!0,familyId:"HUMAN",teamId:0,socketId:void 0,username:"hello1",noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!0,familyId:"HUMAN",teamId:1,socketId:void 0,username:"hello2",noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,socketId:void 0,username:"chaser1",noCheckGameOver:!0,familyArgs:{fearDistance:5,bloodThirstDistance:7,healthReserve:3,movesPerSecond:2}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,socketId:void 0,username:"chaser2",noCheckGameOver:!0,familyArgs:{fearDistance:5,bloodThirstDistance:7,healthReserve:3,movesPerSecond:2}}]},Object.freeze(C),Object.freeze(C.prototype);var A,R,P,w,G=n(2),k=function(e,t,n,s){return new(n||(n=Promise))((function(o,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function i(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((s=s.apply(e,t||[])).next())}))},U=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},B=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};class H extends u{constructor(){super(...arguments),A.set(this,void 0),R.set(this,void 0),P.set(this,void 0),w.set(this,void 0)}__lazyLoad(){this.baseElem.classList.add(r.a.Screen.Impl.PlayGame.Class.BASE);const e=H.createCenterColElem();this.gridElem=e.gridElem,this.baseElem.appendChild(e.baseElem),this.initializeControlsBar(),this.initializePlayersBar(),B(this,R,()=>{if(this.wantsAutoPause)if(document.hidden){if(void 0===U(this,w)){const e=this.currentGame;(!e||e&&e.status!==G.a.Status.OVER)&&this.statusBecomePaused()}}else"page-hide"===U(this,w)&&this.statusBecomePlaying()}),B(this,P,this.__gridKeyDownCallback.bind(this))}__abstractOnBeforeEnter(e){return k(this,void 0,void 0,(function*(){document.addEventListener("visibilitychange",U(this,R)),this.pauseButton.disabled=!0,this.statusBecomePaused(),B(this,A,yield this.__createNewGame(e)),this.gridElem.addEventListener("keydown",U(this,P)),yield this.currentGame.reset();const t=this.currentGame.htmlElements;this.gridElem.insertAdjacentElement("afterbegin",t.gridImpl),this.playersBar.appendChild(t.playersBar),this.pauseButton.onclick=this.statusBecomePlaying.bind(this),this.pauseButton.disabled=!1,this.wantsAutoPause&&setTimeout(()=>{document.hidden||this.statusBecomePlaying()},500)}))}__abstractOnBeforeLeave(){if(!window.confirm("Are you sure you would like to leave?"))return!1;document.removeEventListener("visibilitychange",U(this,R));for(const e of Object.values(this.currentGame.htmlElements))e.remove();return this.gridElem.removeEventListener("keydown",U(this,P)),B(this,A,void 0),!0}get currentGame(){return U(this,A)}__gridKeyDownCallback(e){const t=this.currentGame;if(e.ctrlKey&&" "===e.key&&!e.repeat){const e=t.operators;t.setCurrentOperator((1+e.indexOf(t.currentOperator))%e.length)}else t.currentOperator.processKeyboardInput(e);return" "!==e.key||(e.preventDefault(),!1)}statusBecomePlaying(){var e;const t=r.a.Grid.Dataset.GAME_STATE;null===(e=this.currentGame)||void 0===e||e.statusBecomePlaying(),this.pauseButton.textContent="Pause",B(this,w,void 0),this.gridElem.dataset[t.KEY]=t.VALUES.PLAYING,window.requestAnimationFrame(e=>{this.pauseButton.onclick=this.statusBecomePaused.bind(this),this.resetButton.disabled=!0,this.gridElem.focus()})}statusBecomePaused(){var e;const t=r.a.Grid.Dataset.GAME_STATE;null===(e=this.currentGame)||void 0===e||e.statusBecomePaused(),this.pauseButton.textContent="Unpause",B(this,w,document.hidden?"page-hide":"other"),this.gridElem.dataset[t.KEY]=t.VALUES.PAUSED,this.pauseButton.onclick=this.statusBecomePlaying.bind(this),this.resetButton.disabled=!1}__onGameBecomeOver(){const e=r.a.Grid.Dataset.GAME_STATE;this.pauseButton.disabled=!0,this.resetButton.disabled=!1,this.gridElem.dataset[e.KEY]=e.VALUES.OVER}__resetGame(){this.currentGame.reset(),this.pauseButton.disabled=!1,this.wantsAutoPause&&this.statusBecomePlaying()}initializeControlsBar(){const e=document.createElement("div");function t(t){const n=document.createElement("button");return n.textContent=t,n.classList.add(r.a.General.Class.INPUT_GROUP_ITEM),n.addEventListener("pointerenter",e=>{window.requestAnimationFrame(e=>{n.focus()})}),e.appendChild(n),n}e.classList.add(r.a.General.Class.INPUT_GROUP,r.a.Screen.Impl.PlayGame.Class.CONTROLS_BAR),e.setAttribute("role","menu"),e.addEventListener("pointerleave",e=>{window.requestAnimationFrame(e=>{this.gridElem.focus()})});(this.backToHomeButton=t("Return To Homepage")).onclick=this.requestGoToScreen.bind(this,u.Id.HOME);this.pauseButton=t("");(this.resetButton=t("Reset")).onclick=this.__resetGame.bind(this);this.baseElem.appendChild(e)}initializePlayersBar(){const e=this.playersBar=document.createElement("div");e.classList.add(r.a.Screen.Impl.PlayGame.Class.PLAYERS_BAR),this.baseElem.appendChild(e)}}A=new WeakMap,R=new WeakMap,P=new WeakMap,w=new WeakMap,(H||(H={})).createCenterColElem=function(){const e=r.a.General.Class,t=document.createElement("div");t.classList.add(e.CENTER_CONTENTS,r.a.Screen.Impl.PlayGame.Class.GRID_CONTAINER);const n=document.createElement("div");n.tabIndex=0,n.setAttribute("role","textbox"),n.setAttribute("aria-label","Game Grid"),n.classList.add(e.CENTER_CONTENTS,e.STACK_CONTENTS,e.TEXT_SELECT_DISABLED,r.a.Grid.Class.GRID);{const t=document.createElement("div");t.classList.add(e.CENTER_CONTENTS,r.a.Grid.Class.KBD_DC);{const e=document.createElement("div");e.classList.add(r.a.Grid.Class.KBD_DC_ICON),e.textContent="(click here to continue typing)",t.appendChild(e)}n.appendChild(t)}{const t=document.createElement("div");t.classList.add(e.CENTER_CONTENTS,r.a.Grid.Class.PAUSE_OL);{const e=document.createElement("div");e.classList.add(r.a.Grid.Class.PAUSE_OL_ICON),e.textContent="(The Game is Paused)",t.appendChild(e)}n.appendChild(t)}return t.appendChild(n),Object.freeze({baseElem:t,gridElem:n})},Object.freeze(H),Object.freeze(H.prototype);var D=function(e,t,n,s){return new(n||(n=Promise))((function(o,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function i(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((s=s.apply(e,t||[])).next())}))};class x extends H{constructor(){super(...arguments),this.wantsAutoPause=!0}get initialScreen(){return u.Id.SETUP_OFFLINE}__lazyLoad(){super.__lazyLoad()}__createNewGame(e){return D(this,void 0,void 0,(function*(){return new((yield Promise.all([n.e(0),n.e(1)]).then(n.bind(null,26))).OfflineGame)(this.__onGameBecomeOver.bind(this),e)}))}}Object.freeze(x),Object.freeze(x.prototype);class j{}!function(e){let t;e.PROTOCOL="http://",e.DEFAULT_PORT=8080,function(e){e.GROUP_LOBBY_PREFIX="/group-",e.GROUP_JOINER="/joiner"}(t=e.Nsps||(e.Nsps={}))}(j||(j={})),Object.freeze(j),Object.freeze(j.prototype);class z{}!function(e){let t,n,s;!function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(t=e.Name||(e.Name={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(n=e.Passphrase||(e.Passphrase={})),e.JoinerReconnectionAttempts=2,e.DEFAULT_TTL=60,function(e){e.EVENT_NAME="group-exist";class t{constructor(e,t){this.groupName=e,this.passphrase=t}}let n;e.RequestCreate=t,function(e){let t;!function(e){e.OKAY="okay",e.NOPE="nope"}(t=e.Response||(e.Response={}))}(t=e.RequestCreate||(e.RequestCreate={})),function(e){e.IN_LOBBY="in-lobby",e.IN_GAME="in-game",e.DELETE="delete"}(n=e.Status||(e.Status={}))}(s=e.Exist||(e.Exist={}))}(z||(z={})),Object.freeze(z),Object.freeze(z.prototype);var F,M=function(e,t,n,s){return new(n||(n=Promise))((function(o,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function i(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((s=s.apply(e,t||[])).next())}))},W=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},Y=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};class V extends u{constructor(){super(...arguments),F.set(this,void 0)}__lazyLoad(){this.baseElem.classList.add(r.a.General.Class.CENTER_CONTENTS,r.a.Screen.Impl.GroupJoiner.Class.BASE);const e=this.__initializeFormContents(),t=this.__initializeHostUrlHandlers();this.__initializeGroupNameHandlers(t),this.__initializePassphraseHandlers(),e.onsubmit=e=>{this.requestGoToScreen(u.Id.PLAY_ONLINE,{})},this.__setFormState(K.CHOOSING_HOST),this.baseElem.appendChild(e)}__abstractOnBeforeEnter(e){return M(this,void 0,void 0,(function*(){window.setTimeout(()=>{this.socket&&this.socket.nsp.startsWith(j.Nsps.GROUP_LOBBY_PREFIX)?this.groupNameInput.focus():this.hostUrlInput.focus()},100)}))}get state(){return W(this,F)}__setFormState(e){if(this.state!==e){if(e===K.IN_GROUP){if(this.state!==K.CHOOSING_GROUP)throw new Error("never");this.passphraseInput.disabled=!0,this.nextButton.disabled=!1,this.nextButton.focus()}else this.nextButton.disabled=!0,e===K.CHOOSING_HOST?(this.groupNameInput.disabled=!0,this.groupNameInput.value="",this.groupNameDataList.replaceWith(this.groupNameDataList.cloneNode()),this.passphraseInput.disabled=!0,this.passphraseInput.value="",this.hostUrlInput.focus()):e===K.CHOOSING_GROUP&&(this.groupNameInput.disabled=!1,this.passphraseInput.disabled=!1,this.groupNameInput.focus());Y(this,F,e)}}__initializeHostUrlHandlers(){const e=this.toplevel,t=this.hostUrlInput,n=()=>M(this,void 0,void 0,(function*(){var n;if(t.value.startsWith(j.PROTOCOL)||(t.value=new URL(j.PROTOCOL+t.value).origin),!t.value||!t.validity.valid)return;const s=new URL(t.value+j.Nsps.GROUP_JOINER);if(this.socket&&this.socket.nsp===j.Nsps.GROUP_JOINER&&this.socket.io.opts.hostname===s.hostname)return this.socket.connected?(this.__setFormState(K.CHOOSING_GROUP),void this.groupNameInput.focus()):void 0;null===(n=this.socket)||void 0===n||n.close(),this.socket=(yield e.socketIo)(s.toString(),{reconnectionAttempts:z.JoinerReconnectionAttempts}),this.socket.on("connect",()=>{this.__setFormState(K.CHOOSING_GROUP),this.socket.on(z.Exist.EVENT_NAME,this.onNotifyGroupExist.bind(this))}),this.socket.on("connect_error",e=>{this.socket=void 0,this.toplevel.toast("Unable to connected to the specified server.")}),this.socket.on("disconnect",n=>{"io server disconnect"===n&&(this.socket=void 0,this.__setFormState(K.CHOOSING_HOST),t.value="",e.toast("The server disconnected you from the group joiner."))})}));return t.oninput=e=>this.__setFormState(K.CHOOSING_HOST),t.onkeydown=e=>{"Enter"===e.key&&n()},t.onpaste=e=>{window.setTimeout(()=>n(),0)},t.onchange=()=>{n()},n}onNotifyGroupExist(e){if(e===z.Exist.RequestCreate.Response.NOPE)return void this.toplevel.toast(`The server rejected your request to create a new group "${this.groupNameInput.value}".`);const t=this.groupNameDataList,n=Array.from(t.children);for(const[s,o]of Object.entries(e)){const e=n.find(e=>e.value===s)||(()=>{const e=document.createElement("option");e.value=s;for(const s of n)if(e.value.localeCompare(s.value)<0){t.insertBefore(e,s);break}return e.parentElement||t.appendChild(e),e})();switch(o){case z.Exist.Status.IN_LOBBY:e.remove();break;case z.Exist.Status.IN_GAME:e.textContent="In Game";break;case z.Exist.Status.DELETE:e.textContent="In Lobby"}}e===z.Exist.RequestCreate.Response.OKAY&&(console.info(`server accepted request to create new group \`${this.groupNameInput.value}\`.`),console.log("connecting to new group..."),this.attemptToJoinExistingGroup())}__initializeGroupNameHandlers(e){const t=this.groupNameInput,n=()=>{t.value&&t.validity.valid&&(this.state===K.IN_GROUP?this.nextButton.focus():this.passphraseInput.focus())};this.groupNameInput.oninput=t=>M(this,void 0,void 0,(function*(){this.state===K.IN_GROUP&&(yield e()),this.passphraseInput.value=""})),t.onkeydown=e=>{"Enter"===e.key&&n()},t.onchange=e=>{n()}}__initializePassphraseHandlers(){const e=()=>M(this,void 0,void 0,(function*(){if(!this.passphraseInput.validity.valid)return;if(this.socket.nsp===j.Nsps.GROUP_LOBBY_PREFIX+this.groupNameInput.value)return this.socket.connected?(this.__setFormState(K.IN_GROUP),void this.nextButton.focus()):void 0;Array.from(this.groupNameDataList.children).some(e=>e.value===this.groupNameInput.value)?yield this.attemptToJoinExistingGroup():this.socket.emit(z.Exist.EVENT_NAME,new z.Exist.RequestCreate(this.groupNameInput.value,this.passphraseInput.value))}));this.passphraseInput.onkeydown=t=>{"Enter"===t.key&&e()}}attemptToJoinExistingGroup(){var e;return M(this,void 0,void 0,(function*(){const t=(()=>{const e=new URL(this.hostUrlInput.value);return e.pathname=j.Nsps.GROUP_LOBBY_PREFIX+this.groupNameInput.value,e.toString()})();null===(e=this.socket)||void 0===e||e.close();const n=this.toplevel;this.socket=(yield n.socketIo)(t,{query:{passphrase:this.passphraseInput.value}}),this.socket.on("connect",()=>{this.__setFormState(K.IN_GROUP)}),this.socket.on("connect_error",e=>{this.socket=void 0,n.toast("Unable to connect to the specified group.")}),this.socket.on("disconnect",e=>{"io server disconnect"===e&&(this.socket=void 0,n.toast("The server disconnected you from your group."))})}))}get socket(){return this.toplevel.socket}set socket(e){this.toplevel.socket=e}__initializeFormContents(){const e=r.a.Screen.Impl.GroupJoiner.Class,t=document.createElement("form");function n(e){const n=document.createElement("input");n.classList.add(r.a.General.Class.INPUT_GROUP_ITEM),n.type="text",n.autocomplete="off",n.spellcheck=!1;const s=document.createElement("label");return s.textContent=e,s.appendChild(n),t.appendChild(s),n}t.classList.add(r.a.General.Class.INPUT_GROUP,e.CONTENT_WRAPPER);{const t=this.hostUrlInput=n("Host URL");t.type="url",t.classList.add(e.HOST_URL),t.autocomplete="on";const s=V.SUGGEST_HOST(this.toplevel.webpageHostType);if(s){const e=document.createElement("option");e.value=s.value,e.textContent=s.description,document.getElementById(r.a.GLOBAL_IDS.PUBLIC_GAME_HOST_URLS).insertAdjacentElement("afterbegin",e)}t.setAttribute("list",r.a.GLOBAL_IDS.PUBLIC_GAME_HOST_URLS),t.maxLength=128}{const t=this.groupNameInput=n("Group Name");t.classList.add(e.GROUP_NAME),t.pattern=z.Name.REGEXP.source,t.maxLength=z.Name.MaxLength;const s=this.groupNameDataList=document.createElement("datalist");s.id=r.a.GLOBAL_IDS.CURRENT_HOST_GROUPS,this.baseElem.appendChild(s),t.setAttribute("list",s.id)}{const t=this.passphraseInput=n("Group Passphrase");t.classList.add(e.PASSPHRASE),t.pattern=z.Passphrase.REGEXP.source,t.maxLength=z.Passphrase.MaxLength}{const n=this.nextButton=document.createElement("input");n.type="submit",n.classList.add(r.a.General.Class.INPUT_GROUP_ITEM,e.NEXT_BUTTON),n.textContent=n.value="Next",t.appendChild(n)}return t}}F=new WeakMap,function(e){let t;!function(e){e.CHOOSING_HOST="choosing-host",e.CHOOSING_GROUP="choosing-group",e.IN_GROUP="in-group"}(t=e.State||(e.State={})),e.SUGGEST_HOST=function(e){switch(e){case"github":return;case"filesystem":return{value:"localhost:"+j.DEFAULT_PORT,description:"dev shortcut :)"};case"sk-server":return{value:window.location.origin,description:"this page's server"};default:return}}}(V||(V={}));const K=V.State;Object.freeze(V),Object.freeze(V.prototype);class q extends I{get initialScreen(){return u.Id.GROUP_JOINER}}Object.freeze(q),Object.freeze(q.prototype);var J=function(e,t,n,s){return new(n||(n=Promise))((function(o,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function i(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((s=s.apply(e,t||[])).next())}))};class X extends u{get initialScreen(){return u.Id.GROUP_JOINER}__lazyLoad(){}__abstractOnBeforeEnter(e){return this.toplevel.socket.once(G.a.CtorArgs.EVENT_NAME,e=>J(this,void 0,void 0,(function*(){this.requestGoToScreen(u.Id.PLAY_ONLINE,e)}))),Promise.resolve()}}Object.freeze(X),Object.freeze(X.prototype);var $=function(e,t,n,s){return new(n||(n=Promise))((function(o,a){function r(e){try{c(s.next(e))}catch(e){a(e)}}function i(e){try{c(s.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((s=s.apply(e,t||[])).next())}))};class Q extends H{constructor(){super(...arguments),this.wantsAutoPause=!1}get initialScreen(){return u.Id.GROUP_JOINER}__lazyLoad(){super.__lazyLoad()}__createNewGame(e){return $(this,void 0,void 0,(function*(){const t=new((yield Promise.all([n.e(0),n.e(2)]).then(n.bind(null,25))).OnlineGame)(this.__onGameBecomeOver.bind(this),this.toplevel.socket,e);return Promise.resolve(t)}))}}Object.freeze(Q),Object.freeze(Q.prototype);var Z,ee,te=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},ne=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class se{constructor(e,t){Z.set(this,void 0),t.setAttribute("role","presentation"),t.insertAdjacentHTML("beforebegin","\x3c!-- ALL SCREENS CONTAINER --\x3e");const n=u.Id,s=e,o=t,a=this.goToScreen.bind(this);this.dict=Object.freeze({[n.HOME]:new d(n.HOME,s,o,a),[n.HOW_TO_PLAY]:new h(n.HOW_TO_PLAY,s,o,a),[n.HOW_TO_HOST]:new p(n.HOW_TO_HOST,s,o,a),[n.COLOUR_CTRL]:new y(n.COLOUR_CTRL,s,o,a),[n.SETUP_OFFLINE]:new C(n.SETUP_OFFLINE,s,o,a),[n.PLAY_OFFLINE]:new x(n.PLAY_OFFLINE,s,o,a),[n.GROUP_JOINER]:new V(n.GROUP_JOINER,s,o,a),[n.SETUP_ONLINE]:new q(n.SETUP_ONLINE,s,o,a),[n.GROUP_LOBBY]:new X(n.GROUP_LOBBY,s,o,a),[n.PLAY_ONLINE]:new Q(n.PLAY_ONLINE,s,o,a)});const r=window.location.hash.slice(1),i=this.dict[r];i&&i.initialScreen?this.goToScreen(i.initialScreen,{}):this.goToScreen(u.Id.HOME,{})}goToScreen(e,t){const n=this.dict[e];if(this.currentScreen===n)throw new Error("never happens. see comment in source.");this.currentScreen&&!this.currentScreen.leave()||(n.enter(t),te(this,Z,n))}get currentScreen(){return ne(this,Z)}}Z=new WeakMap,Object.freeze(se),Object.freeze(se.prototype);class oe{constructor(){ee.set(this,void 0),this.webpageHostType=window.location.origin.match(/github\.io/)?oe.WebpageHostType.GITHUB:window.location.protocol.startsWith("file")?oe.WebpageHostType.FILESYSTEM:oe.WebpageHostType.SNAKEY_SERVER;const e=document.getElementById(r.a.Screen.Id.ALL_SCREENS);if(!e)throw new Error;this.allScreens=new se(this,e),console.log("%c🩺 welcome! 🐍","font:700 2.3em /1.5 monospace; margin:0.4em; border:0.3em solid black;padding:0.4em; color:white; background-color:#3f5e77; border-radius:0.7em; ")}toast(e){console.info(e)}get socketIo(){return new Promise((e,t)=>{const n=document.getElementById("socket.io");if(io)return e(io);n.onload=()=>{e(io)}})}get game(){return this.allScreens.dict.playOffline.currentGame||this.allScreens.dict.playOnline.currentGame}}ee=new WeakMap,function(e){let t;!function(e){e.GITHUB="github",e.FILESYSTEM="filesystem",e.SNAKEY_SERVER="sk-server"}(t=e.WebpageHostType||(e.WebpageHostType={}))}(oe||(oe={})),Object.freeze(oe),Object.freeze(oe.prototype),n(4);const ae=new oe;ae.webpageHostType===oe.WebpageHostType.GITHUB&&"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/ServiceWorker.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)},e=>{console.log("ServiceWorker registration failed: ",e)})}))}]);
//# sourceMappingURL=index.js.map