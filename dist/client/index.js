var snakey3=function(e){function t(t){for(var n,a,s=t[0],o=t[1],i=0,c=[];i<s.length;i++)a=s[i],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&c.push(r[a][0]),r[a]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(l&&l(t);c.length;)c.shift()()}var n={},a={1:0},r={1:0};function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.e=function(e){var t=[];a[e]?t.push(a[e]):0!==a[e]&&{0:1}[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="chunk/"+({0:"game/offline",2:"lang/Emote-ts",3:"lang/English-ts",4:"lang/Japanese-ts",5:"lang/Korean-ts",6:"lang/Morse-ts"}[e]||e)+".css",o=s.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var l=(u=i[c]).getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===o))return t()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){var u;if((l=(u=d[c]).getAttribute("data-href"))===r||l===o)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var r=t&&t.target&&t.target.src||o,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=r,delete a[e],h.parentNode.removeChild(h),n(s)},h.href=o,document.getElementsByTagName("head")[0].appendChild(h)})).then((function(){a[e]=0})));var n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=o);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=function(e){return s.p+"chunk/"+({0:"game/offline",2:"lang/Emote-ts",3:"lang/English-ts",4:"lang/Japanese-ts",5:"lang/Korean-ts",6:"lang/Morse-ts"}[e]||e)+".js"}(e);var l=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(d);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",l.name="ChunkLoadError",l.type=a,l.request=s,n[1](l)}r[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="dist/client/",s.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpsnakey3=window.webpackJsonpsnakey3||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=i;return s(s.s=4)}([function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){let t,n,a,r,s,o;!function(e){e.Class={TEXT_SELECT_DISABLED:"text-select-disabled",FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents"},e.Dataset={COLOUR_SCHEME:"skColourScheme"}}(t=e.General||(e.General={})),function(e){e.Class={BASE:"tile",POINTER_HB:"tile__pointer-hitbox",LANG_CHAR:"tile__char",LANG_SEQ:"tile__seq"},e.Dataset={HEALTH:"health"}}(n=e.Tile||(e.Tile={})),function(e){e.Class={GRID:"game-grid",IMPL_BODY:"game-grid-impl-body",KBD_DC:"game-grid-kbd-dc",KBD_DC_ICON:"game-grid-kbd-dc__icon",PAUSE_OL:"game-grid-pause-overlay",PAUSE_OL_ICON:"game-grid-pause-overlay__icon"},e.Dataset={IMPL_COORD_SYS:"coordSys",GAME_STATE:{KEY:"gameState",VALUES:{PLAYING:"playing",PAUSED:"paused",OVER:"over"}}}}(a=e.Grid||(e.Grid={})),function(e){e.Class={BASE:"player",FACE:"player__face",DOWNED_OVERLAY:"player__downed-overlay",SHORT_SPOTLIGHT:"player__spotlight-short",LONG_SPOTLIGHT:"player__spotlight-long"},e.Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"}}(r=e.Player||(e.Player={})),function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"sk-screen"},e.Dataset={CURRENT:"current"},function(e){let t,n;!function(e){e.Class={SCREEN:"screen-home",NAV:"screen-home--nav",NAV_PLAY_OFFLINE:"screen-home--nav--play-offline",NAV_PLAY_ONLINE:"screen-home--nav--play-online",NAV_TUTORIAL:"screen-home--nav--tutorial",NAV_COLOURS:"screen-home--nav--colour-scheme",NAV_VIEW_REPO:"screen-home--nav--goto-repo",NAV_RPT_ISSUE:"screen-home--nav--report-issue"}}(t=e.Home||(e.Home={})),function(e){e.Class={SCREEN:"screen-play",GRID_CONTAINER:"screen-play--grid-container",CONTROLS_BAR:"screen-play--controls-bar"}}(n=e.PlayGame||(e.PlayGame={}))}(t=e.Impl||(e.Impl={}))}(s=e.Screen||(e.Screen={})),function(e){e.Class={BASE:"sk-pick-one",OPT_BASE:"sk-pick-one--opt"}}(o=e.SkPickOne||(e.SkPickOne={}))}(a||(a={})),Object.freeze(a.Player.Dataset.DOWNED),function e(t){for(const n of Object.getOwnPropertyNames(t)){const a=t[n];"object"==typeof a&&e(a)}return Object.freeze(t)}(a)},function(e,t,n){"use strict";var a,r;function s(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e.NEVER="Never happens. See comment in source."}(a||(a={})),function(e){e.HOST_REGISTRATION="/host-reg",e.GROUP_PREFIX="/group"}(r||(r={}));class o{}!function(e){let t;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,function(e){e.NULL=void 0}(t=e.Id||(e.Id={})),e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType}(o||(o={})),Object.freeze(o),Object.freeze(o.prototype);class i{}!function(e){let t,n,a;!function(e){e.REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$")}(t=e.Seq||(e.Seq={})),function(e){e.NULL=Object.freeze({char:"",seq:""})}(n=e.CharSeqPair||(e.CharSeqPair={})),function(e){e.SEQ="SEQ",e.CHAR="CHAR",e.WEIGHT="WEIGHT"}(a=e.BalancingScheme||(e.BalancingScheme={})),e.__RemapTemplates=Object.freeze({IDENTITY:e=>e,TO_LOWER:e=>e.toLowerCase()}),e.__RemapTemplates,e.FrontendDescs=Object.freeze([{id:"engl-low",module:"English",export:"Lowercase",numLeaves:26,remapFunc:e.__RemapTemplates.TO_LOWER,display:"English Lowercase (QWERTY)",blurb:""},{id:"engl-mix",module:"English",export:"MixedCase",numLeaves:52,remapFunc:e.__RemapTemplates.IDENTITY,display:"English Mixed-Case (QWERTY)",blurb:""},{id:"japn-hir",module:"Japanese",export:"Hiragana",numLeaves:71,remapFunc:e.__RemapTemplates.TO_LOWER,display:"Japanese Hiragana",blurb:""},{id:"japn-kat",module:"Japanese",export:"Katakana",numLeaves:70,remapFunc:e.__RemapTemplates.TO_LOWER,display:"Japanese Katakana",blurb:""},{id:"kore-dub",module:"Korean",export:"Dubeolsik",numLeaves:9177,remapFunc:e.__RemapTemplates.IDENTITY,display:"Korean Dubeolsik (두벌식 키보드)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},{id:"kore-sub",module:"Korean",export:"Sebeolsik",numLeaves:10206,remapFunc:e.__RemapTemplates.IDENTITY,display:"Korean Sebeolsik (세벌식 최종 키보드)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},{id:"kore-rom",module:"Korean",export:"Romanization",numLeaves:3990,remapFunc:e.__RemapTemplates.TO_LOWER,display:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (국어의 로마자 표기법; 國語의 로마字 表記法) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"}].map(e=>Object.freeze(e))),e.FrontendDescs,e.GET_FRONTEND_DESC_BY_ID=function(t){const n=e.FrontendDescs.find(e=>e.id===t);if(!n)throw new Error(`Frontend descriptor of language with id "${t}" not found.`);return n}}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype)},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"OmHooks",(function(){return o.a})),n.d(t,"top",(function(){return W}));var a,r,s,o=n(0),i=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},c=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},l=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class d{constructor(e,t){a.set(this,void 0),r.set(this,void 0),c(this,r,!1),this.requestGoToScreen=t,c(this,a,e)}enter(e){return i(this,void 0,void 0,(function*(){if(!l(this,r)){const e=this.baseElem=document.createElement("div");e.classList.add(o.a.Screen.Class.BASE),this.__lazyLoad(),l(this,a).appendChild(e),c(this,r,!0)}yield this.__abstractOnBeforeEnter(e),window.requestAnimationFrame(e=>{this.baseElem.dataset[o.a.Screen.Dataset.CURRENT]="",this.baseElem.setAttribute("aria-hidden","false")})}))}leave(){return!!this.__abstractOnBeforeLeave()&&(delete this.baseElem.dataset[o.a.Screen.Dataset.CURRENT],this.baseElem.setAttribute("aria-hidden","true"),!0)}__abstractOnBeforeEnter(e){return i(this,void 0,void 0,(function*(){}))}__abstractOnBeforeLeave(){return!0}}a=new WeakMap,r=new WeakMap,function(e){let t;!function(e){e.HOME="home",e.HOW_TO_PLAY="howToPlay",e.HOW_TO_HOST="howToHost",e.COLOUR_CTRL="colourControl",e.GAME_SETUP="gameSetup",e.PLAY_OFFLINE="playOffline",e.PLAY_ONLINE="playOnline",e.SESH_JOINER="sessionJoiner"}(t=e.Id||(e.Id={}))}(d||(d={})),Object.freeze(d),Object.freeze(d.prototype);class u extends d{__lazyLoad(){const e=o.a.Screen.Impl.Home.Class;this.baseElem.classList.add(o.a.General.Class.CENTER_CONTENTS,e.SCREEN),this.baseElem.setAttribute("aria-label","Home Page Screen");const t=this.navElem=document.createElement("div");function n(e,n){e.classList.add(o.a.General.Class.CENTER_CONTENTS,o.a.General.Class.TEXT_SELECT_DISABLED,n.cssClass),e.innerText=n.text,e.addEventListener("pointerenter",()=>{e.focus()}),t.appendChild(e)}t.classList.add(e.NAV),t.setAttribute("role","navigation"),t.addEventListener("pointerleave",()=>{var e;(null===(e=document.activeElement)||void 0===e?void 0:e.parentElement)===t&&document.activeElement.blur()}),[{text:"Offline Single-player",cssClass:e.NAV_PLAY_OFFLINE,screenId:d.Id.PLAY_OFFLINE},{text:"Online Multi-player",cssClass:e.NAV_PLAY_ONLINE,screenId:e=>{}},{text:"Tutorial",cssClass:e.NAV_TUTORIAL,screenId:d.Id.HOW_TO_PLAY},{text:"Colour Schemes",cssClass:e.NAV_COLOURS,screenId:d.Id.COLOUR_CTRL}].map(e=>Object.freeze(e)).forEach(e=>{const t=document.createElement("button");t.onclick=e.screenId instanceof Function?e.screenId:()=>{this.requestGoToScreen(e.screenId,{})},n(t,e)}),[{text:"Visit Repo",cssClass:e.NAV_VIEW_REPO,href:new window.URL("https://github.com/david-fong/SnaKey-NTS")},{text:"Report Issue",cssClass:e.NAV_RPT_ISSUE,href:new window.URL("https://github.com/david-fong/SnaKey-NTS/issues")}].map(e=>Object.freeze(e)).forEach(e=>{const t=document.createElement("a");t.href=e.href.toString(),t.referrerPolicy="strict-origin-when-cross-origin",t.target="_blank",n(t,e)}),this.baseElem.appendChild(t)}}Object.freeze(u),Object.freeze(u.prototype);class h extends d{__lazyLoad(){}}Object.freeze(h),Object.freeze(h.prototype);class p extends d{__lazyLoad(){}}(p||(p={})).INSTRUCTIONS_STEPS=Object.freeze(["$ npm install 'https://github.com/david-fong/SnaKey-NTS#gh-pages'","$ npm run start","send the url to your friends"]),Object.freeze(p),Object.freeze(p.prototype),function(e){let t;e.LocalKeys=Object.freeze({MUSIC_VOLUME:"musicVolume",SFX_VOLUME:"sfxVolume",COLOUR_ID:"colourSchemeId",COLOUR_LITERAL:"colourSchemeStyleLiteral",GAME_PRESET:"gamePresetId",USERNAME:"username",AVATAR:"avatarId"}),e.SessionKeys=Object.freeze({}),function(e){let t;e.DB_NAME="snakeyDB",function(e){e.STORE_NAME="userGamePresets"}(t=e.UserGamePresetStore||(e.UserGamePresetStore={})),Object.freeze(t)}(t=e.IDB||(e.IDB={})),Object.freeze(t)}(s||(s={})),Object.freeze(s);var m,f,E,O,_,b,y,g=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},v=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class S{constructor(){m.set(this,void 0),f.set(this,void 0),E.set(this,void 0);const e=document.createElement("div");e.tabIndex=0,e.classList.add(o.a.SkPickOne.Class.BASE),e.addEventListener("keydown",this.onKeyDown.bind(this)),e.setAttribute("role","listbox"),this.baseElem=e,this.options=[]}addOption(e){this.options.push(e),this.baseElem.appendChild(e.baseElem),e.__registerParent(this.onOptDisabledChange.bind(this))}hoverOpt(e){var t;this.hoveredOpt!==e&&(null===(t=this.hoveredOpt)||void 0===t||t.baseElem.setAttribute("aria-active-descendant","false"),g(this,f,e),this.hoveredOpt.baseElem.setAttribute("aria-active-descendant","true"))}selectOpt(e,t=!0){var n;if(!e)throw new Error("opt must be defined");this.hoverOpt(e),this.confirmedOpt!==e&&(null===(n=this.confirmedOpt)||void 0===n||n.baseElem.setAttribute("aria-selected","false"),g(this,m,e),this.confirmedOpt.baseElem.setAttribute("aria-selected","true"),t&&this.__onSelectOpt(e))}get confirmedOpt(){return v(this,m)}get hoveredOpt(){return v(this,f)}onOptDisabledChange(e){this.confirmedOpt===e&&(this.validity=!e.disabled)}set validity(e){this.validity!==e&&(this.baseElem.setAttribute("aria-invalid",e?"false":"true"),g(this,E,e))}onKeyDown(e){if(" "===e.key||"Enter"===e.key)return this.selectOpt(this.hoveredOpt),e.preventDefault(),!1;{const t=this.options.indexOf(this.hoveredOpt);if("ArrowDown"===e.key||"Down"===e.key){if(t<this.options.length-1)return this.hoverOpt(this.options[t+1]),e.preventDefault(),!1}else if(("ArrowUp"===e.key||"Up"===e.key)&&t>0)return this.hoverOpt(this.options[t-1]),e.preventDefault(),!1}return!0}}m=new WeakMap,f=new WeakMap,E=new WeakMap,O=S||(S={}),_=new WeakMap,b=new WeakMap,O.__Option=class{constructor(){_.set(this,void 0),b.set(this,void 0);const e=this.baseElem=document.createElement("div");e.classList.add(o.a.SkPickOne.Class.OPT_BASE),e.setAttribute("role","option"),g(this,_,!1)}__registerParent(e){g(this,b,e)}get disabled(){return v(this,_)}set disabled(e){this.disabled!==e&&(this.baseElem.setAttribute("aria-disabled",e?"true":"false"),g(this,_,e),v(this,b).call(this,this))}},Object.freeze(O),Object.freeze(O.prototype),Object.freeze(S),Object.freeze(S.prototype),n(3);class T extends d{__lazyLoad(){const e=new T.PickOne;this.baseElem.appendChild(e.baseElem),this.sel=e;const t=localStorage.getItem(s.LocalKeys.COLOUR_ID);t&&this.sel.selectOpt(this.sel.getOptById(t),!1)}}!function(e){class t extends S{constructor(){if(super(),this.garageDoorElem=document.getElementById(o.a.Screen.Id.SCREEN_TINT),!this.garageDoorElem)throw new Error;this.garageDoorElem.style.transitionDuration=y.SMOOTH_CHANGE_DURATION/3+"ms";for(const e of y.Schemes)this.addOption(new t.Option(e));this.selectOpt(this.getOptById("snakey"),!1)}__onHoverOpt(e){}__onSelectOpt(e){localStorage.setItem(s.LocalKeys.COLOUR_ID,e.desc.id),localStorage.setItem(s.LocalKeys.COLOUR_LITERAL,e.cssLiteral);const t=y.SMOOTH_CHANGE_DURATION/3+80;setTimeout(()=>{this.garageDoorElem.style.opacity=1..toString(),setTimeout(()=>{document.documentElement.dataset[o.a.General.Dataset.COLOUR_SCHEME]=e.desc.id,setTimeout(()=>{this.garageDoorElem.style.opacity=(0).toString()},t)},t)},t)}getOptById(e){return this.options.find(t=>t.desc.id===e)}}e.PickOne=t,function(e){class t extends S.__Option{constructor(e){super(),this.desc=e}}e.Option=t,Object.freeze(t),Object.freeze(t.prototype)}(t=e.PickOne||(e.PickOne={})),Object.freeze(t),Object.freeze(t.prototype)}(T||(T={})),Object.freeze(T),Object.freeze(T.prototype),function(e){e.Swatch=Object.freeze(["mainFg","mainBg","tileFg","tileBg","tileBd","healthFg","healthBg","pFaceMe","pFaceTeammate","pFaceImtlTeammate","pFaceOpponent","pFaceImtlOpponent"]),e.Schemes=Object.freeze([{id:"snakey",displayName:"Snakey",author:"N.W."},{id:"smooth-stone",displayName:"Smooth Stone",author:"Dav"}].map(e=>Object.freeze(e))),e.SMOOTH_CHANGE_DURATION=2e3}(y||(y={})),Object.freeze(y);var L=n(1);class C extends d{__lazyLoad(){this.createLangSelector()}createLangSelector(){const e=document.createElement("select");for(const t of Object.values(L.a.FrontendDescs)){const n=document.createElement("option");n.value=t.id,n.innerText=t.display,e.add(n)}e.onchange=()=>{e.blur()},this.langSel=e}}Object.freeze(C),Object.freeze(C.prototype);class A extends d{__lazyLoad(){}}Object.freeze(A),Object.freeze(A.prototype);var w,I,N,R,P=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},k=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},D=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};class G extends d{constructor(){super(...arguments),w.set(this,void 0),I.set(this,void 0),N.set(this,void 0),R.set(this,void 0)}__lazyLoad(){this.baseElem.classList.add(o.a.Screen.Impl.PlayGame.Class.SCREEN),this.baseElem.setAttribute("aria-label","Play Game Screen");const e=G.createCenterColElem();this.gridElem=e.gridElem,this.baseElem.appendChild(e.baseElem),this.initializeControlsBar(),this.initializeScoresBar(),D(this,I,()=>{this.wantsAutoPause&&(document.hidden?void 0===k(this,R)&&this.statusBecomePaused():"page-hide"===k(this,R)&&this.statusBecomePlaying())}),D(this,N,this.__gridKeyDownCallback.bind(this))}__abstractOnBeforeEnter(){return(()=>P(this,void 0,void 0,(function*(){document.addEventListener("visibilitychange",k(this,I)),this.pauseButton.disabled=!0,this.statusBecomePaused(),D(this,w,yield this.__createNewGame()),this.gridElem.addEventListener("keydown",k(this,N));const e=this.currentGame.reset();yield e,this.gridElem.insertAdjacentElement("afterbegin",this.currentGame.htmlElements.gridImplElem),this.pauseButton.onclick=this.statusBecomePlaying.bind(this),this.pauseButton.disabled=!1,this.wantsAutoPause&&setTimeout(()=>{document.hidden||this.statusBecomePlaying()},1e3)})))()}__abstractOnBeforeLeave(){if(!window.confirm("Are you sure you would like to leave?"))return!1;document.removeEventListener("visibilitychange",k(this,I));for(const e of Object.values(this.currentGame.htmlElements))e.remove();return this.gridElem.removeEventListener("keydown",k(this,N)),D(this,w,void 0),!0}get currentGame(){return k(this,w)}__gridKeyDownCallback(e){if(e.ctrlKey&&" "===e.key){const e=this.currentGame.operators;this.currentGame.currentOperator=e[(e.indexOf(this.currentGame.currentOperator)+1)%e.length]}else this.currentGame.currentOperator.processKeyboardInput(e);return" "!==e.key||(e.preventDefault(),!1)}statusBecomePlaying(){var e;const t=o.a.Grid.Dataset.GAME_STATE;null===(e=this.currentGame)||void 0===e||e.statusBecomePlaying(),this.pauseButton.innerText="Pause",D(this,R,void 0),this.gridElem.dataset[t.KEY]=t.VALUES.PLAYING,window.requestAnimationFrame(e=>{this.pauseButton.onclick=this.statusBecomePaused.bind(this),this.resetButton.disabled=!0,this.gridElem.focus()})}statusBecomePaused(){var e;const t=o.a.Grid.Dataset.GAME_STATE;null===(e=this.currentGame)||void 0===e||e.statusBecomePaused(),this.pauseButton.innerText="Unpause",D(this,R,document.hidden?"page-hide":"other"),this.gridElem.dataset[t.KEY]=t.VALUES.PAUSED,this.pauseButton.onclick=this.statusBecomePlaying.bind(this),this.resetButton.disabled=!1}__onGameBecomeOver(){const e=o.a.Grid.Dataset.GAME_STATE;this.pauseButton.disabled=!0,this.gridElem.dataset[e.KEY]=e.VALUES.OVER}__resetGame(){this.currentGame.reset(),this.pauseButton.disabled=!1,this.wantsAutoPause&&this.statusBecomePlaying()}initializeControlsBar(){const e=document.createElement("div");e.classList.add(o.a.Screen.Impl.PlayGame.Class.CONTROLS_BAR),e.setAttribute("role","menu");{const t=this.backToHomeButton=document.createElement("button");t.innerText="Return To Homepage",t.onclick=this.requestGoToScreen.bind(this,d.Id.HOME),e.appendChild(t)}{const t=this.pauseButton=document.createElement("button");e.appendChild(t)}{const t=this.resetButton=document.createElement("button");t.innerText="Reset",t.onclick=this.__resetGame.bind(this),e.appendChild(t)}this.baseElem.appendChild(e)}initializeScoresBar(){}}w=new WeakMap,I=new WeakMap,N=new WeakMap,R=new WeakMap,(G||(G={})).createCenterColElem=function(){const e=o.a.General.Class,t=document.createElement("div");t.classList.add(e.CENTER_CONTENTS,o.a.Screen.Impl.PlayGame.Class.GRID_CONTAINER);const n=document.createElement("div");n.tabIndex=0,n.setAttribute("role","textbox"),n.setAttribute("aria-label","Game Grid"),n.classList.add(e.CENTER_CONTENTS,e.STACK_CONTENTS,e.TEXT_SELECT_DISABLED,o.a.Grid.Class.GRID);{const t=document.createElement("div");t.classList.add(e.CENTER_CONTENTS,o.a.Grid.Class.KBD_DC);{const e=document.createElement("div");e.classList.add(o.a.Grid.Class.KBD_DC_ICON),e.innerText="(click here to continue typing)",t.appendChild(e)}n.appendChild(t)}{const t=document.createElement("div");t.classList.add(e.CENTER_CONTENTS,o.a.Grid.Class.PAUSE_OL);{const e=document.createElement("div");e.classList.add(o.a.Grid.Class.PAUSE_OL_ICON),e.innerText="(The Game is Paused)",t.appendChild(e)}n.appendChild(t)}return t.appendChild(n),Object.freeze({baseElem:t,gridElem:n})},Object.freeze(G),Object.freeze(G.prototype);var B=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};class j extends G{constructor(){super(...arguments),this.wantsAutoPause=!0}__lazyLoad(){super.__lazyLoad()}__createNewGame(){return B(this,void 0,void 0,(function*(){return new((yield n.e(0).then(n.bind(null,13))).OfflineGame)({coordSys:"EUCLID2",gridDimensions:{height:21,width:21},averageFreeHealthPerTile:1/45,langBalancingScheme:L.a.BalancingScheme.WEIGHT,langId:"engl-low",playerDescs:[{isALocalOperator:!0,familyId:"HUMAN",teamId:0,socketId:void 0,username:"hello world 1",noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!0,familyId:"HUMAN",teamId:0,socketId:void 0,username:"hello world 2",noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,socketId:void 0,username:"chaser test 1",noCheckGameOver:!0,familyArgs:{fearDistance:5,bloodThirstDistance:7,healthReserve:3,movesPerSecond:2}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,socketId:void 0,username:"chaser test 2",noCheckGameOver:!0,familyArgs:{fearDistance:5,bloodThirstDistance:7,healthReserve:3,movesPerSecond:2}}]})}))}}Object.freeze(j),Object.freeze(j.prototype);var z=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};class x extends G{constructor(){super(...arguments),this.wantsAutoPause=!1}__lazyLoad(){super.__lazyLoad()}__createNewGame(){return z(this,void 0,void 0,(function*(){}))}}Object.freeze(x),Object.freeze(x.prototype);var H,M=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},U=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class F{constructor(e){H.set(this,void 0),e.setAttribute("role","presentation");const t=e,n=this.goToScreen.bind(this);this.dict=Object.freeze({[d.Id.HOME]:new u(t,n),[d.Id.HOW_TO_PLAY]:new h(t,n),[d.Id.HOW_TO_HOST]:new p(t,n),[d.Id.COLOUR_CTRL]:new T(t,n),[d.Id.GAME_SETUP]:new C(t,n),[d.Id.PLAY_OFFLINE]:new j(t,n),[d.Id.PLAY_ONLINE]:new x(t,n),[d.Id.SESH_JOINER]:new A(t,n)}),this.goToScreen(d.Id.HOME,{})}goToScreen(e,t){const n=this.dict[e];if(this.currentScreen===n)throw new Error("never happens. see comment in source.");this.currentScreen&&!this.currentScreen.leave()||(n.enter(t),M(this,H,n))}get currentScreen(){return U(this,H)}}H=new WeakMap,Object.freeze(F),Object.freeze(F.prototype);class K{constructor(){const e=document.getElementById(o.a.Screen.Id.ALL_SCREENS);if(!e)throw new Error;this.allScreens=new F(e)}}Object.freeze(K),Object.freeze(K.prototype),n(2),window.origin&&"null"!==window.origin&&"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/ServiceWorker.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)},e=>{console.log("ServiceWorker registration failed: ",e)})}));const W=new K}]);
//# sourceMappingURL=index.js.map