var snakey3=function(e){function t(t){for(var n,s,r=t[0],a=t[1],i=0,c=[];i<r.length;i++)s=r[i],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&c.push(o[s][0]),o[s]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(l&&l(t);c.length;)c.shift()()}var n={},s={3:0},o={3:0};function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.e=function(e){var t=[];s[e]?t.push(s[e]):0!==s[e]&&{0:1}[e]&&t.push(s[e]=new Promise((function(t,n){for(var o="chunk/"+({0:"game/offline~game/online",1:"game/offline",2:"game/online",4:"lang/Cellphone-ts",5:"lang/Emote-ts",6:"lang/English-ts",7:"lang/Japanese-ts",8:"lang/Korean-ts",9:"lang/Morse-ts"}[e]||e)+".css",a=r.p+o,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var l=(d=i[c]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(l===o||l===a))return t()}var u=document.getElementsByTagName("style");for(c=0;c<u.length;c++){var d;if((l=(d=u[c]).getAttribute("data-href"))===o||l===a)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var o=t&&t.target&&t.target.src||a,r=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=o,delete s[e],p.parentNode.removeChild(p),n(r)},p.href=a,document.getElementsByTagName("head")[0].appendChild(p)})).then((function(){s[e]=0})));var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,s){n=o[e]=[t,s]}));t.push(n[2]=a);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.src=function(e){return r.p+"chunk/"+({0:"game/offline~game/online",1:"game/offline",2:"game/online",4:"lang/Cellphone-ts",5:"lang/Emote-ts",6:"lang/English-ts",7:"lang/Japanese-ts",8:"lang/Korean-ts",9:"lang/Morse-ts"}[e]||e)+".js"}(e);var l=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",l.name="ChunkLoadError",l.type=s,l.request=r,n[1](l)}o[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="dist/client/",r.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpsnakey3=window.webpackJsonpsnakey3||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var l=i;return r(r.s=6)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var s,o=n(1);!function(e){let t,n,s,o,r,a;e.GLOBAL_IDS={PUBLIC_GAME_HOST_URLS:"public-game-hosts-list",CURRENT_HOST_GROUPS:"current-host-groups-list"},function(e){e.Class={TEXT_SELECT_DISABLED:"text-select-disabled",FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents",INPUT_GROUP:"sk-input-group",INPUT_GROUP_ITEM:"sk-input-group-item"},e.Dataset={COLOUR_SCHEME:"skColourScheme"}}(t=e.General||(e.General={})),function(e){e.Class={BASE:"tile",POINTER_HB:"tile__pointer-hitbox",LANG_CHAR_WRAP:"tile__char",LANG_SEQ:"tile__seq"},e.Dataset={HEALTH:"health"}}(n=e.Tile||(e.Tile={})),function(e){e.Class={GRID:"game-grid",SCROLL_OUTER:"game-grid-scroll-outer",SCROLL_INNER:"game-grid-scroll-inner",IMPL_BODY:"game-grid-impl-body",KBD_DC:"game-grid-kbd-dc",KBD_DC_ICON:"game-grid-kbd-dc__icon",PAUSE_OL:"game-grid-pause-overlay",PAUSE_OL_ICON:"game-grid-pause-overlay__icon",PLAYER_IOB_ROOT:"grid-player-intersection-root"},e.Dataset={IMPL_COORD_SYS:"coordSys",GAME_STATE:{KEY:"gameState",VALUES:{PLAYING:"playing",PAUSED:"paused",OVER:"over"}}}}(s=e.Grid||(e.Grid={})),function(e){e.Class={BASE:"player",FACE:"player__face",DOWNED_OVERLAY:"player__downed-overlay",SHORT_SPOTLIGHT:"player__spotlight-short",LONG_SPOTLIGHT:"player__spotlight-long"},e.Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"}}(o=e.Player||(e.Player={})),function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"sk-screen"},e.Dataset={CURRENT:"current"},function(e){let t,n,s,o,r;!function(e){e.Class={BASE:"screen-home",NAV:"screen-home--nav",NAV_PLAY_OFFLINE:"screen-home--nav--play-offline",NAV_PLAY_ONLINE:"screen-home--nav--play-online",NAV_HOW_TO_PLAY:"screen-home--nav--how-to-play",NAV_HOW_TO_HOST:"screen-home--nav--how-to-host",NAV_COLOURS:"screen-home--nav--colour-scheme",NAV_VIEW_REPO:"screen-home--nav--goto-repo",NAV_RPT_ISSUE:"screen-home--nav--report-issue"}}(t=e.Home||(e.Home={})),function(e){e.Class={BASE:"screen-play",GRID_WRAPPER:"screen-play--grid-wrapper",CONTROLS_BAR:"screen-play--controls-bar",PLAYERS_BAR:"screen-play--players-bar"}}(n=e.Play||(e.Play={})),function(e){e.Class={BASE:"screen-setup",NEXT_BUTTON:"screen-setup--next-button"}}(s=e.Setup||(e.Setup={})),function(e){e.Class={BASE:"screen-joiner",CONTENT_WRAPPER:"screen-joiner--content-wrapper",HOST_URL:"screen-joiner--host-url",GROUP_NAME:"screen-joiner--group-name",PASSPHRASE:"screen-joiner--passphrase",NEXT_BUTTON:"screen-joiner--next-button"}}(o=e.GroupJoiner||(e.GroupJoiner={})),function(e){e.Class={BASE:"screen-colour",OPTION:"screen-colour--opt",OPTION_LABEL:"screen-colour--opt-label",OPTION_PREVIEW:"screen-colour--opt-preview"}}(r=e.ColourCtrl||(e.ColourCtrl={}))}(t=e.Impl||(e.Impl={}))}(r=e.Screen||(e.Screen={})),function(e){e.Class={BASE:"sk-pick-one",OPT_BASE:"sk-pick-one--opt"}}(a=e.SkPickOne||(e.SkPickOne={}))}(s||(s={})),Object.freeze(s.Player.Dataset.DOWNED),Object(o.e)(s)},function(e,t,n){"use strict";var s;n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),function(e){e.NEVER="Never happens. See comment in source."}(s||(s={}));const o=Object.freeze({behavior:"smooth",block:"center",inline:"center"});function r(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function a(e){for(const t of Object.getOwnPropertyNames(e)){const n=e[t];"object"==typeof n&&a(n)}return Object.freeze(e)}class i{}!function(e){let t;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,function(e){e.NULL=void 0}(t=e.Id||(e.Id={})),e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype);class c{}!function(e){let t,n;!function(e){e.REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$")}(t=e.Seq||(e.Seq={})),function(e){e.NULL=Object.freeze({char:"",seq:""})}(n=e.CharSeqPair||(e.CharSeqPair={})),e.CHAR_HIT_COUNT_SEED_CEILING=5,e._RemapTemplates=Object.freeze({IDENTITY:e=>e,TO_LOWER:e=>e.toLowerCase()}),e._RemapTemplates,e.FrontendDescs=Object.freeze([{id:"engl-low",module:"English",export:"Lowercase",numLeaves:26,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"English Lowercase (qwerty)",blurb:""},{id:"engl-mix",module:"English",export:"MixedCase",numLeaves:52,remapFunc:e._RemapTemplates.IDENTITY,displayName:"English Mixed-Case (Querty)",blurb:""},{id:"japn-hir",module:"Japanese",export:"Hiragana",numLeaves:71,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"Japanese Hiragana",blurb:""},{id:"japn-kat",module:"Japanese",export:"Katakana",numLeaves:70,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"Japanese Katakana",blurb:""},{id:"kore-dub",module:"Korean",export:"Dubeolsik",numLeaves:9177,remapFunc:e._RemapTemplates.IDENTITY,displayName:"Korean Dubeolsik (두벌식 키보드)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},{id:"kore-sub",module:"Korean",export:"Sebeolsik",numLeaves:10206,remapFunc:e._RemapTemplates.IDENTITY,displayName:"Korean Sebeolsik (세벌식 최종 키보드)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},{id:"kore-rom",module:"Korean",export:"Romanization",numLeaves:3990,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (국어의 로마자 표기법; 國語의 로마字 表記法) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"},{id:"engl-cell-enc",module:"English",export:"OldCellphone.Encode",numLeaves:8,remapFunc:e._RemapTemplates.IDENTITY,displayName:"Old Cellphone Keyboard",blurb:""}].map(e=>Object.freeze(e))),e.FrontendDescs,e.GET_FRONTEND_DESC_BY_ID=function(t){const n=e.FrontendDescs.find(e=>e.id===t);if(!n)throw new Error(`Frontend descriptor of language with id "${t}" not found.`);return n}}(c||(c={})),Object.freeze(c),Object.freeze(c.prototype)},function(e,t,n){"use strict";var s;n.d(t,"a",(function(){return s})),function(e){let t,n,s,o;!function(e){e.SERVER="SERVER",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(t=e.Type||(e.Type={})),function(e){e.EVENT_NAME="game-create",e.RETURN_TO_LOBBY_INDICATOR="return-to-lobby"}(n=e.CtorArgs||(e.CtorArgs={})),function(e){e.EVENT_NAME="game-reset"}(s=e.Serialization||(e.Serialization={})),function(e){e.PLAYING="PLAYING",e.PAUSED="PAUSED",e.OVER="OVER"}(o=e.Status||(e.Status={})),e.K=Object.freeze({HEALTH_UPDATE_CHANCE:.1,PCT_MOVES_THAT_ARE_BOOST:.05,HEALTH_EFFECT_FOR_DOWNED_PLAYER:.6,EVENT_RECORD_WRAPPING_BUFFER_LENGTH:128,EVENT_RECORD_FORWARD_WINDOW_LENGTH:64})}(s||(s={})),Object.freeze(s)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var s,o=n(1);!function(e){let t;!function(e){e.EUCLID2="EUCLID2",e.BEEHIVE="BEEHIVE"}(t=e.System||(e.System={}));class n{constructor(e){}}e.Abstract=n,function(t){class n extends e.Abstract{}t.Mathy=n}(n=e.Abstract||(e.Abstract={})),Object.freeze(n),Object.freeze(n.prototype)}(s||(s={})),Object.freeze(s);var r,a,i,c,l=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},u=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class d{constructor(e){r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),c.set(this,void 0),this.coord=e,l(this,r,o.b.Id.NULL)}reset(){this.evictOccupant(),this.lastKnownUpdateId=0,this.freeHealth=0,this.setLangCharSeqPair(o.a.CharSeqPair.NULL)}_setOccupant(e,t){l(this,r,e)}get isOccupied(){return this.occupantId!==o.b.Id.NULL}evictOccupant(){l(this,r,o.b.Id.NULL)}get occupantId(){return u(this,r)}get freeHealth(){return u(this,a)}set freeHealth(e){l(this,a,e)}setLangCharSeqPair(e){l(this,i,e.char),l(this,c,e.seq)}get langChar(){return u(this,i)}get langSeq(){return u(this,c)}}r=new WeakMap,a=new WeakMap,i=new WeakMap,c=new WeakMap,Object.freeze(d),Object.freeze(d.prototype)},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"OmHooks",(function(){return a.a})),n.d(t,"top",(function(){return ae}));var s,o,r,a=n(0),i=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function i(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((s=s.apply(e,t||[])).next())}))},c=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},l=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class u{constructor(e,t,n,r){s.set(this,void 0),o.set(this,void 0),this.screenId=e,this.top=t,c(this,s,n),this.requestGoToScreen=r,c(this,o,!1)}get initialScreen(){return this.screenId}enter(e){return i(this,void 0,void 0,(function*(){if(!l(this,o)){const e=this.baseElem=document.createElement("div");e.classList.add(a.a.Screen.Class.BASE),this._lazyLoad(),l(this,s).appendChild(e);const t=this.screenId.replace(/[A-Z]/g,e=>" "+e);{const n=t.toUpperCase();this.top.prependComment(e,n+" SCREEN")}{const n=t.split(" ").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join(" ");e.setAttribute("aria-label",n+" Screen")}c(this,o,!0)}const t=new window.URL(window.location.href);t.hash=this.screenId,history.replaceState(null,"",t.href),yield this._abstractOnBeforeEnter(e),window.requestAnimationFrame(e=>{this.baseElem.dataset[a.a.Screen.Dataset.CURRENT]="",this.baseElem.setAttribute("aria-hidden","false")})}))}leave(){return!!this._abstractOnBeforeLeave()&&(delete this.baseElem.dataset[a.a.Screen.Dataset.CURRENT],this.baseElem.setAttribute("aria-hidden","true"),!0)}_abstractOnBeforeEnter(e){return i(this,void 0,void 0,(function*(){}))}_abstractOnBeforeLeave(){return!0}}s=new WeakMap,o=new WeakMap,function(e){let t;!function(e){e.HOME="home",e.HOW_TO_PLAY="howToPlay",e.HOW_TO_HOST="howToHost",e.COLOUR_CTRL="colourControl",e.SETUP_OFFLINE="setupOffline",e.PLAY_OFFLINE="playOffline",e.GROUP_JOINER="groupJoiner",e.SETUP_ONLINE="setupOnline",e.GROUP_LOBBY="groupLobby",e.PLAY_ONLINE="playOnline"}(t=e.Id||(e.Id={}))}(u||(u={})),Object.freeze(u),Object.freeze(u.prototype);class d extends u{_lazyLoad(){const e=a.a.Screen.Impl.Home.Class;this.baseElem.classList.add(a.a.General.Class.CENTER_CONTENTS,e.BASE);const t=this.navElem=document.createElement("div");t.classList.add(a.a.General.Class.TEXT_SELECT_DISABLED,a.a.General.Class.INPUT_GROUP,e.NAV),t.setAttribute("role","navigation"),t.addEventListener("pointerleave",()=>{var e;(null===(e=document.activeElement)||void 0===e?void 0:e.parentElement)===t&&document.activeElement.blur()});const n=(e,n)=>{e.classList.add(a.a.General.Class.CENTER_CONTENTS,a.a.General.Class.INPUT_GROUP_ITEM,n.cssClass),e.textContent=n.text,e.addEventListener("pointerenter",()=>{window.requestAnimationFrame(t=>{e.focus()}),this.top.sfx}),t.appendChild(e)};[{text:"Offline Single-player",cssClass:e.NAV_PLAY_OFFLINE,screenId:u.Id.SETUP_OFFLINE},{text:"Online Multi-player",cssClass:e.NAV_PLAY_ONLINE,screenId:u.Id.GROUP_JOINER},{text:"How To Play",cssClass:e.NAV_HOW_TO_PLAY,screenId:u.Id.HOW_TO_PLAY},{text:"How To Host",cssClass:e.NAV_HOW_TO_HOST,screenId:u.Id.HOW_TO_HOST},{text:"Colour Schemes",cssClass:e.NAV_COLOURS,screenId:u.Id.COLOUR_CTRL}].map(e=>Object.freeze(e)).forEach(e=>{const t=document.createElement("button");t.onclick=e.screenId instanceof Function?e.screenId:()=>{this.requestGoToScreen(e.screenId,{})},n(t,e)}),[{text:"Visit\nRepo",cssClass:e.NAV_VIEW_REPO,href:new window.URL("https://github.com/david-fong/SnaKey-NTS")},{text:"Report\nIssue",cssClass:e.NAV_RPT_ISSUE,href:new window.URL("https://github.com/david-fong/SnaKey-NTS/issues")}].map(e=>Object.freeze(e)).forEach(e=>{const t=document.createElement("a");t.href=e.href.toString(),t.referrerPolicy="strict-origin-when-cross-origin",t.rel="noopener",t.target="_blank",n(t,e)}),this.baseElem.appendChild(t)}}Object.freeze(d),Object.freeze(d.prototype);class p extends u{_lazyLoad(){}}Object.freeze(p),Object.freeze(p.prototype);class h extends u{_lazyLoad(){}}(h||(h={})).INSTRUCTIONS_STEPS=Object.freeze(["$ npm install 'https://github.com/david-fong/SnaKey-NTS#gh-pages'","$ npm run start","send the url to your friends"]),Object.freeze(h),Object.freeze(h.prototype),function(e){let t;e.LocalKeys=Object.freeze({MUSIC_VOLUME:"musicVolume",SFX_VOLUME:"sfxVolume",COLOUR_ID:"colourSchemeId",COLOUR_LITERAL:"colourSchemeStyleLiteral",GAME_PRESET:"gamePresetId",USERNAME:"username",AVATAR:"avatarId"}),e.SessionKeys=Object.freeze({}),function(e){let t;e.DB_NAME="snakeyDB",function(e){e.STORE_NAME="userGamePresets"}(t=e.UserGamePresetStore||(e.UserGamePresetStore={})),Object.freeze(t)}(t=e.IDB||(e.IDB={})),Object.freeze(t)}(r||(r={})),Object.freeze(r);var m,E,O,f,_,g,S=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},b=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class v{constructor(){m.set(this,void 0),E.set(this,void 0),O.set(this,void 0);const e=document.createElement("div");e.tabIndex=0,e.classList.add(a.a.SkPickOne.Class.BASE),e.addEventListener("keydown",this.onKeyDown.bind(this)),e.setAttribute("role","listbox"),e.addEventListener("pointerenter",t=>{window.requestAnimationFrame(t=>{e.focus()})}),this.baseElem=e,this.options=[]}addOption(e){this.options.push(e),this.baseElem.appendChild(e.baseElem),e.baseElem.addEventListener("pointerenter",this.hoverOpt.bind(this,e)),e.baseElem.addEventListener("click",this.selectOpt.bind(this,e,!0)),e._registerParent(this.onOptDisabledChange.bind(this))}hoverOpt(e){var t;this.hoveredOpt!==e&&(null===(t=this.hoveredOpt)||void 0===t||t.baseElem.setAttribute("aria-active-descendant","false"),S(this,E,e),this.hoveredOpt.baseElem.setAttribute("aria-active-descendant","true"))}selectOpt(e,t=!0){var n;if(!e)throw new Error("opt must be defined");this.hoverOpt(e),this.confirmedOpt!==e&&(null===(n=this.confirmedOpt)||void 0===n||n.baseElem.setAttribute("aria-selected","false"),S(this,m,e),this.confirmedOpt.baseElem.setAttribute("aria-selected","true"),t&&this._onSelectOpt(e))}get confirmedOpt(){return b(this,m)}get hoveredOpt(){return b(this,E)}onOptDisabledChange(e){this.confirmedOpt===e&&(this.isValid=!e.disabled)}set isValid(e){this.isValid!==e&&(this.baseElem.setAttribute("aria-invalid",e?"false":"true"),S(this,O,e))}get isValid(){return b(this,O)}onKeyDown(e){if(" "===e.key||"Enter"===e.key)return this.selectOpt(this.hoveredOpt),e.preventDefault(),!1;{const t=this.options.indexOf(this.hoveredOpt);if("ArrowDown"===e.key||"Down"===e.key)for(let n=t+1;n<this.options.length;n++){const t=this.options[n];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}else if("ArrowUp"===e.key||"Up"===e.key)for(let n=t-1;n>=0;n--){const t=this.options[n];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}}return!0}}m=new WeakMap,E=new WeakMap,O=new WeakMap,f=v||(v={}),_=new WeakMap,g=new WeakMap,f._Option=class{constructor(){_.set(this,void 0),g.set(this,void 0);const e=this.baseElem=document.createElement("div");e.classList.add(a.a.SkPickOne.Class.OPT_BASE),e.setAttribute("role","option"),S(this,_,!1)}_registerParent(e){S(this,g,e)}get disabled(){return b(this,_)}set disabled(e){this.disabled!==e&&(this.baseElem.setAttribute("aria-disabled",e?"true":"false"),S(this,_,e),b(this,g).call(this,this))}},Object.freeze(f),Object.freeze(f.prototype),Object.freeze(v),Object.freeze(v.prototype),n(5);const T=a.a.Screen.Impl.ColourCtrl.Class;a.a.General.Class;class y extends u{constructor(){super(...arguments),this.canBeInitialScreen=!0}_lazyLoad(){const e=new y.PickOne;this.baseElem.appendChild(e.baseElem),this.sel=e;const t=localStorage.getItem(r.LocalKeys.COLOUR_ID);t&&this.sel.selectOpt(this.sel.getOptById(t),!1)}}var L;!function(e){class t extends v{constructor(){var e;if(super(),this.baseElem.classList.add(T.BASE),this.garageDoorElem=document.getElementById(a.a.Screen.Id.SCREEN_TINT),!this.garageDoorElem)throw new Error;this.garageDoorElem.style.transitionDuration=L.SMOOTH_CHANGE_DURATION/3+"ms",L.Schemes.forEach(e=>{this.addOption(new t.Option(e))}),this.selectOpt(this.getOptById(null!==(e=localStorage.getItem(r.LocalKeys.COLOUR_ID))&&void 0!==e?e:"snakey"),!1)}_onHoverOpt(e){}_onSelectOpt(e){{const e=document.documentElement.style;for(const t of L.Swatch){const n="--colour-"+t;e.setProperty(n,"")}}localStorage.setItem(r.LocalKeys.COLOUR_ID,e.desc.id),localStorage.setItem(r.LocalKeys.COLOUR_LITERAL,e.cssLiteral);const t=L.SMOOTH_CHANGE_DURATION/3,n=this.garageDoorElem.style;n.opacity="1.0",n.pointerEvents="all",this.baseElem.style.pointerEvents="none",setTimeout(()=>{document.documentElement.dataset[a.a.General.Dataset.COLOUR_SCHEME]=e.desc.id,setTimeout(()=>{n.opacity="0.0",n.pointerEvents="",this.baseElem.style.pointerEvents=""},t)},t)}getOptById(e){return this.options.find(t=>t.desc.id===e)}}e.PickOne=t,function(e){class t extends v._Option{constructor(e){super(),this.desc=e,this.baseElem.classList.add(T.OPTION);const n=document.createElement("span");n.classList.add(T.OPTION_LABEL),n.textContent=e.displayName,this.baseElem.appendChild(n);const s=document.createElement("span");s.classList.add(T.OPTION_PREVIEW),s.dataset[a.a.General.Dataset.COLOUR_SCHEME]=e.id;for(let e=0;e<t.NUM_PREVIEW_SLOTS;e++)s.appendChild(document.createElement("span"));document.body.appendChild(s);let o="";const r=window.getComputedStyle(s);for(const e of L.Swatch){const t="--colour-"+e;o+=t+":"+r.getPropertyValue(t)+";"}this.cssLiteral=o,this.baseElem.appendChild(s)}}e.Option=t,function(e){e.NUM_PREVIEW_SLOTS=5}(t=e.Option||(e.Option={})),Object.freeze(t),Object.freeze(t.prototype)}(t=e.PickOne||(e.PickOne={})),Object.freeze(t),Object.freeze(t.prototype)}(y||(y={})),Object.freeze(y),Object.freeze(y.prototype),function(e){e.Swatch=Object.freeze(["mainFg","mainBg","tileFg","tileBg","tileBd","healthFg","healthBg","pFaceMe","pFaceMeOppo","pFaceTeammate","pFaceImtlTeammate","pFaceOpponent","pFaceImtlOpponent"]),e.Schemes=Object.freeze([{id:"snakey",displayName:"Snakey",author:"N.W."},{id:"smooth-stone",displayName:"Smooth Stone",author:"Dav"},{id:"murky-dive",displayName:"Murky Dive",author:"Stressed Dav"}].map(e=>Object.freeze(e))),e.SMOOTH_CHANGE_DURATION=2e3}(L||(L={})),Object.freeze(L);var N=n(1),I=n(3);class C extends u{_lazyLoad(){this.baseElem.classList.add(a.a.Screen.Impl.Setup.Class.BASE),this.langSel=new C.LangPickOne,this.baseElem.appendChild(this.langSel.baseElem);const e=this.nextBtn=document.createElement("button");e.classList.add(a.a.Screen.Impl.Setup.Class.NEXT_BUTTON),e.textContent="Next",this.baseElem.appendChild(e)}_abstractOnBeforeEnter(){return this.nextBtn.focus(),Promise.resolve()}}!function(e){e.DEFAULT_PRESET={coordSys:I.a.System.EUCLID2,gridDimensions:{height:21,width:21},averageFreeHealthPerTile:1/45,langWeightScaling:1,langId:"engl-low",playerDescs:[{isALocalOperator:!0,familyId:"HUMAN",teamId:0,socketId:void 0,username:"hello1",noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!0,familyId:"HUMAN",teamId:1,socketId:void 0,username:"hello2",noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,socketId:void 0,username:"chaser1",noCheckGameOver:!0,familyArgs:{}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,socketId:void 0,username:"chaser2",noCheckGameOver:!0,familyArgs:{fearDistance:6,bloodThirstDistance:5,healthReserve:5,keyPressesPerSecond:1.8}}]};class t extends v{constructor(){super(),N.a.FrontendDescs.forEach(e=>{this.addOption(new t.Option(e))}),this.selectOpt(this.options[0])}_onHoverOpt(e){}_onSelectOpt(e){}}e.LangPickOne=t,function(e){class t extends v._Option{constructor(e){super(),this.desc=e,this.baseElem.textContent=e.displayName}}e.Option=t,Object.freeze(t),Object.freeze(t.prototype)}(t=e.LangPickOne||(e.LangPickOne={}))}(C||(C={})),Object.freeze(C),Object.freeze(C.prototype);class R extends C{_lazyLoad(){super._lazyLoad(),this.nextBtn.onclick=e=>{const t=Object.assign({},C.DEFAULT_PRESET);t.langId=this.langSel.confirmedOpt.desc.id,this.requestGoToScreen(u.Id.PLAY_OFFLINE,t)}}_abstractOnBeforeEnter(e){return Promise.resolve()}}Object.freeze(R),Object.freeze(R.prototype);var P,A,w,G,U=n(2),k=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function i(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((s=s.apply(e,t||[])).next())}))},B=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},H=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};class D extends u{constructor(){super(...arguments),P.set(this,void 0),A.set(this,void 0),w.set(this,void 0),G.set(this,void 0)}_lazyLoad(){this.baseElem.classList.add(a.a.General.Class.CENTER_CONTENTS,a.a.Screen.Impl.Play.Class.BASE);const e=D.createCenterColElem();this._gridBaseElem=e.grid,this._gridImplHost=e.implHost,this._gridImplHost.appendChild(document.createComment("grid impl host")),this.baseElem.appendChild(e.top),e.pauseOl.addEventListener("click",e=>{const t=this.currentGame;t&&t.status===U.a.Status.PAUSED&&this._statusBecomePlaying()}),this._initializeControlsBar(),this._initializePlayersBar(),H(this,A,()=>{if(this.wantsAutoPause)if(document.hidden){if(void 0===B(this,G)){const e=this.currentGame;(!e||e&&e.status!==U.a.Status.OVER)&&this._statusBecomePaused()}}else"page-hide"===B(this,G)&&this._statusBecomePlaying()}),H(this,w,this._gridKeyDownCallback.bind(this))}_abstractOnBeforeEnter(e){return k(this,void 0,void 0,(function*(){document.addEventListener("visibilitychange",B(this,A)),this.pauseButton.disabled=!0,this._statusBecomePaused(),H(this,P,yield this._createNewGame(e)),this._gridBaseElem.addEventListener("keydown",B(this,w)),yield this.currentGame.reset();const t=this.currentGame.htmlElements;this._gridImplHost.appendChild(t.gridImpl),this.playersBar.appendChild(t.playersBar),this.pauseButton.onclick=this._statusBecomePlaying.bind(this),this.pauseButton.disabled=!1,this.wantsAutoPause&&setTimeout(()=>{document.hidden||this._statusBecomePlaying()},500)}))}_abstractOnBeforeLeave(){if(!window.confirm("Are you sure you would like to leave?"))return!1;document.removeEventListener("visibilitychange",B(this,A));const e=this.currentGame;e.statusBecomePaused();for(const t of Object.values(e.htmlElements))t.textContent="",t.remove();return this._gridBaseElem.removeEventListener("keydown",B(this,w)),H(this,P,void 0),!0}get currentGame(){return B(this,P)}_gridKeyDownCallback(e){const t=this.currentGame;if(e.ctrlKey&&" "===e.key&&!e.repeat){const e=t.operators;t.setCurrentOperator((1+e.indexOf(t.currentOperator))%e.length)}else t.currentOperator.processKeyboardInput(e);return" "!==e.key||(e.preventDefault(),!1)}_statusBecomePlaying(){var e;const t=a.a.Grid.Dataset.GAME_STATE;null===(e=this.currentGame)||void 0===e||e.statusBecomePlaying(),this.pauseButton.textContent="Pause",H(this,G,void 0),this._gridBaseElem.dataset[t.KEY]=t.VALUES.PLAYING,window.requestAnimationFrame(e=>{this.pauseButton.onclick=this._statusBecomePaused.bind(this),this.resetButton.disabled=!0,this._gridBaseElem.focus()})}_statusBecomePaused(){var e;const t=a.a.Grid.Dataset.GAME_STATE;null===(e=this.currentGame)||void 0===e||e.statusBecomePaused(),this.pauseButton.textContent="Unpause",H(this,G,document.hidden?"page-hide":"other"),this._gridBaseElem.dataset[t.KEY]=t.VALUES.PAUSED,this.pauseButton.onclick=this._statusBecomePlaying.bind(this),this.resetButton.disabled=!1}_onGameBecomeOver(){const e=a.a.Grid.Dataset.GAME_STATE;this.pauseButton.disabled=!0,this.resetButton.disabled=!1,this._gridBaseElem.dataset[e.KEY]=e.VALUES.OVER}_resetGame(){this.currentGame.reset(),this.pauseButton.disabled=!1,this.wantsAutoPause&&this._statusBecomePlaying()}_initializeControlsBar(){const e=document.createElement("div");function t(t){const n=document.createElement("button");return n.textContent=t,n.classList.add(a.a.General.Class.INPUT_GROUP_ITEM),n.addEventListener("pointerenter",e=>{window.requestAnimationFrame(e=>{n.focus()})}),e.appendChild(n),n}e.classList.add(a.a.General.Class.CENTER_CONTENTS,a.a.General.Class.INPUT_GROUP,a.a.Screen.Impl.Play.Class.CONTROLS_BAR),e.setAttribute("role","menu"),e.addEventListener("pointerleave",e=>{window.requestAnimationFrame(e=>{this._gridBaseElem.focus()})});(this.backToHomeButton=t("Return To Homepage")).onclick=this.requestGoToScreen.bind(this,u.Id.HOME);this.pauseButton=t("");(this.resetButton=t("Reset")).onclick=this._resetGame.bind(this);this.baseElem.appendChild(e)}_initializePlayersBar(){const e=this.playersBar=document.createElement("div");e.classList.add(a.a.Screen.Impl.Play.Class.PLAYERS_BAR),this.baseElem.appendChild(e)}}P=new WeakMap,A=new WeakMap,w=new WeakMap,G=new WeakMap,(D||(D={})).createCenterColElem=function(){const e=a.a.Grid.Class,t=a.a.General.Class,n=document.createElement("div");n.classList.add(a.a.Screen.Impl.Play.Class.GRID_WRAPPER);const s=document.createElement("div");s.tabIndex=0,s.setAttribute("role","textbox"),s.setAttribute("aria-label","Game Grid"),s.classList.add(t.STACK_CONTENTS,t.TEXT_SELECT_DISABLED,e.GRID);const o=document.createElement("div");o.setAttribute("role","presentation"),o.classList.add(e.SCROLL_OUTER);{const n=document.createElement("div");n.classList.add(t.FILL_PARENT,t.CENTER_CONTENTS,e.KBD_DC);{const t=document.createElement("div");t.classList.add(e.KBD_DC_ICON),t.textContent="(click here to continue typing)",n.appendChild(t)}o.appendChild(n)}const r=document.createElement("div");r.classList.add(t.FILL_PARENT,t.CENTER_CONTENTS,e.PAUSE_OL);{const t=document.createElement("div");t.classList.add(e.PAUSE_OL_ICON),t.textContent="(Click to Unpause)",r.appendChild(t)}return o.appendChild(r),s.appendChild(o),n.appendChild(s),Object.freeze({top:n,grid:s,intersectionRoot:o,implHost:o,pauseOl:r})},Object.freeze(D),Object.freeze(D.prototype);var x=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function i(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((s=s.apply(e,t||[])).next())}))};class z extends D{constructor(){super(...arguments),this.wantsAutoPause=!0}get initialScreen(){return u.Id.SETUP_OFFLINE}_lazyLoad(){super._lazyLoad()}_createNewGame(e){return x(this,void 0,void 0,(function*(){return new((yield Promise.all([n.e(0),n.e(1)]).then(n.bind(null,26))).OfflineGame)(this._onGameBecomeOver.bind(this),e)}))}}Object.freeze(z),Object.freeze(z.prototype);class j{}!function(e){let t;e.PROTOCOL="http://",e.DEFAULT_PORT=8080,function(e){e.GROUP_LOBBY_PREFIX="/group-",e.GROUP_JOINER="/joiner"}(t=e.Nsps||(e.Nsps={}))}(j||(j={})),Object.freeze(j),Object.freeze(j.prototype);class F{}!function(e){let t,n,s;!function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(t=e.Name||(e.Name={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(n=e.Passphrase||(e.Passphrase={})),e.JoinerReconnectionAttempts=2,e.DEFAULT_TTL=60,function(e){e.EVENT_NAME="group-exist";class t{constructor(e,t){this.groupName=e,this.passphrase=t}}let n;e.RequestCreate=t,function(e){let t;!function(e){e.OKAY="okay",e.NOPE="nope"}(t=e.Response||(e.Response={}))}(t=e.RequestCreate||(e.RequestCreate={})),function(e){e.IN_LOBBY="in-lobby",e.IN_GAME="in-game",e.DELETE="delete"}(n=e.Status||(e.Status={}))}(s=e.Exist||(e.Exist={}))}(F||(F={})),Object.freeze(F),Object.freeze(F.prototype);var M,W=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function i(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((s=s.apply(e,t||[])).next())}))},V=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},Y=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n};class K extends u{constructor(){super(...arguments),M.set(this,void 0)}_lazyLoad(){this.baseElem.classList.add(a.a.General.Class.CENTER_CONTENTS,a.a.Screen.Impl.GroupJoiner.Class.BASE);const e=this._initializeFormContents(),t=this._initializeHostUrlHandlers();this._initializeGroupNameHandlers(t),this._initializePassphraseHandlers(),e.onsubmit=e=>{this.isGroupOwner?this.requestGoToScreen(u.Id.SETUP_ONLINE,{}):this.requestGoToScreen(u.Id.GROUP_LOBBY,{})},this._setFormState(q.CHOOSING_HOST),this.baseElem.appendChild(e)}_abstractOnBeforeEnter(e){return W(this,void 0,void 0,(function*(){window.setTimeout(()=>{this.socket&&this.socket.nsp.startsWith(j.Nsps.GROUP_LOBBY_PREFIX)?this.groupNameInput.focus():this.hostUrlInput.focus()},100)}))}get state(){return V(this,M)}_setFormState(e){if(this.state!==e){if(e===q.IN_GROUP){if(this.state!==q.CHOOSING_GROUP)throw new Error("never");this.passphraseInput.disabled=!0,this.nextButton.disabled=!1,this.nextButton.focus()}else this.nextButton.disabled=!0,e===q.CHOOSING_HOST?(this.groupNameInput.disabled=!0,this.groupNameInput.value="",this.groupNameDataList.innerText="",this.passphraseInput.disabled=!0,this.passphraseInput.value="",this.hostUrlInput.focus()):e===q.CHOOSING_GROUP&&(this.groupNameInput.disabled=!1,this.passphraseInput.disabled=!1,this.groupNameInput.focus());Y(this,M,e)}}_initializeHostUrlHandlers(){const e=this.top,t=this.hostUrlInput,n=()=>W(this,void 0,void 0,(function*(){var n;if(t.value.startsWith(j.PROTOCOL)||(t.value=new URL(j.PROTOCOL+t.value).origin),!t.value||!t.validity.valid)return;const s=new URL(t.value+j.Nsps.GROUP_JOINER);if(this.socket&&this.socket.nsp===j.Nsps.GROUP_JOINER&&this.socket.io.opts.hostname===s.hostname)return this.socket.connected?(this._setFormState(q.CHOOSING_GROUP),void this.groupNameInput.focus()):void 0;null===(n=this.socket)||void 0===n||n.close(),this.socket=(yield e.socketIo)(s.toString(),{reconnectionAttempts:F.JoinerReconnectionAttempts}),this.socket.on("connect",()=>{this._setFormState(q.CHOOSING_GROUP),this.socket.on(F.Exist.EVENT_NAME,this.onNotifyGroupExist.bind(this))}),this.socket.on("connect_error",e=>{this.socket=void 0,this.top.toast("Unable to connected to the specified server.")}),this.socket.on("disconnect",n=>{"io server disconnect"===n&&(this.socket=void 0,this._setFormState(q.CHOOSING_HOST),t.value="",e.toast("The server disconnected you from the group joiner."))})}));return t.oninput=e=>this._setFormState(q.CHOOSING_HOST),t.onkeydown=e=>{"Enter"===e.key&&n()},t.onpaste=e=>{window.setTimeout(()=>n(),0)},t.onchange=()=>{n()},n}onNotifyGroupExist(e){if(e===F.Exist.RequestCreate.Response.NOPE)return void this.top.toast(`The server rejected your request to create a new group "${this.groupNameInput.value}".`);const t=this.groupNameDataList,n=Array.from(t.children);for(const[s,o]of Object.entries(e)){const e=n.find(e=>e.value===s)||(()=>{const e=document.createElement("option");e.value=s;for(const s of n)if(e.value.localeCompare(s.value)<0){t.insertBefore(e,s);break}return e.parentElement||t.appendChild(e),e})();switch(o){case F.Exist.Status.IN_LOBBY:e.remove();break;case F.Exist.Status.IN_GAME:e.textContent="In Game";break;case F.Exist.Status.DELETE:e.textContent="In Lobby"}}e===F.Exist.RequestCreate.Response.OKAY&&(console.info(`server accepted request to create new group \`${this.groupNameInput.value}\`.`),console.log("connecting to new group..."),this.attemptToJoinExistingGroup())}_initializeGroupNameHandlers(e){const t=this.groupNameInput,n=()=>{t.value&&t.validity.valid&&(this.state===q.IN_GROUP?this.nextButton.focus():this.passphraseInput.focus())};this.groupNameInput.oninput=t=>W(this,void 0,void 0,(function*(){this.state===q.IN_GROUP&&(yield e()),this.passphraseInput.value="",this.isGroupOwner=!1})),t.onkeydown=e=>{"Enter"===e.key&&n()},t.onchange=e=>{n()}}_initializePassphraseHandlers(){const e=()=>W(this,void 0,void 0,(function*(){if(!this.passphraseInput.validity.valid)return;if(this.socket.nsp===j.Nsps.GROUP_LOBBY_PREFIX+this.groupNameInput.value)return this.socket.connected?(this._setFormState(q.IN_GROUP),void this.nextButton.focus()):void 0;Array.from(this.groupNameDataList.children).some(e=>e.value===this.groupNameInput.value)?(this.isGroupOwner=!1,yield this.attemptToJoinExistingGroup()):(this.isGroupOwner=!0,this.socket.emit(F.Exist.EVENT_NAME,new F.Exist.RequestCreate(this.groupNameInput.value,this.passphraseInput.value)))}));this.passphraseInput.onkeydown=t=>{"Enter"===t.key&&e()}}attemptToJoinExistingGroup(){var e;return W(this,void 0,void 0,(function*(){const t=(()=>{const e=new URL(this.hostUrlInput.value);return e.pathname=j.Nsps.GROUP_LOBBY_PREFIX+this.groupNameInput.value,e.toString()})();null===(e=this.socket)||void 0===e||e.close();const n=this.top;this.socket=(yield n.socketIo)(t,{query:{passphrase:this.passphraseInput.value}}),this.socket.on("connect",()=>{this._setFormState(q.IN_GROUP)}),this.socket.on("connect_error",e=>{this.socket=void 0,n.toast("Unable to connect to the specified group.")}),this.socket.on("disconnect",e=>{"io server disconnect"===e&&(this.socket=void 0,n.toast("The server disconnected you from your group."),this.requestGoToScreen(u.Id.GROUP_JOINER,{}))})}))}get socket(){return this.top.socket}set socket(e){this.top.socket=e}_initializeFormContents(){const e=a.a.Screen.Impl.GroupJoiner.Class,t=document.createElement("form");function n(e){const n=document.createElement("input");n.classList.add(a.a.General.Class.INPUT_GROUP_ITEM),n.type="text",n.autocomplete="off",n.spellcheck=!1;const s=document.createElement("label");return s.textContent=e,s.appendChild(n),t.appendChild(s),n}t.classList.add(a.a.General.Class.INPUT_GROUP,e.CONTENT_WRAPPER);{const t=this.hostUrlInput=n("Host URL");t.type="url",t.classList.add(e.HOST_URL),t.autocomplete="on";const s=K.SUGGEST_HOST(this.top.webpageHostType);if(s){const e=document.createElement("option");e.value=s.value,e.textContent=s.description,document.getElementById(a.a.GLOBAL_IDS.PUBLIC_GAME_HOST_URLS).insertAdjacentElement("afterbegin",e)}t.setAttribute("list",a.a.GLOBAL_IDS.PUBLIC_GAME_HOST_URLS),t.maxLength=128}{const t=this.groupNameInput=n("Group Name");t.classList.add(e.GROUP_NAME),t.pattern=F.Name.REGEXP.source,t.maxLength=F.Name.MaxLength;const s=this.groupNameDataList=document.createElement("datalist");s.id=a.a.GLOBAL_IDS.CURRENT_HOST_GROUPS,this.baseElem.appendChild(s),t.setAttribute("list",s.id)}{const t=this.passphraseInput=n("Group Passphrase");t.classList.add(e.PASSPHRASE),t.pattern=F.Passphrase.REGEXP.source,t.maxLength=F.Passphrase.MaxLength}{const n=this.nextButton=document.createElement("input");n.type="submit",n.classList.add(a.a.General.Class.INPUT_GROUP_ITEM,e.NEXT_BUTTON),n.textContent=n.value="Next",t.appendChild(n)}return t}}M=new WeakMap,function(e){let t;!function(e){e.CHOOSING_HOST="choosing-host",e.CHOOSING_GROUP="choosing-group",e.IN_GROUP="in-group"}(t=e.State||(e.State={})),e.SUGGEST_HOST=function(e){switch(e){case"github":return;case"filesystem":return{value:"localhost:"+j.DEFAULT_PORT,description:"dev shortcut :)"};case"sk-server":return{value:window.location.origin,description:"this page's server"};default:return}}}(K||(K={}));const q=K.State;Object.freeze(K),Object.freeze(K.prototype);class J extends C{get initialScreen(){return u.Id.GROUP_JOINER}_lazyLoad(){super._lazyLoad(),this.nextBtn.onclick=e=>{const t=Object.assign({},C.DEFAULT_PRESET);t.langId=this.langSel.confirmedOpt.desc.id,this.requestGoToScreen(u.Id.GROUP_LOBBY,t)}}_abstractOnBeforeEnter(e){return Promise.resolve()}}Object.freeze(J),Object.freeze(J.prototype);var X=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function i(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((s=s.apply(e,t||[])).next())}))};class $ extends u{get initialScreen(){return u.Id.GROUP_JOINER}_lazyLoad(){}_abstractOnBeforeEnter(e){return this.top.socket.once(U.a.CtorArgs.EVENT_NAME,e=>X(this,void 0,void 0,(function*(){this.requestGoToScreen(u.Id.PLAY_ONLINE,e)}))),Promise.resolve()}_abstractOnBeforeLeave(){return this.top.socket.removeListener(U.a.CtorArgs.EVENT_NAME),!0}}Object.freeze($),Object.freeze($.prototype);var Z=function(e,t,n,s){return new(n||(n=Promise))((function(o,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function i(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((s=s.apply(e,t||[])).next())}))};class Q extends D{constructor(){super(...arguments),this.wantsAutoPause=!1}get initialScreen(){return u.Id.GROUP_JOINER}_lazyLoad(){super._lazyLoad()}_createNewGame(e){return Z(this,void 0,void 0,(function*(){const t=new((yield Promise.all([n.e(0),n.e(2)]).then(n.bind(null,25))).OnlineGame)(this._onGameBecomeOver.bind(this),this.top.socket,e);return Promise.resolve(t)}))}}Object.freeze(Q),Object.freeze(Q.prototype);var ee,te,ne=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},se=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class oe{constructor(e,t){ee.set(this,void 0),t.setAttribute("role","presentation");const n=u.Id,s=e,o=t,r=this.goToScreen.bind(this);this.dict=Object.freeze({[n.HOME]:new d(n.HOME,s,o,r),[n.HOW_TO_PLAY]:new p(n.HOW_TO_PLAY,s,o,r),[n.HOW_TO_HOST]:new h(n.HOW_TO_HOST,s,o,r),[n.COLOUR_CTRL]:new y(n.COLOUR_CTRL,s,o,r),[n.SETUP_OFFLINE]:new R(n.SETUP_OFFLINE,s,o,r),[n.PLAY_OFFLINE]:new z(n.PLAY_OFFLINE,s,o,r),[n.GROUP_JOINER]:new K(n.GROUP_JOINER,s,o,r),[n.SETUP_ONLINE]:new J(n.SETUP_ONLINE,s,o,r),[n.GROUP_LOBBY]:new $(n.GROUP_LOBBY,s,o,r),[n.PLAY_ONLINE]:new Q(n.PLAY_ONLINE,s,o,r)});const a=window.location.hash.slice(1),i=this.dict[a];i&&i.initialScreen?this.goToScreen(i.initialScreen,{}):this.goToScreen(u.Id.HOME,{})}goToScreen(e,t){const n=this.dict[e];if(this.currentScreen===n)throw new Error("never happens. see comment in source.");return!(!this.currentScreen||this.currentScreen.leave())||(n.enter(t),ne(this,ee,n),!0)}get currentScreen(){return se(this,ee)}}ee=new WeakMap,Object.freeze(oe),Object.freeze(oe.prototype);class re{constructor(){te.set(this,void 0),this.webpageHostType=window.location.origin.match(/github\.io/)?re.WebpageHostType.GITHUB:window.location.protocol.startsWith("file")?re.WebpageHostType.FILESYSTEM:re.WebpageHostType.SNAKEY_SERVER;const e=document.getElementById(a.a.Screen.Id.ALL_SCREENS);if(!e)throw new Error;this.prependComment(e,"ALL SCREENS CONTAINER"),this.allScreens=new oe(this,e),console.log("%c🩺 welcome! 🐍","font:700 2.3em /1.5 monospace; margin:0.4em; border:0.3em solid black;padding:0.4em; color:white; background-color:#3f5e77; border-radius:0.7em; ")}toast(e){console.info(e)}prependComment(e,t){e.parentNode.insertBefore(document.createComment(" "+t+" "),e)}get socketIo(){return(()=>{let e;return e||new Promise((e,t)=>{const n=document.createElement("script");n.onload=()=>{e(io)},n.src=document.getElementById("socket.io-preload").href,document.body.appendChild(n)})})()}get game(){var e;return null!==(e=this.allScreens.dict.playOffline.currentGame)&&void 0!==e?e:this.allScreens.dict.playOnline.currentGame}}te=new WeakMap,function(e){let t;!function(e){e.GITHUB="github",e.FILESYSTEM="filesystem",e.SNAKEY_SERVER="sk-server"}(t=e.WebpageHostType||(e.WebpageHostType={}))}(re||(re={})),Object.freeze(re),Object.freeze(re.prototype),n(4);const ae=new re;ae.webpageHostType===re.WebpageHostType.GITHUB&&"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/ServiceWorker.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)},e=>{console.log("ServiceWorker registration failed: ",e)})}))}]);
//# sourceMappingURL=index.js.map