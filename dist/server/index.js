var snakey3=function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="dist/server/",s(s.s=14)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lang=t.Player=t.deepFreeze=t.applyMixins=t.SkErrors=void 0,function(e){e.NEVER="Never happens. See comment in source."}(t.SkErrors||(t.SkErrors={})),t.applyMixins=function(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(s=>{Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s))})})},t.deepFreeze=function e(t){for(const s of Object.getOwnPropertyNames(t)){const r=t[s];"object"==typeof r&&e(r)}return Object.freeze(t)};class r{}t.Player=r,function(e){let t;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,function(e){e.NULL=void 0}(t=e.Id||(e.Id={})),e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType}(r=t.Player||(t.Player={})),Object.freeze(r),Object.freeze(r.prototype);class i{}t.Lang=i,function(e){let t,s,r;!function(e){e.REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$")}(t=e.Seq||(e.Seq={})),function(e){e.NULL=Object.freeze({char:"",seq:""})}(s=e.CharSeqPair||(e.CharSeqPair={})),function(e){e.SEQ="SEQ",e.CHAR="CHAR",e.WEIGHT="WEIGHT"}(r=e.BalancingScheme||(e.BalancingScheme={})),e.__RemapTemplates=Object.freeze({IDENTITY:e=>e,TO_LOWER:e=>e.toLowerCase()}),e.__RemapTemplates,e.FrontendDescs=Object.freeze([{id:"engl-low",module:"English",export:"Lowercase",numLeaves:26,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"English Lowercase (QWERTY)",blurb:""},{id:"engl-mix",module:"English",export:"MixedCase",numLeaves:52,remapFunc:e.__RemapTemplates.IDENTITY,displayName:"English Mixed-Case (QWERTY)",blurb:""},{id:"japn-hir",module:"Japanese",export:"Hiragana",numLeaves:71,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"Japanese Hiragana",blurb:""},{id:"japn-kat",module:"Japanese",export:"Katakana",numLeaves:70,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"Japanese Katakana",blurb:""},{id:"kore-dub",module:"Korean",export:"Dubeolsik",numLeaves:9177,remapFunc:e.__RemapTemplates.IDENTITY,displayName:"Korean Dubeolsik (두벌식 키보드)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},{id:"kore-sub",module:"Korean",export:"Sebeolsik",numLeaves:10206,remapFunc:e.__RemapTemplates.IDENTITY,displayName:"Korean Sebeolsik (세벌식 최종 키보드)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},{id:"kore-rom",module:"Korean",export:"Romanization",numLeaves:3990,remapFunc:e.__RemapTemplates.TO_LOWER,displayName:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (국어의 로마자 표기법; 國語의 로마字 表記法) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"}].map(e=>Object.freeze(e))),e.FrontendDescs,e.GET_FRONTEND_DESC_BY_ID=function(t){const s=e.FrontendDescs.find(e=>e.id===t);if(!s)throw new Error(`Frontend descriptor of language with id "${t}" not found.`);return s}}(i=t.Lang||(t.Lang={})),Object.freeze(i),Object.freeze(i.prototype)},function(e,t,s){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0,function(e){let t,s,r,i;!function(e){e.SERVER="SERVER",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(t=e.Type||(e.Type={})),function(e){e.EVENT_NAME="game-create"}(s=e.CtorArgs||(e.CtorArgs={})),function(e){e.EVENT_NAME="game-reset"}(r=e.Serialization||(e.Serialization={})),function(e){e.PLAYING="PLAYING",e.PAUSED="PAUSED",e.OVER="OVER"}(i=e.Status||(e.Status={})),e.K=Object.freeze({HEALTH_UPDATE_CHANCE:.1,PCT_MOVES_THAT_ARE_BOOST:.05,HEALTH_EFFECT_FOR_DOWNED_PLAYER:.6,EVENT_RECORD_WRAPPING_BUFFER_LENGTH:128,EVENT_RECORD_FORWARD_WINDOW_LENGTH:64})}(r=t.Game||(t.Game={})),Object.freeze(r)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lang=void 0;const r=s(0),i=s(27);class a extends r.Lang{constructor(e,t){if(super(),this.static=e,this.treeMap=i.LangSeqTreeNode.CREATE_TREE_MAP(t),this.leafNodes=this.treeMap.getLeafNodes(),this.leafNodes.length!==this.static.frontend.numLeaves)throw new Error(`maintenance required: the frontend constant for the language "${this.static.frontend.id}" needs to be updated to the correct, computed value, which is \`${this.leafNodes.length}\`.`)}get numLeaves(){return this.leafNodes.length}reset(){this.treeMap.reset()}getNonConflictingChar(e,t){this.leafNodes.sort(i.LangSeqTreeNode.LEAF_CMP[t]);let s=void 0;for(const r of this.leafNodes){const a=r.andNonRootParents();for(let t=0;t<a.length;t++){const s=e.find(e=>e.startsWith(a[t].sequence));if(s){s===a[t].sequence?a.splice(0):a.splice(t);break}}if(a.length){a.sort(i.LangSeqTreeNode.PATH_CMP[t]),s=a[0];break}}if(!s)throw new Error("Invariants guaranteeing that a LangSeq canalways be shuffled-in were not met.");return s.chooseOnePair(t)}simpleView(){return Object.assign(Object.create(null),{id:this.static.frontend.id,displayName:this.static.frontend.displayName,root:this.treeMap.simpleView(),numLeaves:this.leafNodes.length})}}t.Lang=a,a=t.Lang||(t.Lang={}),Object.freeze(a),Object.freeze(a.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Player=t.Team=t.PlayerStatus=t.PlayerSkeleton=void 0;const r=s(1),i=s(11),a=s(24);Object.defineProperty(t,"PlayerSkeleton",{enumerable:!0,get:function(){return a.PlayerSkeleton}});const n=s(25);Object.defineProperty(t,"PlayerStatus",{enumerable:!0,get:function(){return n.PlayerStatus}});const o=s(12);Object.defineProperty(t,"Team",{enumerable:!0,get:function(){return o.Team}});class c extends a.PlayerSkeleton{constructor(e,t){if(super(e,t),!c.Username.REGEXP.test(t.username))throw new RangeError(`Username "${t.username}" does not match the required regular expression, "${c.Username.REGEXP.source}".`);this.familyId=t.familyId,this.teamId=t.teamId,this.username=t.username}reset(e){super.reset(e),this.status.reset(),this.lastAcceptedRequestId=i.PlayerActionEvent.INITIAL_REQUEST_ID,this.requestInFlight=!1}__abstractNotifyThatGameStatusBecamePlaying(){}__abstractNotifyThatGameStatusBecamePaused(){}__abstractNotifyThatGameStatusBecameOver(){}makeMovementRequest(e,t){if(this.game.status!==r.Game.Status.PLAYING)throw new Error("This is not a necessary precondition, but we're doing it anyway.");if(this.requestInFlight)throw new Error("Only one request should ever be in flight at a time.");this.requestInFlight=!0,this.game.processMoveRequest(new i.PlayerActionEvent.Movement(this.playerId,this.lastAcceptedRequestId,e,t))}get team(){return this.game.teams[this.teamId]}isTeamedWith(e){return this.team.members.includes(e)}}t.Player=c,function(e){let t,s;!function(e){e.REGEXP=/[a-zA-Z](?:[ ]?[a-zA-Z0-9:-]+?){4,}/}(t=e.Username||(e.Username={})),function(e){e.finalize=e=>{const t=Array.from(new Set(e.map(e=>e.teamId))).sort((e,t)=>e-t).reduce((e,t,s)=>(e[t]=s,e),[]);return e.slice().sort((e,s)=>t[e.teamId]-t[s.teamId]).map((e,s)=>Object.assign(e,{playerId:s,teamId:t[e.teamId]}))}}(s=e.CtorArgs||(e.CtorArgs={})),Object.freeze(s)}(c=t.Player||(t.Player={})),Object.freeze(c),Object.freeze(c.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Grid=void 0;const r=s(10);class i{constructor(e){this.static=e.gridClass,this.dimensions=e.dimensions,this.tile=new r.TileGetter(this)}get area(){return this.static.getArea(this.dimensions)}reset(){this.forEachTile(e=>e.reset())}check(){}getRandomCoord(){return this.static.getRandomCoord(this.dimensions)}}t.Grid=i,function(e){e.getImplementation=t=>e.__Constructors[t]}(i=t.Grid||(t.Grid={}))},function(e,t,s){"use strict";var r,i,a,n,o=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},c=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Tile=t.Coord=void 0;const h=s(0),l=s(23);Object.defineProperty(t,"Coord",{enumerable:!0,get:function(){return l.Coord}});class u{constructor(e){r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),n.set(this,void 0),this.coord=e,o(this,r,h.Player.Id.NULL)}reset(){this.evictOccupant(),this.lastKnownUpdateId=0,this.freeHealth=0,this.setLangCharSeqPair(h.Lang.CharSeqPair.NULL)}__setOccupant(e,t){o(this,r,e)}get isOccupied(){return this.occupantId!==h.Player.Id.NULL}evictOccupant(){o(this,r,h.Player.Id.NULL)}get occupantId(){return c(this,r)}get freeHealth(){return c(this,i)}set freeHealth(e){o(this,i,e)}setLangCharSeqPair(e){o(this,a,e.char),o(this,n,e.seq)}get langChar(){return c(this,a)}get langSeq(){return c(this,n)}}t.Tile=u,r=new WeakMap,i=new WeakMap,a=new WeakMap,n=new WeakMap,Object.freeze(u),Object.freeze(u.prototype)},function(e,t,s){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EventRecordEntry=void 0,function(e){e.EVENT_ID_REJECT=-1}(r=t.EventRecordEntry||(t.EventRecordEntry={})),Object.freeze(r)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArtificialPlayer=void 0;const r=s(1),i=s(3);class a extends i.Player{constructor(e,t){if(super(e,t),e.gameType===r.Game.Type.ONLINE)throw new TypeError("OnlineGames should be using regular Players instead.")}__abstractNotifyThatGameStatusBecamePlaying(){this.movementContinueWithInitialDelay()}__abstractNotifyThatGameStatusBecamePaused(){this.game.cancelTimeout(this.scheduledMovementCallbackId),this.scheduledMovementCallbackId=void 0}__abstractNotifyThatGameStatusBecameOver(){this.game.cancelTimeout(this.scheduledMovementCallbackId),this.scheduledMovementCallbackId=void 0}movementContinue(){this.makeMovementRequest(this.game.grid.getUntToward(this.coord,this.computeDesiredDestination()),this.getNextMoveType()),this.movementContinueWithInitialDelay()}movementContinueWithInitialDelay(){this.scheduledMovementCallbackId=this.game.setTimeout(()=>this.movementContinue(),this.computeNextMovementTimer())}}t.ArtificialPlayer=a,function(e){e.of=(t,s)=>{const r=s.familyId;return new e.__Constructors[r](t,s)}}(a=t.ArtificialPlayer||(t.ArtificialPlayer={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisibleGridMixin=t.VisibleGrid=void 0;const r=s(39);!function(e){e.getImplementation=t=>e.__Constructors[t]}(t.VisibleGrid||(t.VisibleGrid={}));class i{__VisibleGrid_super(e,t){const s=r.OmHooks.Grid;t.classList.add(s.Class.IMPL_BODY),t.dataset[s.Dataset.IMPL_COORD_SYS]=e.coordSys,this.baseElem=t;const i=document.createElement("div");i.classList.add(r.OmHooks.Player.Class.SHORT_SPOTLIGHT);const a=document.createElement("div");a.classList.add(r.OmHooks.Player.Class.LONG_SPOTLIGHT),this.spotlightElems=Object.freeze([i,a])}}t.VisibleGridMixin=i,Object.freeze(i),Object.freeze(i.prototype)},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ServerGame=void 0;const i=s(22),a=s(1),n=s(5),o=s(4),c=s(3),h=s(6),l=s(11),u=s(26);s(38).GameBootstrap.INIT_CLASS_REGISTRIES();class d extends u.GamepartManager{constructor(e,t){super(a.Game.Type.SERVER,{onGameBecomeOver:()=>{},tileClass:n.Tile,playerStatusCtor:c.PlayerStatus},t),this.namespace=e,this.playerSockets=t.playerDescs.filter(e=>e.familyId===c.Player.Family.HUMAN).map(e=>{if(!e.socketId)throw new Error;return this.namespace.sockets[e.socketId]}),this.players.filter(e=>e.familyId===c.Player.Family.HUMAN).map(e=>this.playerSockets[e.playerId]).forEach(e=>{e.removeAllListeners(l.PlayerActionEvent.EVENT_NAME.Movement),e.on(l.PlayerActionEvent.EVENT_NAME.Movement,this.processMoveRequest.bind(this)),e.removeAllListeners(l.PlayerActionEvent.EVENT_NAME.Bubble),e.on(l.PlayerActionEvent.EVENT_NAME.Bubble,this.processBubbleRequest.bind(this))}),Object.values(this.namespace.sockets).forEach(e=>{t.playerDescs.forEach(t=>{t.isALocalOperator=t.socketId===e.id}),e.emit(a.Game.CtorArgs.EVENT_NAME,t)})}__getGridImplementation(e){return o.Grid.getImplementation(e)}reset(){const e=Object.create(null,{reset:{get:()=>super.reset}});return r(this,void 0,void 0,(function*(){const t=e.reset.call(this);return this.namespace.emit(a.Game.Serialization.EVENT_NAME,this.serializeResetState()),t}))}__createOperatorPlayer(e){throw new TypeError("This should never be called for a ServerGame.")}setTimeout(e,t,...s){return i.setTimeout(e,t,s).unref()}cancelTimeout(e){clearTimeout(e)}executePlayerMoveEvent(e){super.executePlayerMoveEvent(e),e.eventId===h.EventRecordEntry.EVENT_ID_REJECT?this.playerSockets[e.playerId].emit(l.PlayerActionEvent.EVENT_NAME.Movement,e):this.namespace.emit(l.PlayerActionEvent.EVENT_NAME.Movement,e)}executePlayerBubbleEvent(e){super.executePlayerBubbleEvent(e),e.eventId===h.EventRecordEntry.EVENT_ID_REJECT?this.playerSockets[e.playerId].emit(l.PlayerActionEvent.EVENT_NAME.Bubble,e):this.namespace.emit(l.PlayerActionEvent.EVENT_NAME.Bubble,e)}}t.ServerGame=d,Object.freeze(d),Object.freeze(d.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileGetter=void 0;class r{constructor(e){this.source=e}at(...e){return this.source.__getTileAt(...e)}destsFrom(...e){return new i(this.source.__getTileDestsFrom(...e))}sourcesTo(...e){return new i(this.source.__getTileSourcesTo(...e))}}t.TileGetter=r,Object.freeze(r),Object.freeze(r.prototype);class i{constructor(e){this.contents=e}get occupied(){return this.contents=this.contents.filter(e=>e.isOccupied),this}get unoccupied(){return this.contents=this.contents.filter(e=>!e.isOccupied),this}get get(){return this.contents}}Object.freeze(i),Object.freeze(i.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerActionEvent=void 0;const r=s(6);var i;!function(e){e.INITIAL_REQUEST_ID=-1,e.EVENT_NAME=Object.freeze({Bubble:"player-bubble",Movement:"player-movement"});class t{constructor(e,t){this.eventId=r.EventRecordEntry.EVENT_ID_REJECT,this.affectedNeighbours=void 0,this.playerId=e,this.playerLastAcceptedRequestId=t}}e.Bubble=t;e.Movement=class extends t{constructor(e,t,s,r){super(e,t),this.newPlayerHealth=void 0,this.tileHealthModDescs=void 0,this.destModDesc={coord:s.coord,lastKnownUpdateId:s.lastKnownUpdateId,newCharSeqPair:void 0,newFreeHealth:void 0},this.moveType=r}}}(i=t.PlayerActionEvent||(t.PlayerActionEvent={})),Object.freeze(i)},function(e,t,s){"use strict";var r,i=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},a=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Team=void 0;class n{constructor(e,t){if(r.set(this,void 0),0===t.length)throw new Error("teams must have at least one member.");this.id=e,this.members=t,i(this,r,this.members.every(e=>e.status.noCheckGameOver)?n.ElimOrder.IMMORTAL:n.ElimOrder.STANDING)}reset(){this.elimOrder!==n.ElimOrder.IMMORTAL&&(this.elimOrder=n.ElimOrder.STANDING)}get elimOrder(){return a(this,r)}set elimOrder(e){if(this.elimOrder===n.ElimOrder.IMMORTAL)throw new Error("Cannot change the elimination status of an immortal team.");i(this,r,e)}}t.Team=n,r=new WeakMap,function(e){let t;!function(e){e.IMMORTAL=-1,e.STANDING=0}(t=e.ElimOrder||(e.ElimOrder={}))}(n=t.Team||(t.Team={})),Object.freeze(n),Object.freeze(n.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Group=t.SkServer=void 0;class r{}t.SkServer=r,function(e){let t;e.PROTOCOL="http://",e.DEFAULT_PORT=8080,function(e){e.GROUP_LOBBY_PREFIX="/group-",e.GROUP_JOINER="/joiner"}(t=e.Nsps||(e.Nsps={}))}(r=t.SkServer||(t.SkServer={})),Object.freeze(r),Object.freeze(r.prototype);class i{}t.Group=i,function(e){let t,s,r;!function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(t=e.Name||(e.Name={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(s=e.Passphrase||(e.Passphrase={})),e.JoinerReconnectionAttempts=2,e.DEFAULT_TTL=60,function(e){e.EVENT_NAME="group-exist";class t{constructor(e,t){this.groupName=e,this.passphrase=t}}let s;e.RequestCreate=t,function(e){let t;!function(e){e.OKAY="okay",e.NOPE="nope"}(t=e.Response||(e.Response={}))}(t=e.RequestCreate||(e.RequestCreate={})),function(e){e.IN_LOBBY="in-lobby",e.IN_GAME="in-game",e.DELETE="delete"}(s=e.Status||(e.Status={}))}(r=e.Exist||(e.Exist={}))}(i=t.Group||(t.Group={})),Object.freeze(i),Object.freeze(i.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.server=void 0;const r=s(15);t.server=new r.SnakeyServer},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnakeyServer=void 0;const r=s(16),i=s(17),a=s(18),n=s(19),o=s(20),c=s(21),h=s(13);class l extends h.SkServer{constructor(e=l.DEFAULT_PORT,t){super(),this.app=n(),this.http=a.createServer({},this.app),this.io=o(this.http,{serveClient:!1}),this.allGroups=new Map;const s=i.resolve(__dirname,"../..");this.app.disable("x-powered-by"),this.app.get("/",(e,t)=>{t.sendFile(i.resolve(s,"index.html"))}),this.app.use("/dist",n.static(i.resolve(s,"dist"))),this.app.use("/assets",n.static(i.resolve(s,"assets"))),this.http.listen({port:e,host:t},()=>{const t=this.http.address();console.log(`\n\nServer mounted to: \`${t.address}${t.port}\` using ${t.family}.\n`),console.log("This host can be reached at any of the following addresses:\n"),l.chooseIPAddress().sort().forEach(t=>{console.log(`${t}:${e}`)}),console.log("")}),this.io.of(l.Nsps.GROUP_JOINER).on("connection",this.onJoinerNspsConnection.bind(this))}onJoinerNspsConnection(e){console.log("socket    connect: "+e.id),e.emit(c.Group.Exist.EVENT_NAME,(()=>{const e={};return Array.from(this.allGroups).forEach(([t,s])=>{e[t]=s.isCurrentlyPlayingAGame?c.Group.Exist.Status.IN_GAME:c.Group.Exist.Status.IN_LOBBY}),e})()),e.on(c.Group.Exist.EVENT_NAME,t=>{(!t.groupName||this.allGroups.has(t.groupName)||t.groupName.length>c.Group.Name.MaxLength||!t.groupName.match(c.Group.Name.REGEXP)||t.passphrase.length>c.Group.Passphrase.MaxLength||!t.passphrase.match(c.Group.Passphrase.REGEXP))&&e.emit(c.Group.Exist.EVENT_NAME,c.Group.Exist.RequestCreate.Response.NOPE),this.allGroups.set(t.groupName,new c.Group(Object.freeze({namespace:this.io.of(l.Nsps.GROUP_LOBBY_PREFIX+t.groupName),name:t.groupName,passphrase:t.passphrase,deleteExternalRefs:()=>this.allGroups.delete(t.groupName),initialTtl:c.Group.DEFAULT_TTL}))),e.emit(c.Group.Exist.EVENT_NAME,c.Group.Exist.RequestCreate.Response.OKAY)})}}t.SnakeyServer=l,function(e){e.chooseIPAddress=()=>Object.values(r.networkInterfaces()).flat().filter(e=>!e.internal).map(e=>"IPv6"===e.family?`[${e.address}]`:e.address)}(l=t.SnakeyServer||(t.SnakeyServer={})),Object.freeze(l),Object.freeze(l.prototype)},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("socket.io")},function(e,t,s){"use strict";var r,i=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},a=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Group=void 0;const n=s(1),o=s(9),c=s(13);var h=s(9);Object.defineProperty(t,"ServerGame",{enumerable:!0,get:function(){return h.ServerGame}});class l extends c.Group{constructor(e){super(),r.set(this,void 0),this.namespace=e.namespace,this.passphrase=e.passphrase,i(this,r,void 0),this.initialTtlTimeout=setTimeout(()=>{0===Object.keys(this.namespace.connected).length&&this.terminate()},1e3*e.initialTtl).unref(),this.deleteExternalRefs=e.deleteExternalRefs,this.namespace.use((e,t)=>(e.handshake.query.passphrase!==this.passphrase&&t(new Error("Incorrect passphrase")),t())).on("connection",this.onConnection.bind(this))}onConnection(e){console.log("socket    connect: "+e.id),e.username=void 0,e.teamId=void 0,e.updateId=0,0===Object.keys(this.namespace.connected).length&&(clearTimeout(this.initialTtlTimeout),this.initialTtlTimeout=void 0,this.sessionHost=e,e.broadcast.emit(l.Exist.EVENT_NAME,{[this.name]:l.Exist.Status.IN_LOBBY}),e.on(n.Game.CtorArgs.EVENT_NAME,e=>{this.createGameInstance(e)})),e.on("disconnect",(...t)=>{e===this.sessionHost&&this.terminate(),1===Object.keys(this.namespace.sockets).length&&this.terminate()})}get isCurrentlyPlayingAGame(){return void 0!==a(this,r)}terminate(){i(this,r,void 0);const e=this.namespace;e.removeAllListeners("connect"),e.removeAllListeners("connection"),Object.values(e.connected).forEach(e=>{e.disconnect()}),e.removeAllListeners(),delete e.server.nsps[e.name],this.namespace=void 0,this.deleteExternalRefs(),console.log(`terminated group: \`${this.name}\``)}createGameInstance(e){const t={undefinedUsername:Object.values(this.sockets).filter(e=>!e.username).map(e=>e.id),undefinedTeamId:Object.values(this.sockets).filter(e=>!e.teamId).map(e=>e.id)};if(t.undefinedUsername.length||t.undefinedTeamId.length)return t;e.playerDescs=[...e.playerDescs,...Object.values(this.sockets).map(e=>Object.freeze({isALocalOperator:!1,familyId:"HUMAN",teamId:e.teamId,socketId:e.id,username:e.username,noCheckGameOver:!1,familyArgs:{}}))],i(this,r,new o.ServerGame(this.namespace,e))}get sockets(){return this.namespace.sockets}}t.Group=l,r=new WeakMap,Object.freeze(l),Object.freeze(l.prototype)},function(e,t){e.exports=require("timers")},function(e,t,s){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Coord=void 0,function(e){let t;!function(e){e.EUCLID2="EUCLID2",e.BEEHIVE="BEEHIVE"}(t=e.System||(e.System={}));class s{constructor(e){}}e.Abstract=s,function(t){class s extends e.Abstract{}t.Mathy=s}(s=e.Abstract||(e.Abstract={})),Object.freeze(s),Object.freeze(s.prototype)}(r=t.Coord||(t.Coord={})),Object.freeze(r)},function(e,t,s){"use strict";var r,i=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},a=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerSkeleton=void 0;const n=s(0),o=s(1),c=s(10);class h extends n.Player{constructor(e,t){if(super(),r.set(this,void 0),Math.trunc(t.playerId)!==t.playerId)throw new RangeError("Player ID's must be integer values.");this.playerId=t.playerId,this.isALocalOperator=t.isALocalOperator,this.game=e,this.status=new this.game.__playerStatusCtor(this,t.noCheckGameOver),this.tile=new c.TileGetter(new h.TileGetterSource(this))}__afterAllPlayersConstruction(){this.status.__afterAllPlayersConstruction()}reset(e){i(this,r,e),this.hostTile.__setOccupant(this.playerId,this.status.immigrantInfo)}get coord(){return this.hostTile.coord}get hostTile(){return a(this,r)}onGoBesideOtherPlayer(){}moveTo(e){if(this.hostTile.occupantId!==this.playerId){if(this.game.gameType!==o.Game.Type.ONLINE)throw new Error("Linkage between player and occupied tile disagrees.")}else this.hostTile.evictOccupant();if(e.isOccupied){if(this.game.gameType!==o.Game.Type.ONLINE)throw new Error("Only one player can occupy a tile at a time.")}else i(this,r,e),e.__setOccupant(this.playerId,this.status.immigrantInfo)}}t.PlayerSkeleton=h,r=new WeakMap,function(e){class t{constructor(e){this.player=e}__getTileAt(){return this.player.game.grid.tile.at(this.player.coord)}__getTileDestsFrom(){return this.player.game.grid.tile.destsFrom(this.player.coord).get}__getTileSourcesTo(){return this.player.game.grid.tile.sourcesTo(this.player.coord).get}}e.TileGetterSource=t,Object.freeze(t),Object.freeze(t.prototype)}(h=t.PlayerSkeleton||(t.PlayerSkeleton={})),Object.freeze(h),Object.freeze(h.prototype)},function(e,t,s){"use strict";var r,i=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},a=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerStatus=void 0;const n=s(12);class o{constructor(e,t){r.set(this,void 0),this.player=e,this.noCheckGameOver=t}reset(){this.health=0}__afterAllPlayersConstruction(){}get immigrantInfo(){}get health(){return i(this,r)}set health(e){const t=this.isDowned;if(a(this,r,e),t||!this.isDowned||this.noCheckGameOver)return;const s=this.player.team,i=this.player.game.teams;if(s.elimOrder===n.Team.ElimOrder.STANDING&&s.members.every(e=>e.status.noCheckGameOver||e.status.isDowned)){const e=1+i.filter(e=>e.elimOrder!==n.Team.ElimOrder.STANDING).length;s.elimOrder=1+i.filter(e=>e.elimOrder!==n.Team.ElimOrder.STANDING&&e.elimOrder!==n.Team.ElimOrder.IMMORTAL).length,e===i.length&&this.player.game.statusBecomeOver()}}get isDowned(){return this.health<0}}t.PlayerStatus=o,r=new WeakMap,Object.freeze(o),Object.freeze(o.prototype)},function(e,t,s){"use strict";var r,i,a,n=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,a){function n(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},c=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.GamepartManager=void 0;const h=s(2),l=s(1),u=s(3),d=s(28),m=s(30),p=s(7);class g extends d.GamepartEvents{constructor(e,t,n){super(e,t,n),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),this.averageFreeHealth=n.averageFreeHealthPerTile*this.grid.area,this.averageFreeHealthPerTile=n.averageFreeHealthPerTile,o(this,i,new Set),o(this,a,Promise.resolve().then(()=>s(31)(`./${this.langFrontend.module}.ts`)).then(e=>{this.lang=e[this.langFrontend.module][this.langFrontend.export].getInstance();const t=this.grid.static.getAmbiguityThreshold();if(this.lang.numLeaves<t)throw new Error(`Found ${this.lang.numLeaves} leaves, but at least ${t} were required. The provided mappings composing the current Lang-under-construction are not sufficient to ensure that a shuffling operation will always be able to find a safe candidate to use as a replacement. Please see the spec for Lang.getNonConflictingChar.`);return this.lang})),this.langBalancingScheme=n.langBalancingScheme,this.scoreInfo=new m.ScoreInfo(this.players.map(e=>e.playerId))}reset(){const e=Object.create(null,{reset:{get:()=>super.reset}});return n(this,void 0,void 0,(function*(){yield e.reset.call(this),o(this,r,0),c(this,i).clear(),yield c(this,a),this.lang.reset(),this.grid.forEachTile(e=>{e.setLangCharSeqPair(this.dryRunShuffleLangCharSeqAt(e))}),this.teams.forEach(e=>e.reset());const t=this.grid.static.getSpawnCoords(this.teams.map(e=>e.members.length),this.grid.dimensions);return this.teams.forEach((e,s)=>{e.members.forEach((e,r)=>{e.reset(this.grid.tile.at(t[s][r]))})}),this.scoreInfo.reset(),Promise.resolve()}))}__createArtifPlayer(e){return p.ArtificialPlayer.of(this,e)}dryRunShuffleLangCharSeqAt(e){e.setLangCharSeqPair(h.Lang.CharSeqPair.NULL);const t=Array.from(new Set(this.grid.tile.sourcesTo(e.coord).get.flatMap(e=>this.grid.tile.destsFrom(e.coord).get)));return this.lang.getNonConflictingChar(t.map(e=>e.langSeq).filter(e=>e),this.langBalancingScheme)}get currentFreeHealth(){return c(this,r)}get freeHealthTiles(){return c(this,i)}dryRunSpawnFreeHealth(e){let t=this.averageFreeHealth-this.currentFreeHealth;if(t<=0)return;const s=[];for(;t>0;){let r;do{r=this.grid.tile.at(this.grid.getRandomCoord())}while(r.isOccupied||s.find(e=>r.coord.equals(e.coord)));const i=1;if(Math.random()<l.Game.K.HEALTH_UPDATE_CHANCE){let t;(t=e.find(e=>r.coord.equals(e.coord)))?t.newFreeHealth=(t.newFreeHealth||0)+i:s.push({coord:r.coord,lastKnownUpdateId:1+r.lastKnownUpdateId,newCharSeqPair:void 0,newFreeHealth:r.freeHealth+i})}t-=i}return s}getHealthCostOfBoost(){return this.averageFreeHealthPerTile/l.Game.K.PCT_MOVES_THAT_ARE_BOOST}executeTileModEvent(e,t=!0){Object.freeze(e);const s=this.grid.tile.at(e.coord);if(e.lastKnownUpdateId!==1+s.lastKnownUpdateId)throw new Error("this never happens. see comment in source.");return o(this,r,c(this,r)+(e.newFreeHealth-s.freeHealth)),0===e.newFreeHealth?c(this,i).delete(s):c(this,i).add(s),super.executeTileModEvent(e,t),s}managerCheckGamePlayingRequest(e){if(this.status!==l.Game.Status.PLAYING)return;const t=this.players[e.playerId];if(!t)throw new Error("No such player exists.");if(e.playerLastAcceptedRequestId!==t.lastAcceptedRequestId)throw new RangeError(e.playerLastAcceptedRequestId<t.lastAcceptedRequestId?"Clients should not make requests until they have received my response to their last request.":"Client seems to have incremented the request ID counter on their own, which is is illegal.");return t}processMoveRequest(e){const t=this.managerCheckGamePlayingRequest(e);if(!t)return void this.executePlayerMoveEvent(e);const s=this.grid.tile.at(e.destModDesc.coord);if(s.isOccupied||s.lastKnownUpdateId!==e.destModDesc.lastKnownUpdateId)return void this.executePlayerMoveEvent(e);const r=t.status.health+s.freeHealth*(t.status.isDowned?l.Game.K.HEALTH_EFFECT_FOR_DOWNED_PLAYER:1)-(e.moveType===u.Player.MoveType.BOOST?this.getHealthCostOfBoost():0);if(r<0)return void this.executePlayerMoveEvent(e);const i=this.scoreInfo.entries[t.playerId];i.totalHealthPickedUp+=s.freeHealth,i.moveCounts[e.moveType]+=1,e.playerLastAcceptedRequestId=1+t.lastAcceptedRequestId,e.newPlayerHealth={health:r},e.destModDesc.lastKnownUpdateId=1+s.lastKnownUpdateId,e.destModDesc.newFreeHealth=0,e.destModDesc.newCharSeqPair=this.dryRunShuffleLangCharSeqAt(s),e.tileHealthModDescs=this.dryRunSpawnFreeHealth([e.destModDesc]),e.eventId=this.nextUnusedEventId,this.executePlayerMoveEvent(e)}processPlayerContact(e){}processBubbleRequest(e){const t=this.managerCheckGamePlayingRequest(e);t?(e.playerLastAcceptedRequestId=1+t.lastAcceptedRequestId,e.eventId=this.nextUnusedEventId,this.executePlayerBubbleEvent(e)):this.executePlayerBubbleEvent(e)}}t.GamepartManager=g,r=new WeakMap,i=new WeakMap,a=new WeakMap,Object.freeze(g),Object.freeze(g.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LangSeqTreeNode=void 0;const r=s(0);let i=(()=>{class e{constructor(e,t,s){this.sequence=t,this.characters=s,this.parent=e,this.children=[]}static CREATE_TREE_MAP(t){const s=new Map;for(const e in t){const r=t[e].seq,i=new a(e,t[e].weight),n=s.get(r);n?n.push(i):s.set(r,[i])}const r=new e.Root;return Array.from(s).sort((e,t)=>e[0].length-t[0].length).forEach(e=>{r.addCharMapping(...e)}),r.finalize(),r}finalize(){this.validateConstruction(),Object.freeze(this.characters),Object.freeze(this.children),this.children.forEach(e=>e.finalize())}validateConstruction(){if(!this.sequence.startsWith(this.parent.sequence))throw new Error("Child node's sequence must start with that of its parent.")}reset(){this.children.forEach(e=>e.reset()),this.inheritingHitCount=0,this.inheritingWeightedHitCount=0,this.characters.forEach(e=>{e.reset();for(let t=0;t<10*Math.random();t++)this.incrementNumHits(e)})}addCharMapping(t,s){if(!r.Lang.Seq.REGEXP.test(t))throw new RangeError(`Mapping-sequence "${t}" did not match the required regular expression "${r.Lang.Seq.REGEXP.source}".`);if(0===s.length)throw new Error("Must not make mapping without written characters.");let i=this;{let e=this;for(;e;)i=e,e=e.children.find(e=>t.startsWith(e.sequence))}if(i.sequence===t)throw new Error(`Mappings for all written-characters with a commoncorresponding typeable-sequence should be registered together,but an existing mapping for the sequence "${t}" was found.`);i.children.push(new e(i,t,s))}chooseOnePair(e){const t=this.characters.slice(0).sort(a.CMP[e]).shift(),s={char:t.char,seq:this.sequence};return this.incrementNumHits(t),s}incrementNumHits(e){e.incrementNumHits(),this.__recursiveIncrementNumHits(e.weightInv)}__recursiveIncrementNumHits(e){this.inheritingHitCount+=1,this.inheritingWeightedHitCount+=e,this.children.forEach(t=>t.__recursiveIncrementNumHits(e))}get personalHitCount(){return this.inheritingHitCount-this.parent.inheritingHitCount}get averageCharHitCount(){return this.characters.reduce((e,t)=>e+t.hitCount,0)/this.characters.length}get personalWeightedHitCount(){return this.inheritingWeightedHitCount-this.parent.inheritingWeightedHitCount}andNonRootParents(){const e=[];let t=this;for(;t.parent;)e.push(t),t=t.parent;return e}getLeafNodes(){const e=[];return this.__recursiveGetLeafNodes(e),e}__recursiveGetLeafNodes(e){this.children.length?this.children.forEach(t=>{t.__recursiveGetLeafNodes(e)}):e.push(this)}simpleView(){let e=this.characters.map(e=>e.simpleView());return Object.assign(Object.create(null),{seq:this.sequence,chars:1===e.length?e[0]:e,hits:this.personalHitCount,kids:this.children.map(e=>e.simpleView()),__proto__:void 0})}}return e.LEAF_CMP=Object.freeze({[r.Lang.BalancingScheme.SEQ]:(e,t)=>e.inheritingHitCount-t.inheritingHitCount,[r.Lang.BalancingScheme.CHAR]:(e,t)=>e.inheritingHitCount-t.inheritingHitCount,[r.Lang.BalancingScheme.WEIGHT]:(e,t)=>e.inheritingWeightedHitCount-t.inheritingWeightedHitCount}),e.PATH_CMP=Object.freeze({[r.Lang.BalancingScheme.SEQ]:(e,t)=>e.personalHitCount-t.personalHitCount,[r.Lang.BalancingScheme.CHAR]:(e,t)=>e.averageCharHitCount-t.averageCharHitCount,[r.Lang.BalancingScheme.WEIGHT]:(e,t)=>e.personalWeightedHitCount-t.personalWeightedHitCount}),e})();t.LangSeqTreeNode=i,function(e){e.Root=class extends e{constructor(){super(void 0,"",[])}validateConstruction(){}chooseOnePair(e){throw new TypeError("Must never hit on the root.")}get personalHitCount(){throw new TypeError("Must never hit on the root.")}get personalWeightedHitCount(){throw new TypeError("Must never hit on the root.")}andNonRootParents(){throw new TypeError}simpleView(){return this.children.map(e=>e.simpleView())}}}(i=t.LangSeqTreeNode||(t.LangSeqTreeNode={})),t.LangSeqTreeNode=i,Object.freeze(i),Object.freeze(i.prototype);let a=(()=>{class e{constructor(e,t){if(t<=0)throw new RangeError(`All weights must be positive, but we were passed the value "${t}" for the character "${e}".`);this.char=e,this.weightInv=1/t}reset(){this.hitCount=0,this.weightedHitCount=0}incrementNumHits(){this.hitCount+=1,this.weightedHitCount+=this.weightInv}simpleView(){return Object.assign(Object.create(null),{char:this.char,hits:this.hitCount})}}return e.CMP=Object.freeze({[r.Lang.BalancingScheme.SEQ]:(e,t)=>e.hitCount-t.hitCount,[r.Lang.BalancingScheme.CHAR]:(e,t)=>e.hitCount-t.hitCount,[r.Lang.BalancingScheme.WEIGHT]:(e,t)=>e.weightedHitCount-t.weightedHitCount}),e})();Object.freeze(a),Object.freeze(a.prototype)},function(e,t,s){"use strict";var r,i=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},a=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.GamepartEvents=void 0;const n=s(1),o=s(6),c=s(29);class h extends c.GamepartBase{constructor(e,t,s){super(e,t,s),r.set(this,void 0),this.eventRecordBitmap=[]}reset(){const e=super.reset();return this.eventRecordBitmap.fill(!1,0,n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH),i(this,r,0),e}get nextUnusedEventId(){return a(this,r)}recordEvent(e){const t=e.eventId,s=t%n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH;if(t===o.EventRecordEntry.EVENT_ID_REJECT)throw new TypeError("Do not try to record events for rejected requests.");if(t<0||t!==Math.trunc(t))throw new RangeError("Event ID's must only be assigned positive, integer values.");if(this.eventRecordBitmap[s])throw new Error("Event ID's must be assigned unique values.");this.eventRecordBitmap[s]=!0,this.eventRecordBitmap[(t+n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH-n.Game.K.EVENT_RECORD_FORWARD_WINDOW_LENGTH)%n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH]=!1,i(this,r,+a(this,r)+1)}executeTileModEvent(e,t=!0){Object.freeze(e);const s=this.grid.tile.at(e.coord);if(s.lastKnownUpdateId>e.lastKnownUpdateId)return s;if(s.lastKnownUpdateId===e.lastKnownUpdateId)throw new Error("never.");return e.newCharSeqPair&&(s.setLangCharSeqPair(e.newCharSeqPair),t&&this.operators.filter(e=>e.tile.destsFrom().get.includes(s)).forEach(e=>e.seqBufferAcceptKey(""))),s.lastKnownUpdateId=e.lastKnownUpdateId,s.freeHealth=e.newFreeHealth,s}executePlayerMoveEvent(e){var t;const s=this.players[e.playerId],r=e.playerLastAcceptedRequestId-s.lastAcceptedRequestId;if(e.eventId===o.EventRecordEntry.EVENT_ID_REJECT)return void(0===r&&(s.requestInFlight=!1));this.recordEvent(e);const i=this.executeTileModEvent(e.destModDesc,s!==this.currentOperator);if(null===(t=e.tileHealthModDescs)||void 0===t||t.forEach(e=>{this.executeTileModEvent(e)}),r>1){if(s===this.currentOperator)throw new Error("This never happens. See comment in source.")}else{if(s.requestInFlight=!1,!(s===this.currentOperator?1===r:r<=1))throw new Error("This never happens. See comment in source");s.status.health=e.newPlayerHealth.health,s.moveTo(i),s.lastAcceptedRequestId=e.playerLastAcceptedRequestId}}executePlayerBubbleEvent(e){this.players[e.playerId].requestInFlight=!1,e.eventId!==o.EventRecordEntry.EVENT_ID_REJECT&&this.recordEvent(e)}}t.GamepartEvents=h,r=new WeakMap,Object.freeze(h),Object.freeze(h.prototype)},function(e,t,s){"use strict";var r,i,a,n=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},o=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.GamepartBase=void 0;const c=s(1),h=s(0),l=s(3);class u{constructor(e,t,s){r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),this.gameType=e;const o=this.__getGridImplementation(s.coordSys);this.grid=new o({gridClass:o,tileClass:t.tileClass,coordSys:s.coordSys,dimensions:s.gridDimensions}),n(this,r,t.onGameBecomeOver),this.langFrontend=h.Lang.GET_FRONTEND_DESC_BY_ID(s.langId),this.__playerStatusCtor=t.playerStatusCtor,this.players=this.createPlayers(s),this.operators=Object.freeze(this.players.filter(e=>e.isALocalOperator)),this.setCurrentOperator(0);{const e=[];if(this.players.forEach(t=>{e[t.teamId]||(e[t.teamId]=[]),e[t.teamId].push(t)}),this.teams=e.map((e,t)=>new l.Team(t,e)),this.teams.every(e=>e.id===l.Team.ElimOrder.IMMORTAL))throw new Error("All teams are immortal. The game will never end.")}this.players.forEach(e=>e.__afterAllPlayersConstruction())}reset(){return this.grid.reset(),n(this,a,c.Game.Status.PAUSED),Promise.resolve()}createPlayers(e){const t=e.playerDescs=this.gameType===c.Game.Type.ONLINE?e.playerDescs:l.Player.CtorArgs.finalize(e.playerDescs);return Object.freeze(t.map(e=>e.familyId===l.Player.Family.HUMAN?e.isALocalOperator?this.__createOperatorPlayer(e):new l.Player(this,e):this.__createArtifPlayer(e)))}serializeResetState(){const e=[],t=this.players.map(e=>e.coord),s=[];return this.grid.forEachTile(t=>{e.push({char:t.langChar,seq:t.langSeq}),t.freeHealth&&s.push({coord:t.coord,health:t.freeHealth})}),{csps:e,playerCoords:t,healthCoords:s}}deserializeResetState(e){{let t=0;this.grid.forEachTile(s=>{s.setLangCharSeqPair(e.csps[t++]),s.lastKnownUpdateId=1})}e.playerCoords.forEach((e,t)=>{this.players[t].moveTo(this.grid.tile.at(e))}),e.healthCoords.forEach(e=>{this.grid.tile.at(e.coord).freeHealth=e.health})}get currentOperator(){return o(this,i)}setCurrentOperator(e){const t=this.operators[e];t&&this.currentOperator!==t&&(t.__notifyWillBecomeCurrent(),n(this,i,t))}get status(){return o(this,a)}statusBecomePlaying(){if(this.status!==c.Game.Status.PLAYING){if(this.status!==c.Game.Status.PAUSED)throw new Error("Can only resume a game that is currently paused.");this.players.forEach(e=>{e.__abstractNotifyThatGameStatusBecamePlaying()}),this.__abstractStatusBecomePlaying(),n(this,a,c.Game.Status.PLAYING)}else console.log("[statusBecomePlaying]: Game is already playing")}statusBecomePaused(){if(this.status!==c.Game.Status.PAUSED){if(this.status!==c.Game.Status.PLAYING)throw new Error("Can only pause a game that is currently playing.");this.players.forEach(e=>{e.__abstractNotifyThatGameStatusBecamePaused()}),this.__abstractStatusBecomePaused(),n(this,a,c.Game.Status.PAUSED)}else console.log("[statusBecomePaused]: Game is already paused")}statusBecomeOver(){if(this.status!==c.Game.Status.PLAYING)throw new Error("Can only end a game that is currently playing.");this.players.forEach(e=>{e.__abstractNotifyThatGameStatusBecameOver()}),this.__abstractStatusBecomeOver(),n(this,a,c.Game.Status.OVER),o(this,r).call(this),console.log("game is over!")}__abstractStatusBecomePlaying(){}__abstractStatusBecomePaused(){}__abstractStatusBecomeOver(){}}t.GamepartBase=u,r=new WeakMap,i=new WeakMap,a=new WeakMap,Object.freeze(u),Object.freeze(u.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScoreInfo=void 0;const r=s(0);class i{constructor(e){const t=[];for(const s of e)t[s]=new i.Entry;this.entries=t}reset(){for(const e of this.entries)e.reset()}}t.ScoreInfo=i,function(e){class t{constructor(){this.moveCounts={}}reset(){this.totalHealthPickedUp=0,Object.getOwnPropertyNames(r.Player.MoveType).forEach(e=>{this.moveCounts[e]=0})}}e.Entry=t,Object.freeze(t),Object.freeze(t.prototype)}(i=t.ScoreInfo||(t.ScoreInfo={})),Object.freeze(i),Object.freeze(i.prototype)},function(e,t,s){var r={"./Cellphone.ts":32,"./Emote.ts":33,"./English.ts":34,"./Japanese.ts":35,"./Korean.ts":36,"./Morse.ts":37};function i(e){var t=a(e);return s(t)}function a(e){if(!s.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=a,e.exports=i,i.id=31},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cellphone=void 0;class r{}t.Cellphone=r,r=t.Cellphone||(t.Cellphone={}),Object.freeze(r),Object.freeze(r.prototype)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emote=void 0;const r=s(2);var i;!function(e){class t extends r.Lang{}e.GitHub=t,Object.freeze(t),Object.freeze(t.prototype)}(i=t.Emote||(t.Emote={})),Object.freeze(i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.English=void 0;const r=s(2);var i;!function(e){let t=(()=>{class e extends r.Lang{constructor(){super(e,Object.entries(i).reduce((e,t)=>{const s=t[0],r=t[0],i=t[1];return e[s]={seq:r,weight:i},e},{}))}static getInstance(){return this.SINGLETON||(this.SINGLETON=new e),this.SINGLETON}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("engl-low"),e})();e.Lowercase=t,Object.seal(t),Object.freeze(t.prototype);let s=(()=>{class e extends r.Lang{constructor(){let t={};const s=e=>{t=Object.entries(i).reduce((t,s)=>{const r=e(s[0]),i=e(s[0]),a=s[1];return t[r]={seq:i,weight:a},t},t)};s(e=>e.toLowerCase()),s(e=>e.toUpperCase()),super(e,t)}static getInstance(){return this.SINGLETON||(this.SINGLETON=new e),this.SINGLETON}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("engl-mix"),e})();e.MixedCase=s,Object.seal(s),Object.freeze(s.prototype);const i=Object.freeze({a:8.167,b:1.492,c:2.202,d:4.253,e:12.702,f:2.228,g:2.015,h:6.094,i:6.966,j:.153,k:1.292,l:4.025,m:2.406,n:6.749,o:7.507,p:1.929,q:.095,r:5.987,s:6.327,t:9.356,u:2.758,v:.978,w:2.56,x:.15,y:1.994,z:.077})}(i=t.English||(t.English={})),Object.seal(i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Japanese=void 0;const r=s(2);var i;!function(e){let t=(()=>{class e extends r.Lang{constructor(){super(e,e.INITIALIZER)}static getInstance(){return this.SINGLETON||(this.SINGLETON=new e,this.INITIALIZER=void 0),this.SINGLETON}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("japn-hir"),e.INITIALIZER=Object.freeze({"の":{seq:"no",weight:1918313},"に":{seq:"ni",weight:1108840},"た":{seq:"ta",weight:1067566},"い":{seq:"i",weight:1060284},"は":{seq:"ha",weight:937811},"を":{seq:"wo",weight:936356},"と":{seq:"to",weight:927938},"る":{seq:"ru",weight:916652},"が":{seq:"ga",weight:860742},"し":{seq:"shi",weight:848132},"で":{seq:"de",weight:764834},"て":{seq:"te",weight:758316},"な":{seq:"na",weight:720156},"か":{seq:"ka",weight:537294},"れ":{seq:"re",weight:450805},"ら":{seq:"ra",weight:42329},"も":{seq:"mo",weight:396142},"う":{seq:"u",weight:352965},"す":{seq:"su",weight:340654},"り":{seq:"ri",weight:333999},"こ":{seq:"ko",weight:312227},"だ":{seq:"da",weight:280911},"ま":{seq:"ma",weight:278599},"さ":{seq:"sa",weight:258960},"き":{seq:"ki",weight:233505},"め":{seq:"me",weight:223806},"く":{seq:"ku",weight:221960},"あ":{seq:"a",weight:204256},"け":{seq:"ke",weight:199362},"ど":{seq:"do",weight:196555},"ん":{seq:"nn",weight:190068},"え":{seq:"e",weight:163664},"よ":{seq:"yo",weight:154206},"つ":{seq:"tsu",weight:153999},"や":{seq:"ya",weight:146156},"そ":{seq:"so",weight:131611},"わ":{seq:"wa",weight:123077},"ち":{seq:"chi",weight:99183},"み":{seq:"mi",weight:89264},"せ":{seq:"se",weight:83444},"ろ":{seq:"ro",weight:73467},"ば":{seq:"ba",weight:72228},"お":{seq:"o",weight:65870},"じ":{seq:"ji",weight:56857},"べ":{seq:"be",weight:56005},"ず":{seq:"zu",weight:53256},"げ":{seq:"ge",weight:49126},"ほ":{seq:"ho",weight:48752},"へ":{seq:"he",weight:47013},"び":{seq:"bi",weight:32312},"む":{seq:"mu",weight:31212},"ご":{seq:"go",weight:26965},"ね":{seq:"ne",weight:23490},"ぶ":{seq:"bu",weight:23280},"ぐ":{seq:"gu",weight:21549},"ぎ":{seq:"gi",weight:19865},"ひ":{seq:"hi",weight:19148},"ょ":{seq:"yo",weight:14425},"づ":{seq:"du",weight:13125},"ぼ":{seq:"bo",weight:12402},"ざ":{seq:"za",weight:12108},"ふ":{seq:"fu",weight:11606},"ゃ":{seq:"ya",weight:11522},"ぞ":{seq:"zo",weight:10047},"ゆ":{seq:"yu",weight:8486},"ぜ":{seq:"ze",weight:6893},"ぬ":{seq:"nu",weight:5124},"ぱ":{seq:"pa",weight:4349},"ゅ":{seq:"yu",weight:2755},"ぴ":{seq:"pi",weight:1608},"ぽ":{seq:"po",weight:1315},"ぷ":{seq:"pu",weight:986},"ぺ":{seq:"pe",weight:477},"ぢ":{seq:"di",weight:82}}),e})();e.Hiragana=t,Object.seal(t),Object.freeze(t.prototype);let s=(()=>{class e extends r.Lang{constructor(){super(e,e.INITIALIZER)}static getInstance(){return this.SINGLETON||(this.SINGLETON=new e,this.INITIALIZER=void 0),this.SINGLETON}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("japn-kat"),e.INITIALIZER=Object.freeze({"ン":{seq:"nn",weight:290948},"ル":{seq:"ru",weight:189442},"ス":{seq:"su",weight:178214},"ト":{seq:"to",weight:162802},"ア":{seq:"a",weight:127845},"イ":{seq:"i",weight:120807},"ラ":{seq:"ra",weight:117203},"リ":{seq:"ri",weight:106744},"ク":{seq:"ku",weight:98209},"カ":{seq:"ka",weight:82982},"シ":{seq:"shi",weight:80626},"タ":{seq:"ta",weight:75319},"ロ":{seq:"ro",weight:75301},"ド":{seq:"do",weight:74257},"ジ":{seq:"ji",weight:61171},"フ":{seq:"fu",weight:61115},"レ":{seq:"re",weight:60608},"メ":{seq:"me",weight:60230},"コ":{seq:"ko",weight:58724},"マ":{seq:"ma",weight:56123},"プ":{seq:"pu",weight:54159},"テ":{seq:"te",weight:53404},"ム":{seq:"mu",weight:50758},"チ":{seq:"chi",weight:48437},"バ":{seq:"ba",weight:44970},"ビ":{seq:"bi",weight:44462},"グ":{seq:"gu",weight:40433},"キ":{seq:"ki",weight:39608},"ウ":{seq:"u",weight:39323},"サ":{seq:"sa",weight:39202},"ニ":{seq:"ni",weight:38711},"ナ":{seq:"na",weight:38047},"エ":{seq:"e",weight:36458},"ブ":{seq:"bu",weight:35920},"パ":{seq:"pa",weight:35416},"セ":{seq:"se",weight:34883},"オ":{seq:"o",weight:34718},"ィ":{seq:"i",weight:33747},"デ":{seq:"de",weight:32665},"ュ":{seq:"yu",weight:32616},"ミ":{seq:"mi",weight:29262},"ャ":{seq:"ya",weight:28144},"ボ":{seq:"bo",weight:26651},"ダ":{seq:"da",weight:26396},"ツ":{seq:"tsu",weight:24541},"ポ":{seq:"ho",weight:23742},"ベ":{seq:"be",weight:22755},"ネ":{seq:"ne",weight:22462},"ガ":{seq:"ga",weight:22061},"ハ":{seq:"ha",weight:21839},"ワ":{seq:"wa",weight:21784},"ソ":{seq:"so",weight:20784},"ケ":{seq:"ke",weight:20633},"モ":{seq:"ho",weight:20070},"ノ":{seq:"no",weight:19572},"ズ":{seq:"zu",weight:19240},"ピ":{seq:"pi",weight:18692},"ホ":{seq:"ho",weight:18204},"ェ":{seq:"e",weight:17817},"ョ":{seq:"yo",weight:17731},"ペ":{seq:"pe",weight:14881},"ゴ":{seq:"go",weight:13931},"ヤ":{seq:"ya",weight:12526},"ギ":{seq:"gi",weight:10732},"ヨ":{seq:"yo",weight:10318},"ザ":{seq:"za",weight:10144},"ァ":{seq:"a",weight:10121},"ゼ":{seq:"ze",weight:7689},"ヒ":{seq:"hi",weight:7289},"ヘ":{seq:"he",weight:7129},"ユ":{seq:"yo",weight:6653},"ゲ":{seq:"ge",weight:6481},"ォ":{seq:"o",weight:6245},"ヌ":{seq:"nu",weight:2897},"ゾ":{seq:"zo",weight:2640},"ヴ":{seq:"vu",weight:1145},"ヂ":{seq:"di",weight:149},"ヅ":{seq:"du",weight:127},"ヲ":{seq:"wo",weight:122}}),e})();e.Katakana=s,Object.seal(s),Object.freeze(s.prototype)}(i=t.Japanese||(t.Japanese={})),Object.freeze(i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Korean=void 0;const r=s(2);var i;!function(e){let t=(()=>{class e extends r.Lang{constructor(){super(e,a((t,s,r)=>[t,s,r].flatMap(t=>t.value in e.DUB_KEYBOARD?[t.value]:t.atoms.split("")).map(t=>e.DUB_KEYBOARD[t]).join("")))}static getInstance(){return this.SINGLETON||(this.SINGLETON=new e,this.DUB_KEYBOARD=void 0),this.SINGLETON}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("kore-dub"),e.DUB_KEYBOARD=Object.freeze({"":"","ㅂ":"q","ㅈ":"w","ㄷ":"e","ㄱ":"r","ㅅ":"t","ㅛ":"y","ㅕ":"u","ㅑ":"i","ㅐ":"o","ㅔ":"p","ㅁ":"a","ㄴ":"s","ㅇ":"d","ㄹ":"f","ㅎ":"g","ㅗ":"h","ㅓ":"j","ㅏ":"k","ㅣ":"l","ㅋ":"z","ㅌ":"x","ㅊ":"c","ㅍ":"v","ㅠ":"b","ㅜ":"n","ㅡ":"m","ㅃ":"Q","ㅉ":"W","ㄸ":"E","ㄲ":"R","ㅆ":"T","ㅒ":"O","ㅖ":"P"}),e})();e.Dubeolsik=t,Object.seal(t),Object.seal(t.prototype);let s=(()=>{class e extends r.Lang{constructor(){super(e,a((t,s,r)=>e.SEB_KEYBOARD.INITIALS[t.value]+e.SEB_KEYBOARD.MEDIALS[s.value]+e.SEB_KEYBOARD.FINALS[r.value]))}static getInstance(){return this.SINGLETON||(this.SINGLETON=new e,this.SEB_KEYBOARD=void 0),this.SINGLETON}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("kore-sub"),e.SEB_KEYBOARD=Object.freeze({FINALS:{"":"","ㅎ":"1","ㅆ":"2","ㅂ":"3","ㅅ":"q","ㄹ":"w","ㅇ":"a","ㄴ":"s","ㅁ":"z","ㄱ":"x","ㄲ":"!","ㄺ":"@","ㅈ":"#","ㄿ":"$","ㄾ":"%","ㅍ":"Q","ㅌ":"W","ㄵ":"E","ㅀ":"R","ㄽ":"T","ㄷ":"A","ㄶ":"S","ㄼ":"D","ㄻ":"F","ㅊ":"Z","ㅄ":"X","ㅋ":"C","ㄳ":"V"},MEDIALS:{"ㅛ":"4","ㅠ":"5","ㅑ":"6","ㅖ":"7","ㅢ":"8","ㅕ":"e","ㅐ":"r","ㅓ":"t","ㅣ":"d","ㅏ":"f","ㅡ":"g","ㅔ":"c","ㅗ":"v","ㅜ":"b","ㅒ":"G","ㅘ":"vf","ㅙ":"vr","ㅚ":"vd","ㅝ":"bt","ㅞ":"bc","ㅟ":"bd"},INITIALS:{"ㅋ":"0","ㄹ":"y","ㄷ":"u","ㅁ":"i","ㅊ":"o","ㅍ":"p","ㄴ":"h","ㅇ":"j","ㄱ":"k","ㅈ":"l","ㅂ":";","ㅌ":"'","ㅅ":"n","ㅎ":"m","ㄲ":"!","ㄸ":"uu","ㅃ":";;","ㅆ":"nn","ㅉ":"l"}}),e})();e.Sebeolsik=s,Object.seal(s),Object.seal(s.prototype);let i=(()=>{class e extends r.Lang{constructor(){super(e,a((e,t,s)=>e.roman+t.roman+s.roman))}static getInstance(){return e.SINGLETON||(e.SINGLETON=new e),e.SINGLETON}static remapKey(e){return e}}return e.SINGLETON=void 0,e.frontend=r.Lang.GET_FRONTEND_DESC_BY_ID("kore-rom"),e})();e.Romanization=i,Object.seal(i),Object.seal(i.prototype);const a=e=>{const t={};return n.forEach((s,r)=>{o.forEach((i,a)=>{c.forEach((n,l)=>{let u=r;u=o.length*u+a,u=c.length*u+l;const d=String.fromCharCode(44032+u);t[d]={seq:e(s,i,n),weight:h[d]}})})}),t},n=Object.freeze([{value:"ㄱ",atoms:"ㄱ",roman:"g"},{value:"ㄲ",atoms:"ㄱㄱ",roman:"kk"},{value:"ㄴ",atoms:"ㄴ",roman:"n"},{value:"ㄷ",atoms:"ㄷ",roman:"d"},{value:"ㄸ",atoms:"ㄷㄷ",roman:"tt"},{value:"ㄹ",atoms:"ㄹ",roman:"r"},{value:"ㅁ",atoms:"ㅁ",roman:"m"},{value:"ㅂ",atoms:"ㅂ",roman:"b"},{value:"ㅃ",atoms:"ㅂㅂ",roman:"pp"},{value:"ㅅ",atoms:"ㅅ",roman:"s"},{value:"ㅆ",atoms:"ㅅㅅ",roman:"ss"},{value:"ㅇ",atoms:"ㅇ",roman:"-"},{value:"ㅈ",atoms:"ㅈ",roman:"j"},{value:"ㅉ",atoms:"ㅈㅈ",roman:"jj"},{value:"ㅊ",atoms:"ㅊ",roman:"ch"},{value:"ㅋ",atoms:"ㅋ",roman:"k"},{value:"ㅌ",atoms:"ㅌ",roman:"t"},{value:"ㅍ",atoms:"ㅍ",roman:"p"},{value:"ㅎ",atoms:"ㅎ",roman:"h"}]),o=Object.freeze([{value:"ㅏ",atoms:"ㅏ",roman:"a"},{value:"ㅐ",atoms:"ㅐ",roman:"ae"},{value:"ㅑ",atoms:"ㅑ",roman:"ya"},{value:"ㅒ",atoms:"ㅒ",roman:"yae"},{value:"ㅓ",atoms:"ㅓ",roman:"eo"},{value:"ㅔ",atoms:"ㅔ",roman:"e"},{value:"ㅕ",atoms:"ㅕ",roman:"yeo"},{value:"ㅖ",atoms:"ㅖ",roman:"ye"},{value:"ㅗ",atoms:"ㅗ",roman:"o"},{value:"ㅘ",atoms:"ㅗㅏ",roman:"wa"},{value:"ㅙ",atoms:"ㅗㅐ",roman:"wae"},{value:"ㅚ",atoms:"ㅗㅣ",roman:"oe"},{value:"ㅛ",atoms:"ㅛ",roman:"yo"},{value:"ㅜ",atoms:"ㅜ",roman:"u"},{value:"ㅝ",atoms:"ㅜㅓ",roman:"wo"},{value:"ㅞ",atoms:"ㅜㅔ",roman:"we"},{value:"ㅟ",atoms:"ㅜㅣ",roman:"wi"},{value:"ㅠ",atoms:"ㅠ",roman:"yu"},{value:"ㅡ",atoms:"ㅡ",roman:"eu"},{value:"ㅢ",atoms:"ㅡㅣ",roman:"ui"},{value:"ㅣ",atoms:"ㅣ",roman:"i"}]),c=Object.freeze([{value:"",atoms:"",roman:""},{value:"ㄱ",atoms:"ㄱ",roman:"k"},{value:"ㄲ",atoms:"ㄱㄱ",roman:"k"},{value:"ㄳ",atoms:"ㄱㅅ",roman:"kt"},{value:"ㄴ",atoms:"ㄴ",roman:"n"},{value:"ㄵ",atoms:"ㄴㅈ",roman:"nt"},{value:"ㄶ",atoms:"ㄴㅎ",roman:"nt"},{value:"ㄷ",atoms:"ㄷ",roman:"t"},{value:"ㄹ",atoms:"ㄹ",roman:"l"},{value:"ㄺ",atoms:"ㄹㄱ",roman:"lk"},{value:"ㄻ",atoms:"ㄹㅁ",roman:"lm"},{value:"ㄼ",atoms:"ㄹㅂ",roman:"lp"},{value:"ㄽ",atoms:"ㄹㅅ",roman:"lt"},{value:"ㄾ",atoms:"ㄹㅌ",roman:"lt"},{value:"ㄿ",atoms:"ㄹㅍ",roman:"lp"},{value:"ㅀ",atoms:"ㄹㅎ",roman:"lt"},{value:"ㅁ",atoms:"ㅁ",roman:"m"},{value:"ㅂ",atoms:"ㅂ",roman:"p"},{value:"ㅄ",atoms:"ㅂㅅ",roman:"pt"},{value:"ㅅ",atoms:"ㅅ",roman:"t"},{value:"ㅆ",atoms:"ㅅㅅ",roman:"t"},{value:"ㅇ",atoms:"ㅇ",roman:"ng"},{value:"ㅈ",atoms:"ㅈ",roman:"t"},{value:"ㅊ",atoms:"ㅊ",roman:"t"},{value:"ㅋ",atoms:"ㅋ",roman:"k"},{value:"ㅌ",atoms:"ㅌ",roman:"t"},{value:"ㅍ",atoms:"ㅍ",roman:"p"},{value:"ㅎ",atoms:"ㅎ",roman:"t"}]),h=Object.freeze({"":1})}(i=t.Korean||(t.Korean={})),Object.freeze(i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Morse=void 0;const r=s(2);var i;!function(e){class t extends r.Lang{}e.Encode=t,Object.freeze(t),Object.freeze(t.prototype);class s extends r.Lang{}e.Decode=s,Object.freeze(s),Object.freeze(s.prototype)}(i=t.Morse||(t.Morse={})),Object.freeze(i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameBootstrap=void 0;const r=s(4),i=s(8),a=s(40),n=s(41),o=s(7),c=s(42);var h;!function(e){function t(){r.Grid.__Constructors=Object.freeze({EUCLID2:a.Euclid2.Grid,BEEHIVE:n.Beehive.Grid}),Object.freeze(r.Grid),Object.freeze(r.Grid.prototype);{const e=i.VisibleGrid;e.__Constructors=Object.freeze({EUCLID2:a.Euclid2.Grid.Visible,BEEHIVE:n.Beehive.Grid.Visible}),Object.freeze(e)}{const e=o.ArtificialPlayer;e.__Constructors=Object.freeze({CHASER:c.Chaser}),Object.freeze(e),Object.freeze(e.prototype)}}e.INIT_CLASS_REGISTRIES=t,Object.freeze(t)}(h=t.GameBootstrap||(t.GameBootstrap={})),Object.freeze(h)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmHooks=void 0;const r=s(0);var i;!function(e){let t,s,r,i,a,n;e.GLOBAL_IDS={PUBLIC_GAME_HOST_URLS:"public-game-hosts-list",CURRENT_HOST_GROUPS:"current-host-groups-list"},function(e){e.Class={TEXT_SELECT_DISABLED:"text-select-disabled",FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents",INPUT_GROUP:"sk-input-group",INPUT_GROUP_ITEM:"sk-input-group-item"},e.Dataset={COLOUR_SCHEME:"skColourScheme"}}(t=e.General||(e.General={})),function(e){e.Class={BASE:"tile",POINTER_HB:"tile__pointer-hitbox",LANG_CHAR_WRAP:"tile__char",LANG_SEQ:"tile__seq"},e.Dataset={HEALTH:"health"}}(s=e.Tile||(e.Tile={})),function(e){e.Class={GRID:"game-grid",IMPL_BODY:"game-grid-impl-body",KBD_DC:"game-grid-kbd-dc",KBD_DC_ICON:"game-grid-kbd-dc__icon",PAUSE_OL:"game-grid-pause-overlay",PAUSE_OL_ICON:"game-grid-pause-overlay__icon"},e.Dataset={IMPL_COORD_SYS:"coordSys",GAME_STATE:{KEY:"gameState",VALUES:{PLAYING:"playing",PAUSED:"paused",OVER:"over"}}}}(r=e.Grid||(e.Grid={})),function(e){e.Class={BASE:"player",FACE:"player__face",DOWNED_OVERLAY:"player__downed-overlay",SHORT_SPOTLIGHT:"player__spotlight-short",LONG_SPOTLIGHT:"player__spotlight-long"},e.Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"}}(i=e.Player||(e.Player={})),function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"sk-screen"},e.Dataset={CURRENT:"current"},function(e){let t,s,r;!function(e){e.Class={BASE:"screen-home",NAV:"screen-home--nav",NAV_PLAY_OFFLINE:"screen-home--nav--play-offline",NAV_PLAY_ONLINE:"screen-home--nav--play-online",NAV_HOW_TO_PLAY:"screen-home--nav--how-to-play",NAV_HOW_TO_HOST:"screen-home--nav--how-to-host",NAV_COLOURS:"screen-home--nav--colour-scheme",NAV_VIEW_REPO:"screen-home--nav--goto-repo",NAV_RPT_ISSUE:"screen-home--nav--report-issue"}}(t=e.Home||(e.Home={})),function(e){e.Class={BASE:"screen-play",GRID_CONTAINER:"screen-play--grid-container",CONTROLS_BAR:"screen-play--controls-bar",PLAYERS_BAR:"screen-play--players-bar"}}(s=e.PlayGame||(e.PlayGame={})),function(e){e.Class={BASE:"screen-joiner",CONTENT_WRAPPER:"screen-joiner--content-wrapper",HOST_URL:"screen-joiner--host-url",GROUP_NAME:"screen-joiner--group-name",PASSPHRASE:"screen-joiner--passphrase",NEXT_BUTTON:"screen-joiner--next-button"}}(r=e.GroupJoiner||(e.GroupJoiner={}))}(t=e.Impl||(e.Impl={}))}(a=e.Screen||(e.Screen={})),function(e){e.Class={BASE:"sk-pick-one",OPT_BASE:"sk-pick-one--opt"}}(n=e.SkPickOne||(e.SkPickOne={}))}(i=t.OmHooks||(t.OmHooks={})),Object.freeze(i.Player.Dataset.DOWNED),r.deepFreeze(i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Euclid2=void 0;const r=s(0),i=s(5),a=s(4),n=s(8);var o;!function(e){class t extends i.Coord.Abstract.Mathy{constructor(e){super(e),this.x=e.x,this.y=e.y,Object.freeze(this)}equals(e){return this.x===e.x&&this.y===e.y}round(){return new t({x:Math.round(this.x),y:Math.round(this.y)})}oneNorm(e){return this.sub(e).originOneNorm()}originOneNorm(){return Math.abs(this.x)+Math.abs(this.y)}infNorm(e){return this.sub(e).originInfNorm()}originInfNorm(){return Math.max(Math.abs(this.x),Math.abs(this.y))}axialAlignment(e){return this.sub(e).originAxialAlignment()}originAxialAlignment(){return Math.abs(Math.abs(this.x)-Math.abs(this.y))/(Math.abs(this.x)+Math.abs(this.y))}add(e){return new t({x:this.x+e.x,y:this.y+e.y})}sub(e){return new t({x:this.x-e.x,y:this.y-e.y})}mul(e){return new t({x:e*this.x,y:e*this.y})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);let s=(()=>{class e extends a.Grid{constructor(e){super(e);const s=[];for(let r=0;r<this.dimensions.height;r++){const i=[];for(let s=0;s<this.dimensions.width;s++){const a=new e.tileClass(new t({x:s,y:r}));i.push(a)}s.push(i)}this.grid=s}static getAmbiguityThreshold(){return 24}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e,t=this){for(const t of this.grid)for(const s of t)e(s)}getUntToward(e,t){const s=this.tile.destsFrom(e).unoccupied.get;if(0===s.length)return this.tile.at(e);if(1===s.length)return s[0];s.sort((e,s)=>e.coord.oneNorm(t)-s.coord.oneNorm(t)).sort((e,s)=>e.coord.infNorm(t)-s.coord.infNorm(t));for(let e=1;e<s.length;e++)if(s[e].coord.infNorm(t)>s[0].coord.infNorm(t)){s.splice(e);break}if(1===s.length)return s[0];if(s[0].coord.x-e.x==0||s[0].coord.y-e.y==0){if(e.axialAlignment(e.sub(t))-.5>0)return s[0];s.shift()}return s[Math.floor(s.length*Math.random())]}getUntAwayFrom(e,t){return this.getUntToward(e,e.add(e.sub(t)))}getRandomCoordAround(e,s){return new t({x:e.x+Math.trunc(2*s*(Math.random()-.5)),y:e.y+Math.trunc(2*s*(Math.random()-.5))})}__getTileAt(e){if(e.x<0||e.x>=this.dimensions.width||e.y<0||e.y>=this.dimensions.height)throw new RangeError("Out of bounds. No such tile exists.");return this.grid[e.y][e.x]}__getTileDestsFrom(e,t=1){let s=e.y-t,r=e.y+t+1,i=e.x-t,a=e.x+t+1;return s>=this.dimensions.height||r<0||i>=this.dimensions.width||a<0?[]:this.grid.slice(Math.max(0,s),Math.min(this.dimensions.height,r)).flatMap(e=>e.slice(Math.max(0,i),Math.min(this.dimensions.width,a)))}__getTileSourcesTo(e,t=1){return this.__getTileDestsFrom(e,t)}minMovesFromTo(e,t){return Math.min(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}static getSpawnCoords(t,s){const r=[];return t.map(t=>{const i=[];for(;t>0;){let a;do{a=e.getRandomCoord(s)}while(r.find(e=>a.equals(e)));i.push(a),r.push(a),t--}return i})}static getArea(e){return e.height*e.width}static getRandomCoord(e){const s=Math.floor(e.width*Math.random()),r=Math.floor(e.height*Math.random());return new t({x:s,y:r})}}return e.SIZE_LIMITS=Object.freeze({height:Object.freeze({min:11,max:51}),width:Object.freeze({min:11,max:51})}),e})();e.Grid=s,function(e){class t extends e{constructor(e){super(e);const t=document.createElement("div");t.style.setProperty("--euclid2-grid-width",this.dimensions.width.toString());for(const e of this.grid)for(const s of e)s.__addToDom(t);this.__VisibleGrid_super(e,t)}}e.Visible=t,r.applyMixins(t,[n.VisibleGridMixin]),Object.freeze(t),Object.freeze(t.prototype)}(s=e.Grid||(e.Grid={})),Object.freeze(s),Object.freeze(s.prototype)}(o=t.Euclid2||(t.Euclid2={})),Object.freeze(o)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Beehive=void 0;const r=s(0),i=s(5),a=s(4),n=s(8);var o;!function(e){class t extends i.Coord.Abstract.Mathy{constructor(e){super(e),this.dash=e.dash,this.bash=e.bash,Object.freeze(this)}equals(e){return this.dash===e.dash&&this.bash===e.bash}round(){const e=Math.floor(this.dash),s=Math.floor(this.bash),r=e-this.dash,i=s-this.bash;return r>2*i?new t({dash:e+1,bash:s}):r<.5*i?new t({dash:e,bash:s+1}):Math.min(r,i)>.5?new t({dash:e+1,bash:s+1}):new t({dash:e,bash:s})}add(e){return new t({dash:this.dash+e.dash,bash:this.bash+e.bash})}sub(e){return new t({dash:this.dash-e.dash,bash:this.bash-e.bash})}mul(e){return new t({dash:e*this.dash,bash:e*this.bash})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);let s=(()=>{class e extends a.Grid{constructor(e){super(e)}static getAmbiguityThreshold(){return 18}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e,t=this){this.grid.forEach(s=>s.forEach(t=>{e(t)},t),t)}getUntToward(e,t){}getUntAwayFrom(e,t){return this.getUntToward(e,e.add(e.sub(t)))}getRandomCoordAround(e,t){}__getTileAt(e){}__getTileDestsFrom(e){}__getTileSourcesTo(e){}minMovesFromTo(e,t){}static getSpawnCoords(e,t){}static getArea(e){const t=Math.min(e.fslash,e.bslash),s=Math.max(e.fslash,e.bslash),r=-1+e.dash+t;let i=2*t*(e.dash+r);return i+=(s-t-1)*r,i}static getRandomCoord(e){return new t(void 0)}}return e.SIZE_LIMITS=Object.freeze({dash:Object.freeze({min:10,max:50}),bslash:Object.freeze({min:10,max:50}),fslash:Object.freeze({min:10,max:50})}),e})();e.Grid=s,function(e){class t extends e{constructor(e){super(e);this.__VisibleGrid_super(e,void 0)}}e.Visible=t,r.applyMixins(t,[n.VisibleGridMixin]),Object.freeze(t),Object.freeze(t.prototype)}(s=e.Grid||(e.Grid={})),Object.freeze(s),Object.freeze(s.prototype)}(o=t.Beehive||(t.Beehive={})),Object.freeze(o)},function(e,t,s){"use strict";var r,i=this&&this.__classPrivateFieldSet||function(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s},a=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Chaser=void 0;const n=s(3),o=s(7);class c extends o.ArtificialPlayer{constructor(e,t){super(e,t),r.set(this,void 0),this.behaviour=Object.freeze(t.familyArgs),this.grid=this.game.grid}__afterAllPlayersConstruction(){super.__afterAllPlayersConstruction(),this.threatProximity=this.game.teams.filter(e=>e.id!==this.teamId).flatMap(e=>e.members),this.targetProximity=this.threatProximity.slice()}reset(e){super.reset(e),i(this,r,this.coord)}moveTo(e){i(this,r,this.coord),super.moveTo(e)}computeDesiredDestination(){this.threatProximity.sort((e,t)=>this.grid.minMovesFromTo(e.coord,this.coord)-this.grid.minMovesFromTo(t.coord,this.coord));for(const e of this.threatProximity){if(this.grid.minMovesFromTo(e.coord,this.coord)>this.behaviour.fearDistance)break;if(!e.status.isDowned&&e.status.health>this.status.health)return this.grid.getUntAwayFrom(this.coord,e.coord).coord}if(this.targetProximity.sort((e,t)=>this.grid.minMovesFromTo(this.coord,e.coord)-this.grid.minMovesFromTo(this.coord,t.coord)),this.status.isDowned)for(const e of this.targetProximity){if(this.grid.minMovesFromTo(this.coord,e.coord)>this.behaviour.bloodThirstDistance)break;if(e.status.health<this.status.health-this.behaviour.healthReserve)return e.coord}if(0===this.game.freeHealthTiles.size){const e=.2;return Math.random()<e?this.grid.getRandomCoordAround(this.coord,3):this.grid.getRandomCoordAround(this.grid.getUntAwayFrom(this.grid.getUntAwayFrom(this.coord,a(this,r)).coord,a(this,r)).coord,1)}let e=void 0,t=1/0;for(const s of this.game.freeHealthTiles){const r=this.grid.minMovesFromTo(this.coord,s.coord);r<t&&(e=s,t=r)}return e.coord}getNextMoveType(){return n.Player.MoveType.NORMAL}computeNextMovementTimer(){return 1e3/this.behaviour.movesPerSecond}}t.Chaser=c,r=new WeakMap,Object.freeze(c),Object.freeze(c.prototype)}]);
//# sourceMappingURL=index.js.map