var snakey3;snakey3=(()=>{var e,t={406:(e,t,s)=>{"use strict";var r;s.r(t),s.d(t,{JsUtils:()=>r}),function(e){let t;function s(e,t,s){t.forEach((t=>{if(!Object.getOwnPropertyNames(e).includes(t)){const s=`\`${e.__proto__.constructor.name}\` instance has no property named "${t}"`;throw new TypeError(s)}Object.defineProperty(e,t,s)}))}e.applyMixins=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((s=>{Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s))}))}))},e.deepFreeze=function e(t){return function(t){for(const s of Object.getOwnPropertyNames(t)){const r=t[s];"object"==typeof r&&e(r)}Object.freeze(t)}(t),t},function(e){let t;!function(e){e.access=function(e,t,s){s.enumerable=!1},e.cyclic=function(e,t,s){s.enumerable=!1}}(t=e.NonEnumerable||(e.NonEnumerable={}))}(t=e.Decor||(e.Decor={})),e.protoNoEnum=function(e,t){t.forEach((t=>{if(!Object.getOwnPropertyNames(e.prototype).includes(t)){const s=`\`${e.name}\` prototype has no property named "${t}"`;throw new TypeError(s)}Object.defineProperty(e.prototype,t,{enumerable:!1})}))},e.instNoEnum=function(e,t){s(e,t,{enumerable:!1})},e.propNoWrite=function(e,t){s(e,t,{writable:!1})},e.prependComment=function(e,t){e.parentNode.insertBefore(document.createComment(" "+t+" "),e)},e.camelCaseTransforms=function(e){const t=e.replace(/[A-Z]/g,(e=>" "+e.toLowerCase()));return Object.freeze({spaceyLowercase:t,spaceyUppercase:t.toUpperCase(),spaceyCapitalized:t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ")})},e.mkEl=function(e,t,s){const r=document.createElement(e);try{Object.seal(r)}catch(e){}return r.classList.add(...t),"button"===e?r.type="button":"a"===e&&(r.rel="noopener"),void 0!==s&&Object.assign(r,s),r}}(r||(r={})),Object.freeze(r)},502:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SkServer:()=>r,Group:()=>i,GroupEv:()=>a,GameEv:()=>o});class r{}!function(e){var t;let s;e.PROTOCOL="http://",e.DEFAULT_PORT=(null===(t=null===process||void 0===process?void 0:process.env)||void 0===t?void 0:t.PORT)||80,function(e){e.GROUP_JOINER="/joiner.",e.GROUP_LOBBY_PREFIX="/group.",e.GROUP_GAME_PREFIX="/group-game."}(s=e.Nsps||(e.Nsps={}))}(r||(r={})),Object.freeze(r),Object.freeze(r.prototype);class i{}var a,o;!function(e){let t,s,r,i;!function(e){let t;!function(e){e.EVENT_NAME="group-lobby-user-info-change"}(t=e.UserInfoChange||(e.UserInfoChange={}))}(t=e.Socket||(e.Socket={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(s=e.Name||(e.Name={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]*)/,e.MaxLength=30}(r=e.Passphrase||(e.Passphrase={})),e.GameServerReconnectionAttempts=2,e.DEFAULT_TTL=20,function(e){e.EVENT_NAME="group-exist";class t{constructor(e,t){this.groupName=e,this.passphrase=t}}let s;e.RequestCreate=t,function(e){let t;!function(e){e.OKAY="okay",e.NOPE="nope"}(t=e.Response||(e.Response={}))}(t=e.RequestCreate||(e.RequestCreate={})),function(e){e.IN_LOBBY="in-lobby",e.IN_GAME="in-game",e.DELETE="delete"}(s=e.Status||(e.Status={}))}(i=e.Exist||(e.Exist={}))}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype),function(e){e.CREATE_GAME="group-game-create"}(a||(a={})),function(e){e.CREATE_GAME="game-create",e.RESET="game-reset",e.UNPAUSE="game-unpause",e.PAUSE="game-pause",e.RETURN_TO_LOBBY="game-return-to-lobby"}(o||(o={}))},951:(e,t,s)=>{"use strict";s.d(t,{J5:()=>r,Uo:()=>i}),Object.freeze({behavior:"smooth",block:"center",inline:"center"});class r{}!function(e){let t,s,r;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,function(e){e.NULL=void 0}(t=e.Id||(e.Id={})),function(e){e.REGEXP=/[ a-zA-Z0-9:-]+/,e.MAX_LENGTH=15}(s=e.Username||(e.Username={})),function(e){e.LOREM_IPSUM="lorem-ipsum"}(r=e.Avatar||(e.Avatar={})),function(e){const t=Object.values(e).filter((e=>"string"==typeof e));e.GET_RANDOM=function(){return t[Math.random()*t.length]}}(r=e.Avatar||(e.Avatar={})),e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType}(r||(r={})),Object.freeze(r),Object.freeze(r.prototype);class i{}!function(e){let t,s,r;!function(e){e.REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$")}(t=e.Seq||(e.Seq={})),function(e){e.NULL=Object.freeze({char:"",seq:""})}(s=e.CharSeqPair||(e.CharSeqPair={})),function(e){e.MAX=4}(r=e.WeightExaggeration||(e.WeightExaggeration={})),e.CHAR_HIT_COUNT_SEED_CEILING=5,e._RemapTemplates=Object.freeze({IDENTITY:e=>e,TO_LOWER:e=>e.toLowerCase()}),e._RemapTemplates,e.FrontendDescs=Object.freeze([{id:"engl-low",module:"English",export:"Lowercase",numLeaves:26,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"English Lowercase (qwerty)",blurb:""},{id:"engl-mix",module:"English",export:"MixedCase",numLeaves:52,remapFunc:e._RemapTemplates.IDENTITY,displayName:"English Mixed-Case (Querty)",blurb:""},{id:"japn-hir",module:"Japanese",export:"Hiragana",numLeaves:71,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"Japanese Hiragana",blurb:""},{id:"japn-kat",module:"Japanese",export:"Katakana",numLeaves:70,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"Japanese Katakana",blurb:""},{id:"kore-dub",module:"Korean",export:"Dubeolsik",numLeaves:9177,remapFunc:e._RemapTemplates.IDENTITY,displayName:"Korean Dubeolsik (두벌식 키보드)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},{id:"kore-sub",module:"Korean",export:"Sebeolsik",numLeaves:10206,remapFunc:e._RemapTemplates.IDENTITY,displayName:"Korean Sebeolsik (세벌식 최종 키보드)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},{id:"kore-rom",module:"Korean",export:"Romanization",numLeaves:3990,remapFunc:e._RemapTemplates.TO_LOWER,displayName:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (국어의 로마자 표기법; 國語의 로마字 表記法) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"},{id:"engl-cell-enc",module:"English",export:"OldCellphone.Encode",numLeaves:8,remapFunc:e._RemapTemplates.IDENTITY,displayName:"Old Cellphone Keyboard",blurb:""}].map((e=>Object.freeze(e)))),e.FrontendDescs,e.GET_FRONTEND_DESC_BY_ID=function(t){return e.FrontendDescs.find((e=>e.id===t))}}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype)},985:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Grid:()=>a});var r=s(406),i=s(495);class a{constructor(e){this.static=e.gridClass,this.dimensions=e.dimensions,this.tile=new i.N(this),r.JsUtils.propNoWrite(this,["static","dimensions","tile"])}get area(){return this.static.getArea(this.dimensions)}reset(){this.forEachTile((e=>e.reset()))}getDestsFromSourcesTo(e){return Array.from(new Set(this.tile.sourcesTo(e).get.flatMap((e=>this.tile.destsFrom(e.coord).get))))}getRandomCoord(){return this.static.getRandomCoord(this.dimensions)}}!function(e){e.getImplementation=t=>e._Constructors[t]}(a||(a={}))},789:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Tile:()=>h});var r,i,a,o,n=s(780),l=s(406),c=s(951);class h{constructor(e){r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),this.coord=e,l.JsUtils.propNoWrite(this,["coord"]),(0,n.__classPrivateFieldSet)(this,r,c.J5.Id.NULL)}reset(){this.evictOccupant(),this.lastKnownUpdateId=0,this.freeHealth=0,this.setLangCharSeqPair(c.Uo.CharSeqPair.NULL)}_setOccupant(e,t){(0,n.__classPrivateFieldSet)(this,r,e)}get isOccupied(){return this.occupantId!==c.J5.Id.NULL}evictOccupant(){(0,n.__classPrivateFieldSet)(this,r,c.J5.Id.NULL)}get occupantId(){return(0,n.__classPrivateFieldGet)(this,r)}get freeHealth(){return(0,n.__classPrivateFieldGet)(this,i)}set freeHealth(e){(0,n.__classPrivateFieldSet)(this,i,e)}setLangCharSeqPair(e){(0,n.__classPrivateFieldSet)(this,a,e.char),(0,n.__classPrivateFieldSet)(this,o,e.seq)}get langChar(){return(0,n.__classPrivateFieldGet)(this,a)}get langSeq(){return(0,n.__classPrivateFieldGet)(this,o)}}r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,Object.freeze(h),Object.freeze(h.prototype)},495:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});var r,i=s(780);class a{constructor(e){r.set(this,void 0),(0,i.__classPrivateFieldSet)(this,r,e),Object.freeze(this)}get _source(){return(0,i.__classPrivateFieldGet)(this,r)}at(...e){return(0,i.__classPrivateFieldGet)(this,r)._getTileAt(...e)}destsFrom(...e){return new o((0,i.__classPrivateFieldGet)(this,r)._getTileDestsFrom(...e))}sourcesTo(...e){return new o((0,i.__classPrivateFieldGet)(this,r)._getTileSourcesTo(...e))}}r=new WeakMap,Object.freeze(a),Object.freeze(a.prototype);class o{constructor(e){this.contents=e,Object.seal(this)}get occupied(){return this.contents=this.contents.filter((e=>e.isOccupied)),this}get unoccupied(){return this.contents=this.contents.filter((e=>!e.isOccupied)),this}get get(){return this.contents}}Object.freeze(o),Object.freeze(o.prototype)},504:(e,t,s)=>{"use strict";var r;s.r(t),s.d(t,{Game:()=>r}),function(e){let t,s;!function(e){e.SERVER="SERVER",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(t=e.Type||(e.Type={})),Object.freeze(t),function(e){e.PLAYING="PLAYING",e.PAUSED="PAUSED",e.OVER="OVER"}(s=e.Status||(e.Status={})),Object.freeze(s),e.K=Object.freeze({HEALTH_UPDATE_CHANCE:.1,AVERAGE_HEALTH_TO_SPAWN_ON_TILE:1,PORTION_OF_MOVES_THAT_ARE_BOOST:.4,HEALTH_COST_OF_BOOST(e,t){const s=t(this.AVERAGE_HEALTH_TO_SPAWN_ON_TILE/e);return this.AVERAGE_HEALTH_TO_SPAWN_ON_TILE/s/this.PORTION_OF_MOVES_THAT_ARE_BOOST},HEALTH_EFFECT_FOR_DOWNED_PLAYER:.6,EVENT_RECORD_WRAPPING_BUFFER_LENGTH:128,EVENT_RECORD_FORWARD_WINDOW_LENGTH:64})}(r||(r={})),Object.freeze(r)},671:(e,t,s)=>{"use strict";var r;s.r(t),s.d(t,{EventRecordEntry:()=>r}),function(e){e.EVENT_ID_REJECT=-1}(r||(r={})),Object.freeze(r)},699:(e,t,s)=>{"use strict";s.r(t),s.d(t,{PlayerActionEvent:()=>r});var r,i=s(671);!function(e){e.INITIAL_REQUEST_ID=-1,e.EVENT_NAME=Object.freeze({BUBBLE:"player-bubble",MOVEMENT:"player-movement"});class t{constructor(e,t){this.eventId=i.EventRecordEntry.EVENT_ID_REJECT,this.affectedNeighbours=void 0,this.playerId=e,this.playerLastAcceptedRequestId=t}}e.Bubble=t,e.Movement=class extends t{constructor(e,t,s,r){super(e,t),this.newPlayerHealth=void 0,this.tileHealthModDescs=void 0,this.destModDesc={coord:s.coord,lastKnownUpdateId:s.lastKnownUpdateId,newCharSeqPair:void 0,newFreeHealth:void 0},this.moveType=r}}}(r||(r={})),Object.freeze(r)},604:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GamepartManager:()=>j});var r,i=s(780),a=s(406),o=s(979),n=s(504);!function(e){let t;!function(e){e.EUCLID2="EUCLID2",e.BEEHIVE="BEEHIVE"}(t=e.System||(e.System={})),e.equals=function(e,t){return e._equals(t)}}(r||(r={})),Object.freeze(r);var l=s(216);class c extends l.Player{constructor(e,t){if(super(e,t),e.gameType===n.Game.Type.ONLINE)throw new TypeError("OnlineGames should be using regular Players instead.")}_notifyGameNowPlaying(){this.delayedMovementContinue()}_notifyGameNowPaused(){this.game.cancelTimeout(this._scheduledMovementCallbackId),this._scheduledMovementCallbackId=void 0}_notifyGameNowOver(){this.game.cancelTimeout(this._scheduledMovementCallbackId),this._scheduledMovementCallbackId=void 0}movementContinue(){const e=this.computeDesiredDest();this._nextMovementTimerMultiplier=this.game.grid.tile.at(e).langSeq.length,this.makeMovementRequest(this.game.grid.getUntToward(e,this.coord),this.getNextMoveType()),this.delayedMovementContinue()}delayedMovementContinue(){this._scheduledMovementCallbackId=this.game.setTimeout(this.movementContinue.bind(this),this.computeNextMovementTimer()*this._nextMovementTimerMultiplier)}}!function(e){e.of=(t,s)=>{const r=s.familyId;return new e._Constructors[r](t,s)}}(c||(c={})),a.JsUtils.protoNoEnum(c,["movementContinue"]);var h=s(951);class d{constructor(e){const t=[];for(const s of e)t[s]=new d.Entry;this.entries=t,a.JsUtils.propNoWrite(this,["entries"])}reset(){for(const e of this.entries)e.reset()}}!function(e){class t{constructor(){this.moveCounts={}}reset(){this.totalHealthPickedUp=0,Object.getOwnPropertyNames(h.J5.MoveType).forEach((e=>{this.moveCounts[e]=0}))}}e.Entry=t,Object.freeze(t),Object.freeze(t.prototype)}(d||(d={})),Object.freeze(d),Object.freeze(d.prototype);var u,p,m,E,_=s(671),g=(s(699),s(473));class f{constructor(e,t,s){u.set(this,void 0),p.set(this,void 0),m.set(this,void 0),this.gameType=e;const r=this._getGridImplementation(s.coordSys);this.grid=new r({gridClass:r,tileClass:t.tileClass,coordSys:s.coordSys,dimensions:s.gridDimensions}),(0,i.__classPrivateFieldSet)(this,u,t.onGameBecomeOver),this.langFrontend=h.Uo.GET_FRONTEND_DESC_BY_ID(s.langId),this._playerStatusCtor=t.playerStatusCtor,this.players=this.createPlayers(s),this.operators=Object.freeze(this.players.filter((e=>e.isALocalOperator))),this.setCurrentOperator(0);{const e=[];if(this.players.forEach((t=>{e[t.teamId]||(e[t.teamId]=[]),e[t.teamId].push(t)})),this.teams=e.map(((e,t)=>new g.S(t,e))),this.teams.every((e=>e.id===g.S.ElimOrder.IMMORTAL)))throw new Error("All teams are immortal. The game will never end.")}a.JsUtils.propNoWrite(this,["gameType","grid","langFrontend","players","operators","teams","_playerStatusCtor"]),this.players.forEach((e=>e._afterAllPlayersConstruction()))}reset(){return this.grid.reset(),(0,i.__classPrivateFieldSet)(this,m,n.Game.Status.PAUSED),Promise.resolve()}createPlayers(e){const t=e.playerDescs=this.gameType===n.Game.Type.ONLINE?e.playerDescs:l.Player.CtorArgs.finalize(e.playerDescs);return Object.freeze(t.map((e=>e.familyId===l.Player.Family.HUMAN?e.isALocalOperator?this._createOperatorPlayer(e):new l.Player(this,e):this._createArtifPlayer(e))))}serializeResetState(){const e=[],t=this.players.map((e=>e.coord)),s=[];return this.grid.forEachTile((t=>{t.lastKnownUpdateId++,e.push({char:t.langChar,seq:t.langSeq}),t.freeHealth&&s.push({coord:t.coord,health:t.freeHealth})})),{csps:e,playerCoords:t,healthCoords:s}}deserializeResetState(e){this.grid.forEachTile(((t,s)=>{t.setLangCharSeqPair(e.csps[s]),t.lastKnownUpdateId++})),e.playerCoords.forEach(((e,t)=>{this.players[t].reset(this.grid.tile.at(e))})),e.healthCoords.forEach((e=>{this.grid.tile.at(e.coord).freeHealth=e.health}))}get currentOperator(){return(0,i.__classPrivateFieldGet)(this,p)}setCurrentOperator(e){const t=this.operators[e];this.currentOperator!==t&&(t._notifyWillBecomeCurrent(),(0,i.__classPrivateFieldSet)(this,p,t))}get status(){return(0,i.__classPrivateFieldGet)(this,m)}statusBecomePlaying(){if(this.status!==n.Game.Status.PLAYING){if(this.status!==n.Game.Status.PAUSED)throw new Error("Can only resume a game that is currently paused.");this.players.forEach((e=>{e._notifyGameNowPlaying()})),this._abstractStatusBecomePlaying(),(0,i.__classPrivateFieldSet)(this,m,n.Game.Status.PLAYING)}else console.log("[statusBecomePlaying]: Game is already playing")}statusBecomePaused(){this.status!==n.Game.Status.PAUSED?this.status!==n.Game.Status.OVER&&(this.players.forEach((e=>{e._notifyGameNowPaused()})),this._abstractStatusBecomePaused(),(0,i.__classPrivateFieldSet)(this,m,n.Game.Status.PAUSED)):console.log("[statusBecomePaused]: Game is already paused")}statusBecomeOver(){if(this.status!==n.Game.Status.PLAYING)throw new Error("Can only end a game that is currently playing.");this.players.forEach((e=>{e._notifyGameNowOver()})),this._abstractStatusBecomeOver(),(0,i.__classPrivateFieldSet)(this,m,n.Game.Status.OVER),(0,i.__classPrivateFieldGet)(this,u).call(this),console.log("game is over!")}_abstractStatusBecomePlaying(){}_abstractStatusBecomePaused(){}_abstractStatusBecomeOver(){}}u=new WeakMap,p=new WeakMap,m=new WeakMap,a.JsUtils.protoNoEnum(f,["_abstractStatusBecomePlaying","_abstractStatusBecomePaused","_abstractStatusBecomeOver"]),Object.freeze(f),Object.freeze(f.prototype);class v extends f{constructor(e,t,s){super(e,t,s),E.set(this,void 0),this.eventRecordBitmap=[]}reset(){const e=super.reset();return this.eventRecordBitmap.fill(!1,0,n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH),(0,i.__classPrivateFieldSet)(this,E,0),e}get nextUnusedEventId(){return(0,i.__classPrivateFieldGet)(this,E)}_recordEvent(e){const t=e.eventId,s=t%n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH;if(t===_.EventRecordEntry.EVENT_ID_REJECT)throw new TypeError("Do not try to record events for rejected requests.");if(t<0||t!==Math.trunc(t))throw new RangeError("Event ID's must only be assigned positive, integer values.");if(this.eventRecordBitmap[s])throw new Error("Event ID's must be assigned unique values.");this.eventRecordBitmap[s]=!0,this.eventRecordBitmap[(t+n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH-n.Game.K.EVENT_RECORD_FORWARD_WINDOW_LENGTH)%n.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH]=!1,(0,i.__classPrivateFieldSet)(this,E,+(0,i.__classPrivateFieldGet)(this,E)+1)}executeTileModEvent(e,t=!0){Object.freeze(e);const s=this.grid.tile.at(e.coord);if(s.lastKnownUpdateId>e.lastKnownUpdateId)return s;if(s.lastKnownUpdateId===e.lastKnownUpdateId)throw new RangeError("never");return e.newCharSeqPair&&(s.setLangCharSeqPair(e.newCharSeqPair),t&&this.operators.filter((e=>e.tile.destsFrom().get.includes(s))).forEach((e=>e.seqBufferAcceptKey("")))),s.lastKnownUpdateId=e.lastKnownUpdateId,s.freeHealth=e.newFreeHealth,s}executePlayerMoveEvent(e){var t;const s=this.players[e.playerId],r=e.playerLastAcceptedRequestId-s.lastAcceptedRequestId;if(e.eventId===_.EventRecordEntry.EVENT_ID_REJECT)return void(0===r&&(s.requestInFlight=!1));this._recordEvent(e);const i=this.executeTileModEvent(e.destModDesc,s!==this.currentOperator);if(null===(t=e.tileHealthModDescs)||void 0===t||t.forEach((e=>{this.executeTileModEvent(e)})),r>1){if(s===this.currentOperator)throw new Error("never")}else{if(s.requestInFlight=!1,!(s===this.currentOperator?1===r:r<=1))throw new RangeError("never");s.status.health=e.newPlayerHealth.health,s.moveTo(i),s.lastAcceptedRequestId=e.playerLastAcceptedRequestId}}executePlayerBubbleEvent(e){this.players[e.playerId].requestInFlight=!1,e.eventId!==_.EventRecordEntry.EVENT_ID_REJECT&&this._recordEvent(e)}}E=new WeakMap,Object.freeze(v),Object.freeze(v.prototype);var O,y=s(985);!function(e){let t,s,r,i,a,o;e.GLOBAL_IDS={PUBLIC_GAME_HOST_URLS:"public-game-hosts-list",CURRENT_HOST_GROUPS:"current-host-groups-list"},function(e){e.Class={TEXT_SELECT_DISABLED:"text-select-disabled",FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents",INPUT_GROUP:"sk-input-group",INPUT_GROUP_ITEM:"sk-input-group-item"},e.Dataset={COLOUR_SCHEME:"skColourScheme"}}(t=e.General||(e.General={})),function(e){e.Class={BASE:"tile",POINTER_HB:"tile__pointer-hitbox",LANG_CHAR_WRAP:"tile__char",LANG_SEQ:"tile__seq"},e.Dataset={HEALTH:"health"}}(s=e.Tile||(e.Tile={})),function(e){e.Class={GRID:"game-grid",SCROLL_OUTER:"game-grid-scroll-outer",SCROLL_INNER:"game-grid-scroll-inner",IMPL_BODY:"game-grid-impl-body",KBD_DC:"game-grid-kbd-dc",KBD_DC_ICON:"game-grid-kbd-dc__icon",PAUSE_OL:"game-grid-pause-overlay",PAUSE_OL_ICON:"game-grid-pause-overlay__icon",PLAYER_IOB_ROOT:"grid-player-intersection-root"},e.Dataset={IMPL_COORD_SYS:"coordSys",GAME_STATE:{KEY:"gameState",VALUES:{PLAYING:"playing",PAUSED:"paused",OVER:"over"}}}}(r=e.Grid||(e.Grid={})),function(e){e.Class={BASE:"player",FACE:"player__face",DOWNED_OVERLAY:"player__downed-overlay",SHORT_SPOTLIGHT:"player__spotlight-short",LONG_SPOTLIGHT:"player__spotlight-long"},e.Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"}}(i=e.Player||(e.Player={})),function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"sk-screen",NAV_NEXT:"screen--next-button",NAV_PREV:"screen--prev-button"},e.Dataset={CURRENT:"current"},function(e){let t,s,r,i,a,o;!function(e){e.Class={BASE:"screen-home",NAV:"screen-home--nav",NAV_PLAY_OFFLINE:"screen-home--nav--play-offline",NAV_PLAY_ONLINE:"screen-home--nav--play-online",NAV_HOW_TO_PLAY:"screen-home--nav--how-to-play",NAV_HOW_TO_HOST:"screen-home--nav--how-to-host",NAV_COLOURS:"screen-home--nav--colour-scheme",NAV_VIEW_REPO:"screen-home--nav--goto-repo",NAV_RPT_ISSUE:"screen-home--nav--report-issue"}}(t=e.Home||(e.Home={})),function(e){e.Class={BASE:"screen-colour",OPTION:"screen-colour--opt",OPTION_LABEL:"screen-colour--opt-label",OPTION_LABEL_TITLE:"screen-colour--opt-label--title",OPTION_LABEL_AUTHOR:"screen-colour--opt-label--author"}}(s=e.ColourCtrl||(e.ColourCtrl={})),function(e){e.Class={BASE:"screen-play",GRID_WRAPPER:"screen-play--grid-wrapper",CONTROLS_BAR:"screen-play--controls-bar",PLAYERS_BAR:"screen-play--players-bar"}}(r=e.Play||(e.Play={})),function(e){e.Class={BASE:"screen-setup",LANG_SEL:"screen-setup--lang-sel",LANG_WEIGHT_EXAGG:"screen-setup--lang-weight-exagg"},e.Id={LANG_WEIGHT_EXAGGERATION_LIST:"screen-setup--lang-weight-exaggeration-list"}}(i=e.Setup||(e.Setup={})),function(e){e.Class={BASE:"screen-joiner",CONTENT_WRAPPER:"screen-joiner--content-wrapper",HOST_URL:"screen-joiner--host-url",GROUP_NAME:"screen-joiner--group-name",PASSPHRASE:"screen-joiner--passphrase"}}(a=e.GroupJoiner||(e.GroupJoiner={})),function(e){e.Class={BASE:"screen-lobby",SEC_CLIENT_INFO:"screen-lobby--client-info-section",SEC_TEAMS:"screen-lobby--teams-section",TEAM:"screen-lobby--team",PLAYER:"screen-lobby--player",PLAYER_NAME:"screen-lobby--player__name"}}(o=e.GroupLobby||(e.GroupLobby={}))}(t=e.Impl||(e.Impl={}))}(a=e.Screen||(e.Screen={})),function(e){e.Class={BASE:"sk-pick-one",OPT_BASE:"sk-pick-one--opt"}}(o=e.SkPickOne||(e.SkPickOne={}))}(O||(O={})),Object.freeze(O.Player.Dataset.DOWNED),a.JsUtils.deepFreeze(O);var T,b,N,P,S,A,I,C,R=s(789);class w extends R.Tile{constructor(e){super(e),T.set(this,void 0),(0,i.__classPrivateFieldSet)(this,T,a.JsUtils.mkEl("div",[O.General.Class.CENTER_CONTENTS,O.General.Class.STACK_CONTENTS,O.Tile.Class.BASE])).setAttribute("aria-label","Tile");{const e=a.JsUtils.mkEl("div",[O.Tile.Class.POINTER_HB]);e.setAttribute("aria-hidden","true"),(0,i.__classPrivateFieldGet)(this,T).appendChild(e)}{const e=a.JsUtils.mkEl("div",[O.Tile.Class.LANG_CHAR_WRAP]);e.setAttribute("role","presentation");const t=this.langCharElem=a.JsUtils.mkEl("div",[]);e.appendChild(t),(0,i.__classPrivateFieldGet)(this,T).appendChild(e)}{const e=this.langSeqElem=a.JsUtils.mkEl("div",[O.Tile.Class.LANG_SEQ]);e.setAttribute("role","tooltip"),(0,i.__classPrivateFieldGet)(this,T).appendChild(e)}a.JsUtils.propNoWrite(this,["langCharElem","langSeqElem"])}_addToDom(e){e.appendChild((0,i.__classPrivateFieldGet)(this,T))}_setOccupant(e,t){super._setOccupant(e,t),this.langCharElem.parentElement.insertAdjacentElement("beforebegin",t.playerElem),this.langSeqElem.textContent=t.username}evictOccupant(){super.evictOccupant(),this.langSeqElem.textContent=this.langSeq}set freeHealth(e){super.freeHealth=e,this.freeHealth>0?(0,i.__classPrivateFieldGet)(this,T).dataset[O.Tile.Dataset.HEALTH]=this.freeHealth.toString():delete(0,i.__classPrivateFieldGet)(this,T).dataset[O.Tile.Dataset.HEALTH]}get freeHealth(){return super.freeHealth}setLangCharSeqPair(e){super.setLangCharSeqPair(e),this.langCharElem.textContent=this.langChar,this.langSeqElem.textContent=this.langSeq}}T=new WeakMap,a.JsUtils.protoNoEnum(w,["_addToDom"]),Object.freeze(w),Object.freeze(w.prototype),function(e){e.getImplementation=t=>e._Constructors[t]}(b||(b={}));class G{_superVisibleGrid(e,t){if(e.tileClass!==w)throw new TypeError("never");const s=O.Grid;t.setAttribute("role","presentation"),t.classList.add(s.Class.IMPL_BODY),t.dataset[s.Dataset.IMPL_COORD_SYS]=e.coordSys,t.translate=!1,t.spellcheck=!1,this.baseElem=t;const r=a.JsUtils.mkEl("div",[O.Player.Class.SHORT_SPOTLIGHT]),i=a.JsUtils.mkEl("div",[O.Player.Class.LONG_SPOTLIGHT]);this.spotlightElems=Object.freeze([r,i])}}Object.freeze(G),Object.freeze(G.prototype),function(e){class t{constructor(e){this.x=e.x,this.y=e.y,Object.freeze(this)}_equals(e){return this.x===e.x&&this.y===e.y}round(){return new t({x:Math.round(this.x),y:Math.round(this.y)})}oneNorm(e){return this.sub(e).originOneNorm()}originOneNorm(){return Math.abs(this.x)+Math.abs(this.y)}infNorm(e){return this.sub(e).originInfNorm()}originInfNorm(){return Math.max(Math.abs(this.x),Math.abs(this.y))}axialAlignment(e){return this.sub(e).originAxialAlignment()}originAxialAlignment(){return Math.abs(Math.abs(this.x)-Math.abs(this.y))/(Math.abs(this.x)+Math.abs(this.y))}add(e){return new t({x:this.x+e.x,y:this.y+e.y})}sub(e){return new t({x:this.x-e.x,y:this.y-e.y})}mul(e){return new t({x:e*this.x,y:e*this.y})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);class s extends y.Grid{constructor(e){super(e);const s=[];for(let r=0;r<this.dimensions.height;r++){const i=[];for(let s=0;s<this.dimensions.width;s++){const a=new e.tileClass(new t({x:s,y:r}));i.push(a)}s.push(Object.freeze(i))}this.grid=Object.freeze(s)}static getAmbiguityThreshold(){return 24}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e){let t=0;for(const s of this.grid)for(const r of s)e(r,t++)}shuffledForEachTile(e){this.grid.flat().sort(((e,t)=>Math.random()-.5)).forEach((t=>e(t)))}getUntToward(e,t){const s=this.tile.destsFrom(t).unoccupied.get;if(0===s.length)return this.tile.at(t);if(1===s.length)return s[0];s.sort(((t,s)=>t.coord.oneNorm(e)-s.coord.oneNorm(e))).sort(((t,s)=>t.coord.infNorm(e)-s.coord.infNorm(e)));for(let t=1;t<s.length;t++)if(s[t].coord.infNorm(e)>s[0].coord.infNorm(e)){s.splice(t);break}if(1===s.length)return s[0];if(s[0].coord.x-t.x==0||s[0].coord.y-t.y==0){if(t.axialAlignment(t.sub(e))-.5>0)return s[0];s.shift()}return s[Math.floor(s.length*Math.random())]}getUntAwayFrom(e,t){return this.getUntToward(t.add(t.sub(e)),t)}getDestsFromSourcesTo(e){return this._getTileDestsFrom(e,2)}getRandomCoordAround(e,s){return new t({x:e.x+Math.trunc(2*s*(Math.random()-.5)),y:e.y+Math.trunc(2*s*(Math.random()-.5))})}_getTileAt(e){return this.grid[e.y][e.x]}_getTileDestsFrom(e,t=1){let s=e.y-t,r=e.y+t+1,i=e.x-t,a=e.x+t+1;return s>=this.dimensions.height||r<0||i>=this.dimensions.width||a<0?[]:this.grid.slice(Math.max(0,s),Math.min(this.dimensions.height,r)).flatMap((e=>e.slice(Math.max(0,i),Math.min(this.dimensions.width,a))))}_getTileSourcesTo(e,t=1){return this._getTileDestsFrom(e,t)}minMovesFromTo(e,t){return Math.min(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}static getSpawnCoords(e,t){const r=[];return e.map((e=>{const i=[];for(;e>0;){let a;do{a=s.getRandomCoord(t)}while(r.find((e=>a._equals(e))));i.push(a),r.push(a),e--}return i}))}static getArea(e){return e.height*e.width}static getDiameterOfLatticePatchHavingArea(e){return Math.sqrt(e)}static getRandomCoord(e){const s=Math.floor(e.width*Math.random()),r=Math.floor(e.height*Math.random());return new t({x:s,y:r})}}s.SIZE_LIMITS=Object.freeze({height:Object.freeze({min:11,max:51}),width:Object.freeze({min:11,max:51})}),e.Grid=s,a.JsUtils.protoNoEnum(s,["_getTileAt","_getTileDestsFrom","_getTileSourcesTo"]),Object.freeze(s),Object.freeze(s.prototype)}(N||(N={})),Object.freeze(N);class L extends N.Grid{constructor(e){super(e);const t=a.JsUtils.mkEl("div",[]);t.style.setProperty("--euclid2-grid-width",this.dimensions.width.toString());for(const e of this.grid)for(const s of e)s._addToDom(t);this._superVisibleGrid(e,t)}}a.JsUtils.applyMixins(L,[G]),Object.freeze(L),Object.freeze(L.prototype),function(e){class t{constructor(e){this.dash=e.dash,this.bash=e.bash,Object.freeze(this)}_equals(e){return this.dash===e.dash&&this.bash===e.bash}round(){const e=Math.floor(this.dash),s=Math.floor(this.bash),r=e-this.dash,i=s-this.bash;return r>2*i?new t({dash:e+1,bash:s}):r<.5*i?new t({dash:e,bash:s+1}):Math.min(r,i)>.5?new t({dash:e+1,bash:s+1}):new t({dash:e,bash:s})}add(e){return new t({dash:this.dash+e.dash,bash:this.bash+e.bash})}sub(e){return new t({dash:this.dash-e.dash,bash:this.bash-e.bash})}mul(e){return new t({dash:e*this.dash,bash:e*this.bash})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);class s extends y.Grid{constructor(e){super(e),this.grid=Object.freeze(void 0)}static getAmbiguityThreshold(){return 18}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e){let t=0;for(const s of this.grid)for(const r of s)e(r,t++)}shuffledForEachTile(e){this.grid.flat().sort(((e,t)=>Math.random()-.5)).forEach((t=>e(t)))}getUntToward(e,t){}getUntAwayFrom(e,t){return this.getUntToward(t.add(t.sub(e)),t)}getRandomCoordAround(e,t){}_getTileAt(e){}_getTileDestsFrom(e,t=1){}_getTileSourcesTo(e,t=1){}minMovesFromTo(e,t){}getDestsFromSourcesTo(e){return this._getTileDestsFrom(e,2)}static getSpawnCoords(e,t){}static getArea(e){const t=Math.min(e.fslash,e.bslash),s=Math.max(e.fslash,e.bslash),r=-1+e.dash+t;let i=2*t*(e.dash+r);return i+=(s-t-1)*r,i}static getDiameterOfLatticePatchHavingArea(e){if(e<.25)throw new RangeError("determinant of a radical will be strictly negative.");return 1+(-3+Math.sqrt(9-12*(1-e)))/6*2}static getRandomCoord(e){return new t(void 0)}}s.SIZE_LIMITS=Object.freeze({dash:Object.freeze({min:10,max:50}),bslash:Object.freeze({min:10,max:50}),fslash:Object.freeze({min:10,max:50})}),e.Grid=s,a.JsUtils.protoNoEnum(s,["_getTileAt","_getTileDestsFrom","_getTileSourcesTo"]),Object.freeze(s),Object.freeze(s.prototype)}(P||(P={})),Object.freeze(P);class M extends P.Grid{constructor(e){super(e),this._superVisibleGrid(e,void 0)}}a.JsUtils.applyMixins(M,[G]),Object.freeze(M),Object.freeze(M.prototype);class F extends c{constructor(e,t){super(e,t),S.set(this,void 0),this.behaviour=Object.freeze(Object.assign({},F.Behaviour.DEFAULT,t.familyArgs)),this.grid=this.game.grid}_afterAllPlayersConstruction(){super._afterAllPlayersConstruction(),this.threatProximity=this.game.teams.filter((e=>e.id!==this.teamId)).flatMap((e=>e.members)),this.targetProximity=[...this.threatProximity],a.JsUtils.propNoWrite(this,["threatProximity","targetProximity","behaviour","grid"])}reset(e){super.reset(e),(0,i.__classPrivateFieldSet)(this,S,this.coord)}moveTo(e){(0,i.__classPrivateFieldSet)(this,S,this.coord),super.moveTo(e)}computeDesiredDest(){this.threatProximity.sort(((e,t)=>this.grid.minMovesFromTo(e.coord,this.coord)-this.grid.minMovesFromTo(t.coord,this.coord)));for(const e of this.threatProximity){if(this.grid.minMovesFromTo(e.coord,this.coord)>this.behaviour.fearDistance)break;if(!e.status.isDowned&&e.status.health>this.status.health)return this.grid.getUntAwayFrom(e.coord,this.coord).coord}if(this.targetProximity.sort(((e,t)=>this.grid.minMovesFromTo(this.coord,e.coord)-this.grid.minMovesFromTo(this.coord,t.coord))),this.status.isDowned)for(const e of this.targetProximity){if(this.grid.minMovesFromTo(this.coord,e.coord)>this.behaviour.bloodThirstDistance)break;if(e.status.health<this.status.health-this.behaviour.healthReserve)return e.coord}if(0===this.game.freeHealthTiles.size){if(Math.random()<this.behaviour.wanderingAimlessness)return this.grid.getRandomCoordAround(this.coord,3);{const e=this.grid.getUntAwayFrom.bind(this.grid,(0,i.__classPrivateFieldGet)(this,S));return this.grid.getRandomCoordAround(e(e(this.coord).coord).coord,1)}}let e=void 0,t=1/0;for(const s of this.game.freeHealthTiles){const r=this.grid.minMovesFromTo(this.coord,s.coord);r<t&&(e=s,t=r)}return e.coord}getNextMoveType(){return l.Player.MoveType.NORMAL}computeNextMovementTimer(){return 1e3/this.behaviour.keyPressesPerSecond}}S=new WeakMap,function(e){let t;!function(e){e.DEFAULT=Object.freeze({fearDistance:5,bloodThirstDistance:7,healthReserve:3,keyPressesPerSecond:2,wanderingAimlessness:.2})}(t=e.Behaviour||(e.Behaviour={}))}(F||(F={})),a.JsUtils.protoNoEnum(F,["_afterAllPlayersConstruction"]),Object.freeze(F),Object.freeze(F.prototype),(()=>{y.Grid._Constructors=Object.freeze({EUCLID2:N.Grid,BEEHIVE:P.Grid}),Object.freeze(y.Grid),Object.freeze(y.Grid.prototype);{const e=c;e._Constructors=Object.freeze({CHASER:F}),Object.freeze(e),Object.freeze(e.prototype)}})();class j extends v{constructor(e,t,r){super(e,t,r),A.set(this,void 0),I.set(this,void 0),C.set(this,void 0),this.averageFreeHealth=r.averageFreeHealthPerTile*this.grid.area,this.averageFreeHealthPerTile=r.averageFreeHealthPerTile,this.healthCostOfBoost=n.Game.K.HEALTH_COST_OF_BOOST(this.averageFreeHealthPerTile,this.grid.static.getDiameterOfLatticePatchHavingArea),(0,i.__classPrivateFieldSet)(this,I,new Set),this.scoreInfo=new d(this.players.map((e=>e.playerId))),a.JsUtils.propNoWrite(this,["averageFreeHealth","averageFreeHealthPerTile","healthCostOfBoost","scoreInfo"]),(0,i.__classPrivateFieldSet)(this,C,s(59)(`./${this.langFrontend.module}.ts`).then((e=>{const t=this.langFrontend.export.split(".").reduce(((e,t)=>e[t]),e[this.langFrontend.module]);this.lang=new t(r.langWeightExaggeration),a.JsUtils.propNoWrite(this,["lang"]);const s=this.grid.static.getAmbiguityThreshold();if(this.lang.numLeaves<s)throw new Error(`Found ${this.lang.numLeaves} leaves, but at least ${s} were required. The provided mappings composing the current Lang-under-construction are not sufficient to ensure that a shuffling operation will always be able to find a safe candidate to use as a replacement. Please see the spec for Lang.getNonConflictingChar.`);return this.lang})))}reset(){const e=Object.create(null,{reset:{get:()=>super.reset}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield e.reset.call(this),(0,i.__classPrivateFieldSet)(this,A,0),(0,i.__classPrivateFieldGet)(this,I).clear(),yield(0,i.__classPrivateFieldGet)(this,C),this.lang.reset(),this.grid.shuffledForEachTile((e=>{e.setLangCharSeqPair(this.dryRunShuffleLangCharSeqAt(e))})),this.teams.forEach((e=>e.reset()));const t=this.grid.static.getSpawnCoords(this.teams.map((e=>e.members.length)),this.grid.dimensions);return this.teams.forEach(((e,s)=>{e.members.forEach(((e,r)=>{e.reset(this.grid.tile.at(t[s][r]))}))})),this.scoreInfo.reset(),Promise.resolve()}))}_createArtifPlayer(e){return c.of(this,e)}dryRunShuffleLangCharSeqAt(e,t=!1){e.setLangCharSeqPair(o.U.CharSeqPair.NULL);let s=this.grid.getDestsFromSourcesTo(e.coord).map((e=>e.langSeq));if(t){const e=o.U.CharSeqPair.NULL.seq;s=s.filter((t=>t!==e))}return this.lang.getNonConflictingChar(s)}get currentFreeHealth(){return(0,i.__classPrivateFieldGet)(this,A)}get freeHealthTiles(){return(0,i.__classPrivateFieldGet)(this,I)}dryRunSpawnFreeHealth(e){var t;let s=this.averageFreeHealth-this.currentFreeHealth;if(s<=0)return;const i=[];for(;s>0;){let a;do{a=this.grid.tile.at(this.grid.getRandomCoord())}while(a.isOccupied||i.find((e=>r.equals(a.coord,e.coord))));const o=n.Game.K.AVERAGE_HEALTH_TO_SPAWN_ON_TILE;if(Math.random()<n.Game.K.HEALTH_UPDATE_CHANCE){let s;(s=e.find((e=>r.equals(a.coord,e.coord))))?s.newFreeHealth=(null!==(t=s.newFreeHealth)&&void 0!==t?t:0)+o:i.push({coord:a.coord,lastKnownUpdateId:1+a.lastKnownUpdateId,newCharSeqPair:void 0,newFreeHealth:a.freeHealth+o})}s-=o}return i}executeTileModEvent(e,t=!0){Object.freeze(e);const s=this.grid.tile.at(e.coord);if(e.lastKnownUpdateId!==1+s.lastKnownUpdateId)throw new RangeError("never");return(0,i.__classPrivateFieldSet)(this,A,(0,i.__classPrivateFieldGet)(this,A)+(e.newFreeHealth-s.freeHealth)),0===e.newFreeHealth?(0,i.__classPrivateFieldGet)(this,I).delete(s):(0,i.__classPrivateFieldGet)(this,I).add(s),super.executeTileModEvent(e,t),s}managerCheckGamePlayingRequest(e){if(this.status!==n.Game.Status.PLAYING)return;const t=this.players[e.playerId];if(!t)throw new Error("No such player exists.");if(e.playerLastAcceptedRequestId!==t.lastAcceptedRequestId)throw new RangeError(e.playerLastAcceptedRequestId<t.lastAcceptedRequestId?"Clients should not make requests until they have received my response to their last request.":"Client seems to have incremented the request ID counter on their own, which is is illegal.");return t}processMoveRequest(e){const t=this.managerCheckGamePlayingRequest(e);if(!t)return void this.executePlayerMoveEvent(e);const s=this.grid.tile.at(e.destModDesc.coord);if(s.isOccupied||s.lastKnownUpdateId!==e.destModDesc.lastKnownUpdateId)return void this.executePlayerMoveEvent(e);const r=e.moveType===l.Player.MoveType.BOOST,i=t.status.health+s.freeHealth*(t.status.isDowned?n.Game.K.HEALTH_EFFECT_FOR_DOWNED_PLAYER:1)-(r?this.healthCostOfBoost:0);if(r&&i<0)return void this.executePlayerMoveEvent(e);const a=this.scoreInfo.entries[t.playerId];a.totalHealthPickedUp+=s.freeHealth,a.moveCounts[e.moveType]+=1,e.playerLastAcceptedRequestId=1+t.lastAcceptedRequestId,e.newPlayerHealth={health:i},e.destModDesc.lastKnownUpdateId=1+s.lastKnownUpdateId,e.destModDesc.newFreeHealth=0,e.destModDesc.newCharSeqPair=this.dryRunShuffleLangCharSeqAt(s),e.tileHealthModDescs=this.dryRunSpawnFreeHealth([e.destModDesc]),e.eventId=this.nextUnusedEventId,this.executePlayerMoveEvent(e)}processPlayerContact(e){}processBubbleRequest(e){const t=this.managerCheckGamePlayingRequest(e);t?(e.playerLastAcceptedRequestId=1+t.lastAcceptedRequestId,e.eventId=this.nextUnusedEventId,this.executePlayerBubbleEvent(e)):this.executePlayerBubbleEvent(e)}}A=new WeakMap,I=new WeakMap,C=new WeakMap,function(e){e.CHECK_VALID_CTOR_ARGS=function(e){const t=[],s=Object.freeze({coordSys:0,gridDimensions:0,averageFreeHealthPerTile:0,langId:0,langWeightExaggeration:0,playerDescs:0}),r=[];for(const t in s){null==e[t]&&r.push(t)}return r.length&&t.push("Missing the following arguments: "+r),void 0===o.U.GET_FRONTEND_DESC_BY_ID(e.langId)&&t.push(`No language with the ID \`${e.langId}\` exists.`),NaN===parseInt(e.langWeightExaggeration)?t.push(`Language Weight Exaggeration expected a number, but\`${e.langWeightExaggeration}\` is not a number.`):e.langWeightExaggeration=Math.max(0,parseFloat(e.langWeightExaggeration)),t}}(j||(j={})),a.JsUtils.protoNoEnum(j,["managerCheckGamePlayingRequest"]),Object.freeze(j),Object.freeze(j.prototype)},216:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Player:()=>m,PlayerSkeleton:()=>h,PlayerStatus:()=>p});var r,i=s(406),a=s(504),o=s(699),n=s(780),l=s(951),c=s(495);class h extends l.J5{constructor(e,t){if(super(),r.set(this,void 0),Math.trunc(t.playerId)!==t.playerId)throw new RangeError("Player ID's must be integer values.");this.playerId=t.playerId,this.isALocalOperator=t.isALocalOperator,this.game=e,this.status=new this.game._playerStatusCtor(this,t.noCheckGameOver),this.tile=new c.N(new h.TileGetterSource(this)),i.JsUtils.instNoEnum(this,["game"]),i.JsUtils.propNoWrite(this,["playerId","isALocalOperator","game","status","tile"])}_afterAllPlayersConstruction(){this.status._afterAllPlayersConstruction()}reset(e){(0,n.__classPrivateFieldSet)(this,r,e),this.hostTile._setOccupant(this.playerId,this.status.immigrantInfo)}get coord(){return this.hostTile.coord}get hostTile(){return(0,n.__classPrivateFieldGet)(this,r)}moveTo(e){if(this.hostTile.occupantId!==this.playerId){if(this.game.gameType!==a.Game.Type.ONLINE)throw new Error("Linkage between player and occupied tile disagrees.")}else this.hostTile.evictOccupant();if(e.isOccupied){if(this.game.gameType!==a.Game.Type.ONLINE)throw new Error("Only one player can occupy a tile at a time.")}else(0,n.__classPrivateFieldSet)(this,r,e),e._setOccupant(this.playerId,this.status.immigrantInfo)}}r=new WeakMap,function(e){var t,s;class r{constructor(e){t.set(this,void 0),s.set(this,void 0),(0,n.__classPrivateFieldSet)(this,t,e),(0,n.__classPrivateFieldSet)(this,s,e.game.grid.tile._source)}_getTileAt(){return(0,n.__classPrivateFieldGet)(this,s)._getTileAt((0,n.__classPrivateFieldGet)(this,t).coord)}_getTileDestsFrom(){return(0,n.__classPrivateFieldGet)(this,s)._getTileDestsFrom((0,n.__classPrivateFieldGet)(this,t).coord)}_getTileSourcesTo(){return(0,n.__classPrivateFieldGet)(this,s)._getTileSourcesTo((0,n.__classPrivateFieldGet)(this,t).coord)}}t=new WeakMap,s=new WeakMap,e.TileGetterSource=r,Object.freeze(r),Object.freeze(r.prototype)}(h||(h={})),i.JsUtils.protoNoEnum(h,["_afterAllPlayersConstruction"]),Object.freeze(h),Object.freeze(h.prototype);var d,u=s(473);class p{constructor(e,t){d.set(this,void 0),this.player=e,this.noCheckGameOver=t,i.JsUtils.instNoEnum(this,["player"])}reset(){this.health=0}_afterAllPlayersConstruction(){}get immigrantInfo(){}get health(){return(0,n.__classPrivateFieldGet)(this,d)}set health(e){const t=this.isDowned;if((0,n.__classPrivateFieldSet)(this,d,e),t||!this.isDowned||this.noCheckGameOver)return;const s=this.player.team,r=this.player.game.teams;if(s.elimOrder===u.S.ElimOrder.STANDING&&s.members.every((e=>e.status.noCheckGameOver||e.status.isDowned))){const e=1+r.filter((e=>e.elimOrder!==u.S.ElimOrder.STANDING)).length;s.elimOrder=1+r.filter((e=>e.elimOrder!==u.S.ElimOrder.STANDING&&e.elimOrder!==u.S.ElimOrder.IMMORTAL)).length,e===r.length&&this.player.game.statusBecomeOver()}}get isDowned(){return this.health<0}}d=new WeakMap,i.JsUtils.protoNoEnum(p,["_afterAllPlayersConstruction"]),Object.freeze(p),Object.freeze(p.prototype);class m extends h{constructor(e,t){var s;super(e,t),this.familyId=t.familyId,this.teamId=t.teamId,this.username=t.username,this.avatar=null!==(s=t.avatar)&&void 0!==s?s:m.Avatar.GET_RANDOM(),i.JsUtils.propNoWrite(this,["familyId","teamId","username","avatar"])}reset(e){super.reset(e),this.status.reset(),this.lastAcceptedRequestId=o.PlayerActionEvent.INITIAL_REQUEST_ID,this.requestInFlight=!1}_notifyGameNowPlaying(){}_notifyGameNowPaused(){}_notifyGameNowOver(){}makeMovementRequest(e,t){if(this.game.status!==a.Game.Status.PLAYING)throw new Error("This is not a necessary precondition, but we're doing it anyway.");if(this.requestInFlight)throw new Error("Only one request should ever be in flight at a time.");this.requestInFlight=!0,this.game.processMoveRequest(new o.PlayerActionEvent.Movement(this.playerId,this.lastAcceptedRequestId,e,t))}get team(){return this.game.teams[this.teamId]}isTeamedWith(e){return this.team.members.includes(e)}}!function(e){let t;!function(e){e.finalize=function(e){const t=Array.from(new Set(e.map((e=>e.teamId)))).sort(((e,t)=>e-t)).reduce(((e,t,s)=>(e[t]=s,e)),[]);return e.slice().sort(((e,s)=>t[e.teamId]-t[s.teamId])).map(((e,s)=>Object.assign({},e,{playerId:s,teamId:t[e.teamId]})))}}(t=e.CtorArgs||(e.CtorArgs={})),Object.freeze(t)}(m||(m={})),i.JsUtils.protoNoEnum(m,["_notifyGameNowPaused","_notifyGameNowPlaying","_notifyGameNowOver"]),Object.freeze(m),Object.freeze(m.prototype)},473:(e,t,s)=>{"use strict";s.d(t,{S:()=>o});var r,i=s(780),a=s(406);class o{constructor(e,t){if(r.set(this,void 0),0===t.length)throw new Error("Teams must have at least one member.");this.id=e,this.members=t,(0,i.__classPrivateFieldSet)(this,r,this.members.every((e=>e.status.noCheckGameOver))?o.ElimOrder.IMMORTAL:o.ElimOrder.STANDING),a.JsUtils.propNoWrite(this,["id","members"])}reset(){this.elimOrder!==o.ElimOrder.IMMORTAL&&(this.elimOrder=o.ElimOrder.STANDING)}get elimOrder(){return(0,i.__classPrivateFieldGet)(this,r)}set elimOrder(e){if(this.elimOrder===o.ElimOrder.IMMORTAL)throw new TypeError("Cannot change the elimination status of an immortal team.");(0,i.__classPrivateFieldSet)(this,r,e)}}r=new WeakMap,function(e){let t;!function(e){e.IMMORTAL=-1,e.STANDING=0}(t=e.ElimOrder||(e.ElimOrder={}))}(o||(o={})),Object.freeze(o),Object.freeze(o.prototype)},979:(e,t,s)=>{"use strict";s.d(t,{U:()=>l});var r,i=s(406),a=s(951),o=s(780);!function(e){var t,s;class r{constructor(){this.children=[]}reset(){this.inheritingWeightedHitCount=0,this.children.forEach((e=>e.reset()))}_finalize(){Object.freeze(this.children),this.children.forEach((e=>e._finalize()))}_addCharMapping(e,t){if(!a.Uo.Seq.REGEXP.test(e))throw new RangeError(`Mapping-sequence "${e}" did not match the required regular expression "${a.Uo.Seq.REGEXP.source}".`);if(0===t.length)throw new RangeError("never");let s=this;{let t=this;for(;t;)s=t,t=t.children.find((t=>e.startsWith(t.sequence)))}if(s.sequence===e)throw new Error(`Mappings for all written-characters with a commoncorresponding typeable-sequence should be registered together,but an existing mapping for the sequence "${e}" was found.`);s.children.push(new i(s,e,t))}getLeafNodes(){const e=[];return this._recursiveGetLeafNodes(e),e}_recursiveGetLeafNodes(e){this.children.length?this.children.forEach((t=>{t._recursiveGetLeafNodes(e)})):e.push(this)}simpleView(){return this.children}static CREATE_TREE_MAP(e,t){const s=Object.values(e).reduce(((e,t)=>e+t.weight),0),i=0===t?e=>1:1===t?e=>e:e=>Math.pow(e/s,t),a=new Map;for(const t in e){const s=e[t].seq,r=new n(t,i(e[t].weight)),o=a.get(s);o?o.push(r):a.set(s,[r])}const o=new r;return Array.from(a).sort(((e,t)=>e[0].length-t[0].length)).forEach((e=>{o._addCharMapping(...e)})),o._finalize(),o}}r.LEAF_CMP=(e,t)=>e.inheritingWeightedHitCount-t.inheritingWeightedHitCount,e.ParentNode=r,Object.freeze(r),Object.freeze(r.prototype);class i extends r{constructor(e,r,i){super(),t.set(this,void 0),s.set(this,void 0),this.sequence=r,(0,o.__classPrivateFieldSet)(this,s,i),(0,o.__classPrivateFieldSet)(this,t,e)}_finalize(){Object.freeze((0,o.__classPrivateFieldGet)(this,s)),super._finalize()}reset(){super.reset(),(0,o.__classPrivateFieldGet)(this,s).forEach((e=>{e.reset(),this.incrementNumHits(e,Math.random()*a.Uo.CHAR_HIT_COUNT_SEED_CEILING)}))}chooseOnePair(){const e=(0,o.__classPrivateFieldGet)(this,s).slice(0).sort(n.CMP).shift(),t={char:e.char,seq:this.sequence};return this.incrementNumHits(e),t}incrementNumHits(e,t=1){e._incrementNumHits(),this._recursiveIncrementNumHits(e.weightInv*t)}_recursiveIncrementNumHits(e){this.inheritingWeightedHitCount+=e,this.children.forEach((t=>t._recursiveIncrementNumHits(e)))}get personalWeightedHitCount(){return this.inheritingWeightedHitCount-(0,o.__classPrivateFieldGet)(this,t).inheritingWeightedHitCount}andNonRootParents(){const e=[];for(let s=this;s instanceof i;s=(0,o.__classPrivateFieldGet)(s,t))e.push(s);return e}simpleView(){let e=(0,o.__classPrivateFieldGet)(this,s).map((e=>e.simpleView()));return Object.assign(Object.create(null),{seq:this.sequence,chars:1===e.length?e[0]:e,kids:this.children.map((e=>e.simpleView()))})}}t=new WeakMap,s=new WeakMap,i.PATH_CMP=(e,t)=>e.personalWeightedHitCount-t.personalWeightedHitCount,e.ChildNode=i,Object.freeze(i),Object.freeze(i.prototype)}(r||(r={})),Object.freeze(r);class n{constructor(e,t){if(t<=0)throw new RangeError(`All weights must be positive, but we were passed the value "${t}" for the character "${e}".`);this.char=e,this.weightInv=1/t}reset(){this.hitCount=0,this.weightedHitCount=0}_incrementNumHits(){this.hitCount+=1,this.weightedHitCount+=this.weightInv}simpleView(){return Object.assign(Object.create(null),{char:this.char,hits:this.hitCount})}}n.CMP=(e,t)=>e.weightedHitCount-t.weightedHitCount,Object.freeze(n),Object.freeze(n.prototype);class l extends a.Uo{constructor(e,t,s){if(super(),this.frontendDesc=l.GET_FRONTEND_DESC_BY_ID(e),this.treeMap=r.ParentNode.CREATE_TREE_MAP(t,s),this.leafNodes=this.treeMap.getLeafNodes(),i.JsUtils.propNoWrite(this,["frontendDesc","treeMap","leafNodes"]),this.leafNodes.length!==this.frontendDesc.numLeaves)throw new Error(`maintenance required: the frontend constant for the language "${this.frontendDesc.id}" needs to be updated to the correct, computed value, which is \`${this.leafNodes.length}\`.`)}get numLeaves(){return this.leafNodes.length}reset(){this.treeMap.reset()}getNonConflictingChar(e){this.leafNodes.sort(r.ParentNode.LEAF_CMP);let t=void 0;for(const s of this.leafNodes){const r=s.andNonRootParents();for(let t=0;t<r.length;t++){const s=e.find((e=>e.startsWith(r[t].sequence)));if(s){s===r[t].sequence?r.length=0:r.splice(t);break}}if(r.length){t=r[0];for(const e of r)e.personalWeightedHitCount<t.personalWeightedHitCount&&(t=e);break}}if(void 0===t)throw new Error("Invariants guaranteeing that a LangSeq canalways be shuffled-in were not met.");return t.chooseOnePair()}simpleView(){return Object.assign(Object.create(null),{id:this.frontendDesc.id,displayName:this.frontendDesc.displayName,root:this.treeMap.simpleView(),numLeaves:this.leafNodes.length})}}l||(l={}),Object.freeze(l),Object.freeze(l.prototype)},410:(e,t,s)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Group=t.ServerGame=void 0;const i=s(780),a=s(406),o=s(502),n=s(290);Object.defineProperty(t,"ServerGame",{enumerable:!0,get:function(){return n.ServerGame}});const l=s(502),c=s(604);class h extends l.Group{constructor(e){super(),r.set(this,void 0),this.namespace=e.namespace,this.name=e.name,this.passphrase=e.passphrase,i.__classPrivateFieldSet(this,r,void 0),this._deleteExternalRefs=e.deleteExternalRefs,this._initialTtlTimeout=setTimeout((()=>{0===Object.keys(this.namespace.sockets).length&&this.terminate()}),1e3*e.initialTtl).unref(),this.socketListeners=Object.freeze({disconnect:e=>{if(e===this._sessionHost)return void this.terminate();if(1===Object.keys(e.nsp.sockets).length)return void this.terminate();const t={[e.id]:void 0};e.nsp.emit(h.Socket.UserInfoChange.EVENT_NAME,t)},[h.Socket.UserInfoChange.EVENT_NAME]:(e,t)=>{if("string"!=typeof t.username||"number"!=typeof t.teamId||"string"!=typeof t.avatar)return void console.log(`bad format: username: \`${t.username}\`, teamId: \`${t.teamId}\`, avatar: \`${t.avatar}\`.`);e.userInfo=t;const s={[e.id]:t};e.nsp.emit(h.Socket.UserInfoChange.EVENT_NAME,s)}}),a.JsUtils.instNoEnum(this,["socketListeners"]),a.JsUtils.propNoWrite(this,["socketListeners"]),this.namespace.use(((e,t)=>{e.handshake.query.passphrase!==this.passphrase&&t(new Error("Incorrect passphrase"));const s=e.handshake.query;return void 0!==s&&0===s.teamId||t(new Error(`a socket attempted to connect to group \`${this.name}\` without providing userInfo.`)),t()})).on("connection",this.onConnection.bind(this))}onConnection(e){console.log("socket    connect: "+e.id),i.__classPrivateFieldGet(this,r)&&e.disconnect(),e.userInfo=e.handshake.query.userInfo;{const t=h.Socket.UserInfoChange.EVENT_NAME;e.nsp.emit(t,{[e.id]:e.userInfo}),e.emit(t,Object.entries(this.sockets).reduce(((e,[t,s])=>(e[t]=s.userInfo,e)),{}))}1===Object.keys(e.nsp.connected).length&&(clearTimeout(this._initialTtlTimeout),this._initialTtlTimeout=void 0,this._sessionHost=e,this.namespace.server.of(l.SkServer.Nsps.GROUP_JOINER).emit(h.Exist.EVENT_NAME,{[this.name]:h.Exist.Status.IN_LOBBY}),e.on(o.GroupEv.CREATE_GAME,this._socketOnHostCreateGame.bind(this))),Object.entries(this.socketListeners).forEach((([t,s])=>{e.on(t,s.bind(this,e))}))}_socketOnHostCreateGame(e){this._createGameInstance(e).length||(this.namespace.server.of(l.SkServer.Nsps.GROUP_JOINER).emit(h.Exist.EVENT_NAME,{[this.name]:h.Exist.Status.IN_GAME}),console.log(`group ${this.name} new game`))}get isCurrentlyPlayingAGame(){return void 0!==i.__classPrivateFieldGet(this,r)}terminate(){function e(e){e.removeAllListeners("connect"),e.removeAllListeners("connection"),Object.values(e.connected).forEach((e=>{e.disconnect(!1),e.removeAllListeners()})),e.removeAllListeners(),delete e.server.nsps[e.name]}void 0!==i.__classPrivateFieldGet(this,r)&&(e(i.__classPrivateFieldGet(this,r).namespace),i.__classPrivateFieldSet(this,r,void 0));const t=this.namespace.server;e(this.namespace),this.namespace=void 0,this._deleteExternalRefs(),t.of(l.SkServer.Nsps.GROUP_JOINER).emit(h.Exist.EVENT_NAME,{[this.name]:h.Exist.Status.DELETE}),console.log(`terminated group: \`${this.name}\``)}_createGameInstance(e){const t=[];return this.isCurrentlyPlayingAGame?(t.push("a game is already in session for this group"),t):(t.push(...c.GamepartManager.CHECK_VALID_CTOR_ARGS(e)),t.length?(console.log(t),t):(e.playerDescs=[...e.playerDescs,...Object.values(this.sockets).map((e=>Object.freeze({isALocalOperator:!1,familyId:"HUMAN",teamId:e.userInfo.teamId,clientId:e.client.id,username:e.userInfo.username,avatar:e.userInfo.avatar,noCheckGameOver:!1,familyArgs:{}})))],i.__classPrivateFieldSet(this,r,new n.ServerGame({groupNsps:this.namespace,passphrase:this.passphrase,groupHostClient:this._sessionHost.client,deleteExternalRefs:()=>{i.__classPrivateFieldSet(this,r,void 0)},gameDesc:e})),[]))}get sockets(){return this.namespace.sockets}}t.Group=h,r=new WeakMap,a.JsUtils.protoNoEnum(h,["_socketOnHostCreateGame"]),Object.freeze(h),Object.freeze(h.prototype)},290:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerGame=void 0;const r=s(213),i=s(406),a=s(502),o=s(504),n=s(789),l=s(985),c=s(216),h=s(671),d=s(699),u=s(604);class p extends u.GamepartManager{constructor(e){super(o.Game.Type.SERVER,{onGameBecomeOver:()=>{},tileClass:n.Tile,playerStatusCtor:c.PlayerStatus},e.gameDesc),this._groupHostClient=e.groupHostClient,this._deleteExternalRefs=e.deleteExternalRefs,i.JsUtils.instNoEnum(this,["operators","_deleteExternalRefs"]),i.JsUtils.propNoWrite(this,["_groupHostClient","_deleteExternalRefs"]),this.namespace=e.groupNsps.server.of(a.SkServer.Nsps.GROUP_GAME_PREFIX+e.groupNsps.name.replace(a.SkServer.Nsps.GROUP_LOBBY_PREFIX,"")).use(((t,s)=>(t.handshake.query.passphrase!==e.passphrase&&s(new Error("Incorrect passphrase")),s()))),this.socketListeners=Object.freeze({[d.PlayerActionEvent.EVENT_NAME.MOVEMENT]:this.processMoveRequest.bind(this),[d.PlayerActionEvent.EVENT_NAME.BUBBLE]:this.processBubbleRequest.bind(this)}),i.JsUtils.instNoEnum(this,["socketListeners"]),i.JsUtils.propNoWrite(this,["socketListeners"]);const t=new Map;function s(e){t.get(e.client)(),t.delete(e.client)}Promise.all(Object.values(e.groupNsps.sockets).map((e=>new Promise(((r,i)=>{t.set(e.client,r),this.namespace.once("connect",s)}))))).then((()=>this._greetGameSockets(e.groupNsps,e.gameDesc))).catch((e=>{setImmediate((()=>{throw e}))})),e.groupNsps.emit(a.GroupEv.CREATE_GAME)}_getGridImplementation(e){return l.Grid.getImplementation(e)}_greetGameSockets(e,t){this.playerSockets=t.playerDescs.filter((e=>e.familyId===c.Player.Family.HUMAN)).reduce(((e,t)=>{if(void 0===t.clientId)throw console.log(t),new Error("missing socket client for player "+t.playerId);const s=Object.values(this.namespace.sockets).find((e=>e.client.id===t.clientId));if(void 0===s)throw new Error("never");return e.set(t.playerId,s),e}),new Map),i.JsUtils.propNoWrite(this,["playerSockets"]),Promise.all(Object.values(this.namespace.sockets).map((e=>new Promise(((t,s)=>{e.once(a.GameEv.RESET,(()=>{t()}))}))))).then((()=>{this.reset()})),Object.values(this.namespace.sockets).forEach((e=>{e.on("disconnect",(()=>{1!==Object.keys(e.nsp.sockets).length||this.terminate()})),e.on(a.GameEv.RETURN_TO_LOBBY,(()=>{e.client===this._groupHostClient?(this.statusBecomeOver(),e.broadcast.emit(a.GameEv.RETURN_TO_LOBBY)):e.broadcast.emit(a.GameEv.RETURN_TO_LOBBY,e.id)})),Object.entries(this.socketListeners).forEach((([t,s])=>{e.on(t,s)})),t.playerDescs.forEach((t=>{t.isALocalOperator=t.clientId===e.client.id})),e.emit(a.GameEv.CREATE_GAME,t)}))}async reset(){console.log("starting reset"),Promise.all(Object.values(this.namespace.sockets).map((e=>new Promise(((t,s)=>{e.once(a.GameEv.UNPAUSE,(()=>{t()}))}))))).then((()=>{this.statusBecomePlaying(),this.namespace.emit(a.GameEv.UNPAUSE)}));const e=super.reset();return await e,this.namespace.emit(a.GameEv.RESET,this.serializeResetState()),e}_createOperatorPlayer(e){throw new TypeError("This should never be called for a ServerGame.")}setCurrentOperator(e){}setTimeout(e,t,...s){return r.setTimeout(e,t,s).unref()}cancelTimeout(e){clearTimeout(e)}executePlayerMoveEvent(e){super.executePlayerMoveEvent(e),e.eventId===h.EventRecordEntry.EVENT_ID_REJECT?this.playerSockets.get(e.playerId).emit(d.PlayerActionEvent.EVENT_NAME.MOVEMENT,e):this.namespace.emit(d.PlayerActionEvent.EVENT_NAME.MOVEMENT,e)}executePlayerBubbleEvent(e){super.executePlayerBubbleEvent(e),e.eventId===h.EventRecordEntry.EVENT_ID_REJECT?this.playerSockets.get(e.playerId).emit(d.PlayerActionEvent.EVENT_NAME.BUBBLE,e):this.namespace.emit(d.PlayerActionEvent.EVENT_NAME.BUBBLE,e)}terminate(){Object.values(this.namespace.sockets).forEach((e=>{e.disconnect(),e.removeAllListeners()})),this.namespace.removeAllListeners(),this._deleteExternalRefs()}}t.ServerGame=p,i.JsUtils.protoNoEnum(p,["_greetGameSockets","_getGridImplementation","_createOperatorPlayer","setCurrentOperator"]),Object.freeze(p),Object.freeze(p.prototype)},904:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnakeyServer=void 0;const r=s(87),i=s(622),a=s(605),o=s(127),n=s(395),l=s(406),c=s(410),h=s(502);class d extends h.SkServer{constructor(e=d.DEFAULT_PORT,t){super(),this.app=o(),this.http=a.createServer({},this.app),this.io=n(this.http,{origins:"*:*",cookie:!1}),this.allGroups=new Map,l.JsUtils.propNoWrite(this,["http","app","io","allGroups"]);const s=i.resolve(__dirname,"../client");this.app.disable("x-powered-by"),this.app.get("/",((e,t)=>{t.sendFile(i.resolve(__dirname,i.resolve(s,"index.html")))})),this.app.use("/",o.static(s)),this.http.listen({port:e,host:t},(()=>{const t=this.http.address();console.log(`\n\nServer mounted to: \`${t.address}${t.port}\` using ${t.family}.\n`),console.log("This host can be reached at any of the following addresses:\n"),d.chooseIPAddress().sort().forEach((t=>{console.log(`${t}:${e}`)})),console.log("")})),this._joinerSocketListeners=Object.freeze({[c.Group.Exist.EVENT_NAME]:(e,t)=>{!t.groupName||this.allGroups.has(t.groupName)||t.groupName.length>c.Group.Name.MaxLength||!t.groupName.match(c.Group.Name.REGEXP)||t.passphrase.length>c.Group.Passphrase.MaxLength||!t.passphrase.match(c.Group.Passphrase.REGEXP)?e.emit(c.Group.Exist.EVENT_NAME,c.Group.Exist.RequestCreate.Response.NOPE):(this.allGroups.set(t.groupName,new c.Group(Object.freeze({namespace:this.io.of(d.Nsps.GROUP_LOBBY_PREFIX+t.groupName),name:t.groupName,passphrase:t.passphrase,deleteExternalRefs:()=>this.allGroups.delete(t.groupName),initialTtl:c.Group.DEFAULT_TTL}))),e.emit(c.Group.Exist.EVENT_NAME,c.Group.Exist.RequestCreate.Response.OKAY))}}),l.JsUtils.instNoEnum(this,["_joinerSocketListeners"]),l.JsUtils.propNoWrite(this,["_joinerSocketListeners"]),this.io.of(d.Nsps.GROUP_JOINER).on("connection",this.onJoinerNspsConnection.bind(this))}onJoinerNspsConnection(e){console.log("socket    connect: "+e.id),e.emit(c.Group.Exist.EVENT_NAME,(()=>{const e={};return Array.from(this.allGroups).forEach((([t,s])=>{e[t]=s.isCurrentlyPlayingAGame?c.Group.Exist.Status.IN_GAME:c.Group.Exist.Status.IN_LOBBY})),e})()),Object.entries(this._joinerSocketListeners).forEach((([t,s])=>{e.on(t,s.bind(this,e))}))}}t.SnakeyServer=d,function(e){e.chooseIPAddress=()=>Object.values(r.networkInterfaces()).flat().filter((e=>!e.internal)).map((e=>"IPv6"===e.family?`[${e.address}]`:e.address))}(d=t.SnakeyServer||(t.SnakeyServer={})),Object.freeze(d),Object.freeze(d.prototype)},687:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.server=void 0;const r=s(904);t.server=new r.SnakeyServer},59:(e,t,s)=>{var r={"./Emote.ts":[981,858],"./English.ts":[215,184],"./Japanese.ts":[117,410],"./Korean.ts":[181,227],"./Morse.ts":[222,285]};function i(e){if(!s.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return s.e(t[1]).then((()=>s(i)))}i.keys=()=>Object.keys(r),i.id=59,e.exports=i},127:e=>{"use strict";e.exports=require("express")},605:e=>{"use strict";e.exports=require("http")},87:e=>{"use strict";e.exports=require("os")},622:e=>{"use strict";e.exports=require("path")},395:e=>{"use strict";e.exports=require("socket.io")},213:e=>{"use strict";e.exports=require("timers")},780:e=>{"use strict";e.exports=require("tslib")}},s={};function r(e){if(s[e])return s[e].exports;var i=s[e]={exports:{}};return t[e](i,i.exports,r),i.exports}return r.m=t,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,s)=>(r.f[s](e,t),t)),[])),r.u=e=>"chunk/"+{184:"lang/English-ts",227:"lang/Korean-ts",285:"lang/Morse-ts",410:"lang/Japanese-ts",858:"lang/Emote-ts"}[e]+".js",r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e={826:1},r.f.require=function(t,s){e[t]||(t=>{var s=t.modules,i=t.ids,a=t.runtime;for(var o in s)r.o(s,o)&&(r.m[o]=s[o]);a&&a(r);for(var n=0;n<i.length;n++)e[i[n]]=1})(require("./"+r.u(t)))},r(687)})();
//# sourceMappingURL=index.js.map