var capswalk;(self.webpackChunkcapswalk=self.webpackChunkcapswalk||[]).push([[826],{990:(e,t,s)=>{"use strict";s.d(t,{R:()=>n});const a=Object.freeze({enumerable:!1}),r=Object.freeze({writable:!1});function i(e){e.repeat&&e.preventDefault()}var n;!function(e){function t(e){for(const s of Object.getOwnPropertyNames(e)){const a=e[s];null!==a&&"object"==typeof a&&t(a)}Object.freeze(e)}function s(e,t,...s){for(const a of s)Object.defineProperty(t,a,e)}let n;var o;e.deepFreeze=function(e){return t(e),e},e.hasProp=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.protoNoEnum=function(e,...t){Object.getOwnPropertyNames(e.prototype).freeze(),t.forEach((t=>{Object.defineProperty(e.prototype,t,a)}))},e.instNoEnum=s.bind(null,a),e.propNoWrite=s.bind(null,r),e.camelCaseTransforms=function(e){const t=e.replace(/[A-Z]/g,(e=>" "+e.toLowerCase()));return Object.freeze({spaceyLowercase:t,spaceyUppercase:t.toUpperCase(),spaceyCapitalized:t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ")})},(o=n=e.Web||(e.Web={})).prependComment=function(e,t){e.parentNode.insertBefore(document.createComment(" "+t+" "),e)},o.adoptStyleSheet=function(t,s){t.appendChild(e.html("link",[],{rel:"stylesheet",href:s}))},o._makeSmartStorage=function(e,t,s){const a={};return Object.keys(s).forEach((e=>{const r=""+e,i=s[e];Object.defineProperty(a,e,{enumerable:!0,get:()=>{const e=t.getItem(r);return null===e?i:JSON.parse(e)},set:e=>{t.setItem(r,JSON.stringify(e))}})})),a},e.html=function(e,t,s){const a=document.createElement(e);try{Object.seal(a)}catch(e){}return(null==t?void 0:t.length)&&a.classList.add(...t),"button"===e?(a.type="button",a.addEventListener("keydown",i,{capture:!0})):"a"===e&&(a.draggable=!1,a.rel="noopener"),void 0!==s&&Object.assign(a,s),a},e.svg=function(e,t,s){const a=document.createElementNS("http://www.w3.org/2000/svg",e);return Object.seal(a),(null==t?void 0:t.length)&&a.classList.add(...t),void 0!==s&&Object.assign(a,s),a}}(n||(n={})),Object.freeze(n)},969:(e,t,s)=>{"use strict";s.d(t,{ZA:()=>a,oU:()=>r,m4:()=>i,JD:()=>n}),new WeakMap;class a{}var r,i,n,o;!function(e){let t;var s;let a;var r;(s=t=e.Name||(e.Name={})).REGEXP=/^(?:[a-zA-Z0-9:-]+)$/,s.MaxLength=30,(r=a=e.Passphrase||(e.Passphrase={})).REGEXP=/^(?:[a-zA-Z0-9:-]*)$/,r.MaxLength=30,e.GameServerReconnectionAttempts=2,e.DEFAULT_TTL=20}(a||(a={})),Object.freeze(a),Object.freeze(a.prototype),function(e){let t,s,a;(t=e.Create||(e.Create={})).NAME="joiner/create",function(e){let t;var s;e.NAME="joiner/exist",(s=t=e.Status||(e.Status={})).IN_LOBBY="in-lobby",s.IN_GAME="in-game",s.DELETE="delete"}(s=e.Exist||(e.Exist={})),(a=e.TryJoin||(e.TryJoin={})).NAME="joiner/try-join"}(r||(r={})),Object.freeze(r),function(e){let t;(t=e.UserInfo||(e.UserInfo={})).NAME="group/user-info-change",e.CREATE_GAME="group/create-game"}(i||(i={})),Object.freeze(i),(o=n||(n={})).RESET="game/reset",o.UNPAUSE="game/unpause",o.PAUSE="game/pause",o.IN_GAME="game/ingame",o.RETURN_TO_LOBBY="game/return-to-lobby"},635:(e,t,s)=>{"use strict";s.d(t,{Uo:()=>i,J5:()=>r});const a=JSON.parse('["üéà","üéê","üèÆ","üóø","‚ö±","üõí","üéâ","üßµ","üß∂","üéÉ","üéÑ","üéé","üéè","üßß","üéÄ","üéÅ","üé†","üé™","üé≠","üé´","üëë","üëí","üé©","üéì","üëì","üï∂","ü§ø","üíÑ","üíé","üëî","üëñ","üß§","üß¶","üëó","üëò","üëö","üëú","üéí","üß∞","üíº","ü•æ","üë†","üë¢","ü©∞","‚öΩ","‚öæ","üèÄ","üèê","üèà","üé±","üé≥","ü•å","üèì","üéØ","ü™Ä","üèÜ","üéÆ","üé≤","üì¢","üîî","üéµ","üéß","üìª","üìØ","ü•Å","üé∑","üé∫","üé∏","ü™ï","üéª","üé•","üì∑","üé¨","üì∫","üìº","‚òé","üì±","üìü","üíª","üíæ","üî¨","üî≠","‚öô","üß≤","üîç","üí°","ü©∫","ü©π","‚úí","‚úè","üìú","üìã","üîñ","üí∏","üí≥","üì®","üì¶","üì¨","üìÆ","‚è≥","‚è∞","üìÖ","üìÜ","üìà","üìâ","üìå","üìê","‚úÇ","üóë","‚ôü","‚ô†","‚ô£","‚ô•","üîì","üîë","‚öî","üî´","üíÄ","üôà","üôâ","üôä","üê∂","üê∫","üê±","ü¶Å","üêØ","ü¶í","ü¶ä","ü¶ù","üêÆ","üê∑","üêó","üê≠","üêπ","üê∞","üêª","üê®","üêº","üê∏","ü¶ì","üê¥","ü¶Ñ","üêî","üê≤","üêÑ","üê™","üê´","ü¶•","ü¶®","üêò","üêÅ","üêÄ","ü¶î","üêá","üêø","ü¶é","üêä","üê¢","üêç","ü¶ï","ü¶à","üê¨","üê≥","üêã","üêü","üê†","ü¶ê","ü¶ë","üêô","ü¶û","ü¶Ä","üêö","ü¶Ü","üêì","ü¶É","ü¶Ö","üïä","ü¶¢","ü¶ú","ü¶©","ü¶ö","ü¶â","üê¶","üêß","üê£","ü¶ã","üêå","üêõ","üêú","üêù","üêû","üï∑","üï∏","üëÅ","ü¶∑","üëÑ","üß†","üíÉ","üï∫","ü§∏‚Äç‚ôÄÔ∏è","üëÉ","ü§è","‚úå","ü§û","üññ","ü§ò","üëç","üëè","üôå","üôè","üçû","üßÇ","ü•ê","ü•®","üßÄ","ü•ó","ü•™","üåÆ","ü•°","üçô","üçö","üçú","üç£","üç§","üç•","üç¶","üç∞","üç¨","üç°","üçÆ","üßÉ","‚òï","üßä","üè∫","üçë","üçì","üçé","üçä","ü•≠","üçç","üçã","üçà","üçê","üçè","üçí","üçÖ","üçå","üçâ","ü•ù","üåΩ","ü•ë","ü•¨","üßÑ","üßÖ","ü•ï","üå∂","üå∞","üçÑ","üå∏","üèµ","üå∫","üåª","üåº","üå∑","üå±","üå≤","üéç","üåµ","‚òò","üçÄ","üçÅ","üçÇ","üöó","üöí","üõπ","üöã","üö†","üöÇ","üöÄ","üõ∞","‚öì","üö©","üó∫","üß≠","‚õ∞","üåã","üóª","üóΩ","üõé","ü™ë","üöΩ","üßª","üõÅ","üßØ","‚òÅ","‚õà","üå§","üå¶","üåß","üå©","‚òÄ","‚≠ê","üåà","‚òÇ","‚õ±","‚ö°","‚ùÑ","‚õÑ","üî•","üåä"]');Object.freeze({behavior:"smooth",block:"center",inline:"center"});class r{}!function(e){let t,s;var r;let i;var n;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,(t=e.Id||(e.Id={})).NULL=-1,(r=s=e.Username||(e.Username={})).REGEXP=/[ a-zA-Z0-9:-]+/,r.MAX_LENGTH=15,(n=i=e.Avatar||(e.Avatar={})).Values=a.map((e=>e+"Ô∏è")).freeze(),n.GET_RANDOM=function(){return n.Values[Math.floor(Math.random()*n.Values.length)]}}(r||(r={})),Object.freeze(r);class i{}!function(e){let t,s;(t=e.Seq||(e.Seq={})).REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$"),(s=e.WeightExaggeration||(e.WeightExaggeration={})).MAX=4,e.CHAR_HIT_COUNT_SEED_CEILING=5}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype)},816:(e,t,s)=>{"use strict";var a;s.d(t,{l:()=>a}),function(e){let t;var s;(s=t=e.Status||(e.Status={})).PLAYING="PLAYING",s.PAUSED="PAUSED",s.OVER="OVER",Object.freeze(t),e.K=Object.freeze({PORTION_OF_MOVES_THAT_ARE_BOOST:.4,_REQUEST_BUFFER_LENGTH:5,_ROBOT_PRIORITY_MAX_REUSES:4})}(a||(a={})),Object.freeze(a)},30:(e,t,s)=>{"use strict";s.d(t,{J:()=>y});var a,r=s(990),i=s(816),n=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},o=(e,t,s,a)=>(n(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);class l{constructor(){a.set(this,0),this.size=0}get lastRejectId(){return n(this,e=a,"read from private field"),e.get(this);var e}reset(e){o(this,a,0),this.size=0,this.predictedCoord=e}get isFull(){return this.size===i.l.K._REQUEST_BUFFER_LENGTH}signRequest(e){return this.size++,this.predictedCoord=e.moveDest,e}getNextRejectId(){return(this.lastRejectId+Math.floor(99*Math.random()))%100}reject(e,t){o(this,a,e),this.size=0,this.predictedCoord=t}acceptOldest(){this.size--}}a=new WeakMap,Object.freeze(l),Object.freeze(l.prototype);var c,d,h=s(635),p=s(97),u=Object.defineProperty,m=Object.prototype.hasOwnProperty,v=Object.getOwnPropertySymbols,E=Object.prototype.propertyIsEnumerable,b=(e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,O=(e,t)=>{for(var s in t||(t={}))m.call(t,s)&&b(e,s,t[s]);if(v)for(var s of v(t))E.call(t,s)&&b(e,s,t[s]);return e},f=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},g=(e,t,s)=>(f(e,t,"read from private field"),s?s.call(e):t.get(e)),_=(e,t,s,a)=>(f(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);const S=class extends h.J5{constructor(e,t){super(),c.set(this,void 0),d.set(this,0),this.prevCoord=void 0,this.playerId=t.playerId,this.familyId=t.familyId,this.teamId=t.teamId,this.username=t.username,this.avatar=t.avatar,this.game=e,this.reqBuffer=new l,r.R.instNoEnum(this,"game"),r.R.propNoWrite(this,"game","playerId","familyId","teamId","username","avatar","reqBuffer"),new.target===S&&Object.seal(this)}get team(){return this.game.teams[this.teamId]}get coord(){return g(this,c)}get boosts(){return g(this,d)}get isDowned(){return this.boosts<0}isTeamedWith(e){return this.team.members.includes(e)}_onTeamsBootstrapped(){}reset(e){_(this,c,e),this.prevCoord=e,this.game.grid.moveEntity(this.playerId,e,e),_(this,d,0),this.reqBuffer.reset(e)}onGamePlaying(){}onGamePaused(){}onGameOver(){}makeMovementRequest(e,t){this.reqBuffer.isFull||this.game.requestStateChange(this.reqBuffer.signRequest({author:this.playerId,lastRejectId:this.reqBuffer.lastRejectId,moveType:t,moveDest:e}))}_setCoord(e){this.prevCoord=this.coord,_(this,c,e)}set boosts(e){const t=this.isDowned;if(_(this,d,e),t||!this.isDowned)return;const s=this.team,a=this.game.teams;if(s.elimOrder===p.S.ElimOrder.STANDING&&s.members.every((e=>e.isDowned))){const e=1+a.filter((e=>e.elimOrder!==p.S.ElimOrder.STANDING)).length;s.elimOrder=1+a.filter((e=>e.elimOrder!==p.S.ElimOrder.STANDING)).length,e===a.length&&this.game.statusBecomeOver()}}};let y=S;c=new WeakMap,d=new WeakMap,function(e){let t;e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType,(t=e.CtorArgs||(e.CtorArgs={})).finalize=function(t){const s=Array.from(new Set(t.players.map((e=>e.teamId)))).seal().sort(((e,t)=>e-t)).freeze().reduce(((e,t,s)=>(e[t]=s,e)),[]);t.players=t.players.slice().seal().sort(((e,t)=>s[e.teamId]-s[t.teamId])).freeze().map(((t,a)=>{var r;return O(O({},t),{playerId:a,teamId:s[t.teamId],avatar:null!=(r=t.avatar)?r:e.Avatar.GET_RANDOM()})})).freeze()},Object.freeze(t)}(y||(y={})),r.R.protoNoEnum(y,"onGamePlaying","onGamePaused","onGameOver","_onTeamsBootstrapped"),Object.freeze(y),Object.freeze(y.prototype)},97:(e,t,s)=>{"use strict";s.d(t,{S:()=>r});var a=s(990);class r{constructor(e,t){if(this.id=e,this.members=t,this.elimOrder=r.ElimOrder.STANDING,a.R.propNoWrite(this,"id","members"),Object.seal(this),0===t.length)throw new Error("Teams must have at least one member.")}reset(){this.elimOrder=r.ElimOrder.STANDING}}!function(e){let t;(t=e.ElimOrder||(e.ElimOrder={})).STANDING=0}(r||(r={})),Object.freeze(r),Object.freeze(r.prototype)},220:(e,t,s)=>{"use strict";s.d(t,{b:()=>i});var a=s(990);const r=Object.freeze({IDENT:e=>e,LOWER:e=>e.toLowerCase()}),i={"engl-low":{id:void 0,module:"English",export:"Lowercase",isolatedMinOpts:25,avgWeight:3.8639230769230766,remapFunc:r.LOWER,fontScaling:1,displayName:"English Lowercase (qwerty)",blurb:""},"engl-mix":{id:void 0,module:"English",export:"MixedCase",isolatedMinOpts:51,avgWeight:3.8639230769230775,remapFunc:r.IDENT,fontScaling:1,displayName:"English Mixed-Case (Qwerty)",blurb:""},"japn-hir":{id:void 0,module:"Japanese",export:"Hiragana",isolatedMinOpts:70,avgWeight:275509.7083333333,remapFunc:r.LOWER,fontScaling:1,displayName:"Japanese Hiragana",blurb:""},"japn-kat":{id:void 0,module:"Japanese",export:"Katakana",isolatedMinOpts:68,avgWeight:45577.26666666667,remapFunc:r.LOWER,fontScaling:1,displayName:"Japanese Katakana",blurb:""},"kore-dub":{id:void 0,module:"Korean",export:"Dubeolsik",isolatedMinOpts:9085,avgWeight:.9974982117852247,remapFunc:r.IDENT,fontScaling:1,displayName:"Korean Dubeolsik (ÎëêÎ≤åÏãù ÌÇ§Î≥¥Îìú)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},"kore-sub":{id:void 0,module:"Korean",export:"Sebeolsik",isolatedMinOpts:10098,avgWeight:.9974982117852336,remapFunc:r.IDENT,fontScaling:1,displayName:"Korean Sebeolsik (ÏÑ∏Î≤åÏãù ÏµúÏ¢Ö ÌÇ§Î≥¥Îìú)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},"kore-rom":{id:void 0,module:"Korean",export:"Romanization",isolatedMinOpts:4764,avgWeight:.9974982117852286,remapFunc:r.LOWER,fontScaling:1,displayName:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (Íµ≠Ïñ¥Ïùò Î°úÎßàÏûê ÌëúÍ∏∞Î≤ï; ÂúãË™ûÏùò Î°úÎßàÂ≠ó Ë°®Ë®òÊ≥ï) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"},"engl-cell-enc":{id:void 0,module:"English",export:"OldCellphone.Encode",isolatedMinOpts:7,avgWeight:3.8639230769230766,remapFunc:r.IDENT,fontScaling:1,displayName:"Old Cellphone Keyboard",blurb:""},"mors-enc":{id:void 0,module:"English",export:"Morse.Encode",isolatedMinOpts:11,avgWeight:2.6089716238018403,remapFunc:e=>e,fontScaling:1,displayName:"Morse Encoder",blurb:""},"mors-dec":{id:void 0,module:"English",export:"Morse.Decode",isolatedMinOpts:40,avgWeight:2.6089716238018408,remapFunc:r.LOWER,fontScaling:.4,displayName:"Morse Decoder",blurb:""},ngram2:{id:void 0,module:"Ngrams",export:"Ngram2",isolatedMinOpts:199,avgWeight:5.000010000000002,remapFunc:r.LOWER,fontScaling:.9,displayName:"English Bigrams",blurb:""},ngram3:{id:void 0,module:"Ngrams",export:"Ngram3",isolatedMinOpts:399,avgWeight:2.5000100000000023,remapFunc:r.LOWER,fontScaling:.6,displayName:"English Trigrams",blurb:""},numpad:{id:void 0,module:"Numpad",export:"Numpad",isolatedMinOpts:99,avgWeight:1,remapFunc:r.LOWER,fontScaling:.95,displayName:"Number Pad",blurb:""}};Object.entries(i).freeze().forEach((([e,t])=>{t.id=e})),a.R.deepFreeze(i)},88:(e,t,s)=>{"use strict";s.r(t),s.d(t,{game:()=>Xe,screen:()=>Ke,top:()=>Ye}),s(741),s(489);var a,r=s(990);!function(e){let t;var s;let a,r;e.ID={PUBLIC_GAME_SERVER_URLS:"public-game-hosts-list",CURRENT_HOST_GROUPS:"current-host-groups-list"},(s=t=e.General||(e.General={})).Class={FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents",INPUT_GROUP:"input-group",INPUT_GROUP_ITEM:"input-group-item"},s.Dataset={COLOUR_SCHEME:"colourScheme"},(a=e.Player||(e.Player={})).Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"},function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"screen",NAV_NEXT:"screen--next-button",NAV_PREV:"screen--prev-button"},function(e){let t;(t=e.Setup||(e.Setup={})).Id={LANG_WEIGHT_EXAGGERATION_LIST:"screen-setup--lang-weight-exaggeration-list"}}(t=e.Impl||(e.Impl={}))}(r=e.Screen||(e.Screen={}))}(a||(a={})),r.R.deepFreeze(a);var i,n=s(635);!function(e){let t;e.Local=r.R.Web._makeSmartStorage("capswalk",localStorage,{volumeBgMusic:1,volumeSfx:1,emojiFont:"twemoji",conservativeAnimations:!0,colourSchemeId:"default",colourSchemeStyleLiteral:"",gamePresetId:"",username:"unnamed player",avatar:""}),e.getLastUserInfo=function(){var t;return Object.freeze({username:e.Local.username,teamId:0,avatar:null!=(t=e.Local.avatar)?t:n.J5.Avatar.GET_RANDOM()})},e.Session=r.R.Web._makeSmartStorage("capswalk",localStorage,Object.freeze({})),function(e){let t;e.DB_NAME="capswalk_db",(t=e.UserGamePresetStore||(e.UserGamePresetStore={})).STORE_NAME="userGamePresets",Object.freeze(t)}(t=e.IDB||(e.IDB={})),Object.freeze(t)}(i||(i={})),Object.freeze(i);var o,l,c=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},d=(e,t,s)=>(c(e,t,"read from private field"),s?s.call(e):t.get(e)),h=(e,t,s,a)=>(c(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);const p=a.Screen.Class,u=class{constructor(e,t){o.set(this,void 0),this.baseElem=r.R.html("div",[p.BASE]),l.set(this,!1),this.screenId=t,this.screenNames=r.R.camelCaseTransforms(t),this.top=e.toplevel,h(this,o,e.parentElem),this.requestGoToScreen=e.goToScreen,this.nav=Object.freeze({prev:r.R.html("button"),next:r.R.html("button")}),r.R.propNoWrite(this,"screenId","top","baseElem","nav","requestGoToScreen"),this.nav.prev.classList.add(p.NAV_PREV),this.nav.next.classList.add(p.NAV_NEXT),this.nav.prev.textContent="Back",this.nav.next.textContent="Next",this.nav.prev.onclick=e=>{const s=u.NavTree,a=s[this.screenId];s[a.prev].href===a.href?this.requestGoToScreen(u.NavTree[t].prev,void 0):window.history.back()}}lazyLoad(){d(this,l)||(this._abstractLazyLoad(),this.baseElem.setAttribute("aria-label",this.screenNames.spaceyCapitalized+" Screen"),h(this,l,!0))}async _enter(e,t){var s;if(document.title=`${this.screenNames.spaceyCapitalized} | ${this.top.defaultDocTitle}`,e===u.NavDir.FORWARD){const e=new window.URL(window.location.href),t=e.hash=u.NavTree[this.screenId].href,a=[{screenId:this.screenId},"",e.href];(null==(s=window.history.state)?void 0:s.screenId)!==t&&(u.NavTree[this.screenId].prev===this.screenId?history.replaceState(...a):history.pushState(...a))}this.lazyLoad(),await this._abstractOnBeforeEnter(e,t)}_leave(e){return!!this._abstractOnBeforeLeave(e)}_onAfterEnter(){this.baseElem.setAttribute("aria-current","true"),d(this,o).appendChild(this.baseElem)}_onAfterLeave(){this.baseElem.setAttribute("aria-current","false"),this.baseElem.remove()}getRecommendedFocusElem(){}async _abstractOnBeforeEnter(e,t){}_abstractOnBeforeLeave(e){return!0}};let m=u;o=new WeakMap,l=new WeakMap,function(e){let t;var s;let a;var i;(s=t=e.Id||(e.Id={})).HOME="home",s.HOW_TO_PLAY="how-to-play",s.HOW_TO_HOST="how-to-host",s.SETTINGS="settings",s.SETUP_OFFLINE="setup-offline",s.PLAY_OFFLINE="play-offline",s.GROUP_JOINER="group-joiner",s.SETUP_ONLINE="setup-online",s.GROUP_LOBBY="group-lobby",s.PLAY_ONLINE="play-online",Object.freeze(t),e.NavTree=r.R.deepFreeze({[t.HOME]:{prev:t.HOME,href:t.HOME},[t.HOW_TO_PLAY]:{prev:t.HOME,href:t.HOW_TO_PLAY},[t.HOW_TO_HOST]:{prev:t.HOME,href:t.HOW_TO_HOST},[t.SETTINGS]:{prev:t.HOME,href:t.SETTINGS},[t.SETUP_OFFLINE]:{prev:t.HOME,href:t.SETUP_OFFLINE},[t.PLAY_OFFLINE]:{prev:t.SETUP_OFFLINE,href:t.SETUP_OFFLINE},[t.GROUP_JOINER]:{prev:t.HOME,href:t.GROUP_JOINER},[t.GROUP_LOBBY]:{prev:t.GROUP_JOINER,href:t.GROUP_JOINER},[t.SETUP_ONLINE]:{prev:t.GROUP_LOBBY,href:t.GROUP_JOINER},[t.PLAY_ONLINE]:{prev:t.GROUP_LOBBY,href:t.GROUP_JOINER}}),(i=a=e.NavDir||(e.NavDir={})).FORWARD="forward",i.BACKWARD="backward",e.GET_NAV_DIR=function(t){const{curr:s,dest:a}=t;if(void 0===s)return e.NavDir.FORWARD;let r=s;for(;r!==e.NavTree[r].prev;)if(r=e.NavTree[r].prev,r===a)return e.NavDir.BACKWARD;return e.NavDir.FORWARD}}(m||(m={})),Object.freeze(m),Object.freeze(m.prototype);const v={this:"_2fw8LavR89kQmI-ujd84Oc",nav:"_3bXQ_T8CN61h-XuM1Q5CKO","nav--play-offline":"_27pYKLXKIhEkDPRBq7FQkG","nav--play-online":"_1cZmpRlPlHZasyAk0suiYy","nav--how-to-play":"_29Ok3ZNcVG4aBK7f28U0Vl","nav--how-to-host":"_1Me42uM4lSoh2869wVFjJD","nav--settings":"_1mGDMT1Tpul7EChDAmf3FS","nav--goto-repo":"_2mwhS0oLTAcnpq5YWXg7cq","nav--report-issue":"QdLSQUx8gcAov0d1PYNgJ"};class E extends m{_abstractLazyLoad(){Object.freeze(this),this.baseElem.classList.add(a.General.Class.CENTER_CONTENTS,v.this);const e=r.R.html("div",[a.General.Class.INPUT_GROUP,v.nav]);e.setAttribute("role","navigation"),e.addEventListener("pointerleave",(()=>{var t;(null==(t=document.activeElement)?void 0:t.parentElement)===e&&document.activeElement.blur()}));const t=(t,s)=>{t.classList.add(a.General.Class.CENTER_CONTENTS,a.General.Class.INPUT_GROUP_ITEM,s.cssClass),t.textContent=s.text,t.addEventListener("pointerenter",(()=>{window.requestAnimationFrame((e=>{t.focus()}))})),e.appendChild(t)};[{text:"Offline Single-player",cssClass:v["nav--play-offline"],screenId:m.Id.SETUP_OFFLINE},{text:"Online Multi-player",cssClass:v["nav--play-online"],screenId:m.Id.GROUP_JOINER},{text:"How To Play",cssClass:v["nav--how-to-play"],screenId:m.Id.HOW_TO_PLAY},{text:"How To Host",cssClass:v["nav--how-to-host"],screenId:m.Id.HOW_TO_HOST},{text:"Settings",cssClass:v["nav--settings"],screenId:m.Id.SETTINGS}].map((e=>Object.freeze(e))).forEach((e=>{const s=r.R.html("button");s.addEventListener("click",(t=>{this.requestGoToScreen(e.screenId,void 0)})),t(s,e)})),[{text:"Source\nCode",cssClass:v["nav--goto-repo"],href:new window.URL("https://github.com/david-fong/capswalk")},{text:"Report\nIssue",cssClass:v["nav--report-issue"],href:new window.URL("https://github.com/david-fong/capswalk/issues")}].map((e=>Object.freeze(e))).forEach((e=>{const s=r.R.html("a",[],{href:e.href.toString(),target:"_blank"});t(s,e)})),this.baseElem.appendChild(e)}}Object.freeze(E),Object.freeze(E.prototype);class b extends m{_abstractLazyLoad(){Object.freeze(this)}}Object.freeze(b),Object.freeze(b.prototype);class O extends m{_abstractLazyLoad(){Object.freeze(this)}}(O||(O={})).INSTRUCTIONS_STEPS=Object.freeze(["$ npm install 'https://github.com/david-fong/capswalk#gh-pages'","$ npm run start","send the url to your friends"]),Object.freeze(O),Object.freeze(O.prototype);const f=JSON.parse('[{"id":"default","displayName":"Default","author":"N.W."},{"id":"murky-dive","displayName":"Murky Dive","author":"Stressed Dav"},{"id":"smooth-stone","displayName":"Smooth Stone","author":"Dav"}]');var g,_,S,y,N,T,I=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},L=(e,t,s)=>(I(e,t,"read from private field"),s?s.call(e):t.get(e)),R=(e,t,s,a)=>(I(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);class w{constructor(){g.set(this,void 0),_.set(this,void 0),S.set(this,void 0);const e=r.R.html("div",["_3tt0mEYF2K12deMBmuiflg"],{tabIndex:0});e.setAttribute("role","listbox"),e.addEventListener("keydown",this._onKeyDown.bind(this)),e.addEventListener("pointerenter",(t=>{window.requestAnimationFrame((t=>{e.focus()}))})),this.baseElem=e,this.options=[]}addOption(e){this.options.push(e),this.baseElem.appendChild(e.baseElem),e.baseElem.addEventListener("pointerenter",this.hoverOpt.bind(this,e)),e.baseElem.addEventListener("click",this.selectOpt.bind(this,e,!0)),e._registerParent(this._onOptDisabledChange.bind(this))}hoverOpt(e){var t;this.hoveredOpt!==e&&(null==(t=this.hoveredOpt)||t.baseElem.setAttribute("aria-active-descendant","false"),R(this,_,e),this.hoveredOpt.baseElem.setAttribute("aria-active-descendant","true"))}selectOpt(e,t=!0){var s;if(!e)throw new Error("opt must be defined");this.hoverOpt(e),this.confirmedOpt!==e&&(null==(s=this.confirmedOpt)||s.baseElem.setAttribute("aria-selected","false"),R(this,g,e),this.confirmedOpt.baseElem.setAttribute("aria-selected","true"),t&&this._onSelectOpt(e))}get confirmedOpt(){return L(this,g)}get hoveredOpt(){return L(this,_)}_onOptDisabledChange(e){this.confirmedOpt===e&&(this._isValid=!e.disabled)}set _isValid(e){this._isValid!==e&&(this.baseElem.setAttribute("aria-invalid",e?"false":"true"),R(this,S,e))}get _isValid(){return L(this,S)}_onKeyDown(e){if(" "===e.key||"Enter"===e.key)return this.selectOpt(this.hoveredOpt),e.preventDefault(),!1;{const t=this.options.indexOf(this.hoveredOpt);if("ArrowDown"===e.key||"Down"===e.key)for(let s=t+1;s<this.options.length;s++){const t=this.options[s];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}else if("ArrowUp"===e.key||"Up"===e.key)for(let s=t-1;s>=0;s--){const t=this.options[s];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}}return!0}}g=new WeakMap,_=new WeakMap,S=new WeakMap,y=w||(w={}),N=new WeakMap,T=new WeakMap,y._Option=class{constructor(){N.set(this,void 0),T.set(this,void 0),(this.baseElem=r.R.html("div",["aq-ZO_N3w-UH9VTYF60rL"])).setAttribute("role","option"),R(this,N,!1)}_registerParent(e){R(this,T,e)}get disabled(){return L(this,N)}set disabled(e){this.disabled!==e&&(this.baseElem.setAttribute("aria-disabled",e?"true":"false"),R(this,N,e),L(this,T).call(this,this))}},Object.freeze(y),Object.freeze(y.prototype),Object.freeze(w),Object.freeze(w.prototype);var C,P,G=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},A=(e,t,s)=>(G(e,t,"read from private field"),s?s.call(e):t.get(e)),U=(e,t,s,a)=>(G(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);class j extends m{_abstractLazyLoad(){s(649)("./undefined.css").catch((e=>{})),this.baseElem.classList.add("_34njqL2OnvWqeYLyHr9HdG"),this.baseElem.appendChild(this.nav.prev),this.sel=new j.PickOne(this.top.storage.Local,this.top.transition),r.R.propNoWrite(this,"sel"),this.baseElem.appendChild(this.sel.baseElem),this.sel.selectOpt(this.sel.getOptById(this.top.storage.Local.colourSchemeId),!1)}}!function(e){var t,s,i;const n=class extends w{constructor(e,a){super(),t.set(this,void 0),s.set(this,void 0),i.set(this,void 0),U(this,t,!0),U(this,s,e),U(this,i,a),C.Schemes.forEach((e=>{this.addOption(new n.Option(e))})),this.selectOpt(this.getOptById(A(this,s).colourSchemeId),!1)}_onHoverOpt(e){}_onSelectOpt(e){A(this,s).colourSchemeId=e.desc.id,A(this,s).colourSchemeStyleLiteral=e.cssLiteral;const r=A(this,t);U(this,t,!1),A(this,i).do({intermediateTransitionTrigger:()=>{document.documentElement.dataset[a.General.Dataset.COLOUR_SCHEME]=e.desc.id;const t=document.documentElement.style;if(r)for(const e of C.Swatch){const s="--colour-"+e;t.setProperty(s,"")}}})}getOptById(e){return this.options.find((t=>t.desc.id===e))}};let o=n;t=new WeakMap,s=new WeakMap,i=new WeakMap,e.PickOne=o,function(e){class t extends w._Option{constructor(e){super(),this.desc=e;const s=this.baseElem;s.classList.add("_2Z6CSdJGqHZgmec-vwm96z"),s.dataset[a.General.Dataset.COLOUR_SCHEME]=e.id;const i=r.R.html("span",["_2zvrpKxs0ZPQh6TVEIqwlr"]);i.appendChild(r.R.html("div",["_6aXMsc2lwXpIJQgbW5PvC"],{textContent:e.displayName})),i.appendChild(r.R.html("div",["_3PHVBVCZuqvL7IoyfkFVnx"],{textContent:"by "+e.author})),s.appendChild(i);for(let e=0;e<t.NUM_PREVIEW_SLOTS-1;e++)s.appendChild(r.R.html("span"));document.body.appendChild(s);let n="";const o=window.getComputedStyle(s);for(const e of C.Swatch){const t="--colour-"+e;n+=t+":"+o.getPropertyValue(t)+";"}this.cssLiteral=n}}e.Option=t,(t=e.Option||(e.Option={})).NUM_PREVIEW_SLOTS=8,Object.freeze(t),Object.freeze(t.prototype)}(o=e.PickOne||(e.PickOne={})),Object.freeze(o),Object.freeze(o.prototype)}(j||(j={})),Object.freeze(j),Object.freeze(j.prototype),(P=C||(C={})).Swatch=Object.freeze(["mainFg","mainBg","tileFg","tileBg","tileBd","healthFg","healthBg","pFaceMe","pFaceMeOppo","pFaceTeammate","pFaceOpponent"]),P.Schemes=r.R.deepFreeze(Array.from(f)),Object.freeze(C);var z=s(30),M=s(220);var k=Object.defineProperty,x=Object.prototype.hasOwnProperty,D=Object.getOwnPropertySymbols,W=Object.prototype.propertyIsEnumerable,B=(e,t,s)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;class H extends m{constructor(){super(...arguments),this.langSel=new H.LangPickOne}_abstractLazyLoad(){this.baseElem.classList.add("_18T-RiVnTQugnMDE5W5g2S"),this.baseElem.appendChild(this.nav.prev),this.baseElem.appendChild(this.langSel.baseElem),this._createLangWeightExaggerationInput(),r.R.propNoWrite(this,"langSel","langWeightExaggeration"),this.baseElem.appendChild(this.nav.next),this._loadLastUsedPreset()}_createLangWeightExaggerationInput(){const e=this.langWeightExaggeration=r.R.html("input",["_3vawCmM619VS6F2hL-NerD"],{type:"range",min:"0",max:n.Uo.WeightExaggeration.MAX.toString(),step:"any",value:"1"});{const e=r.R.html("datalist");e.id=a.Screen.Impl.Setup.Id.LANG_WEIGHT_EXAGGERATION_LIST,[{val:0,label:"0"},{val:1,label:"1"}].forEach((t=>{e.appendChild(r.R.html("option",[],{value:t.val.toString(),label:t.label}))})),this.baseElem.appendChild(e)}e.setAttribute("list",a.Screen.Impl.Setup.Id.LANG_WEIGHT_EXAGGERATION_LIST),this.baseElem.appendChild(e)}getRecommendedFocusElem(){return this.nav.next}_loadLastUsedPreset(){this.top.storage.Local.gamePresetId,this.top.storage.IDB.UserGamePresetStore}parseArgsFromGui(){const e=((e,t)=>{for(var s in t||(t={}))x.call(t,s)&&B(e,s,t[s]);if(D)for(var s of D(t))W.call(t,s)&&B(e,s,t[s]);return e})({},H.DEFAULT_PRESET());return e.langId=this.langSel.confirmedOpt.desc.id,e.langWeightExaggeration=parseFloat(this.langWeightExaggeration.value),e}}!function(e){e.DEFAULT_PRESET=()=>({coordSys:"W_EUCLID2",gridDimensions:{height:10,width:10},langWeightExaggeration:1,langId:"engl-low",players:[{familyId:"CHASER",teamId:1,username:"chaser1",avatar:n.J5.Avatar.GET_RANDOM(),familyArgs:{}},{familyId:"CHASER",teamId:1,username:"chaser2",avatar:n.J5.Avatar.GET_RANDOM(),familyArgs:{fearDistance:6,bloodThirstDistance:5,healthReserve:5,keyPressesPerSecond:1.8}}]});class t extends w{constructor(){super(),this.baseElem.classList.add("_2PZpDhMzEe7lio-sMdv4SB"),Object.values(M.b).freeze().forEach((e=>{this.addOption(new t.Option(e))})),this.selectOpt(this.options[0])}_onHoverOpt(e){}_onSelectOpt(e){}}e.LangPickOne=t,function(e){class t extends w._Option{constructor(e){super(),this.desc=e,this.baseElem.textContent=e.displayName}}e.Option=t,Object.freeze(t),Object.freeze(t.prototype)}(t=e.LangPickOne||(e.LangPickOne={})),Object.freeze(t),Object.freeze(t.prototype)}(H||(H={})),Object.freeze(H),Object.freeze(H.prototype);class F extends H{_abstractLazyLoad(){super._abstractLazyLoad(),Object.freeze(this),this.nav.next.onclick=e=>{const t=this.parseArgsFromGui();this.requestGoToScreen(m.Id.PLAY_OFFLINE,[t])}}parseArgsFromGui(){const e=super.parseArgsFromGui();return e.players.splice(e.players.length,0,{familyId:"HUMAN",teamId:0,socket:void 0,username:"hello1",avatar:z.J.Avatar.GET_RANDOM()},{familyId:"HUMAN",teamId:1,socket:void 0,username:"hello2",avatar:z.J.Avatar.GET_RANDOM()}),e}}Object.freeze(F),Object.freeze(F.prototype);var J=s(816);class q extends m{constructor(){super(...arguments),this.playersBar=r.R.html("div",["BDHhbE0AQjge5tlj2Z3_O"])}_abstractLazyLoad(){this.baseElem.classList.add(a.General.Class.CENTER_CONTENTS,"_1euFnazUyfYf-c6qSiUhez");const e=q.createGridWrapper();this.grid=Object.freeze({base:e.top,implHost:e.implHost,pauseOl:e.pauseOl}),r.R.propNoWrite(this,"grid","playersBar"),r.R.Web.prependComment(this.grid.implHost,"grid impl host"),this.grid.implHost.appendChild(document.createComment("grid impl")),this.baseElem.appendChild(e.top),e.pauseOl.addEventListener("click",(e=>{const t=this.currentGame;void 0!==t&&t.status===J.l.Status.PAUSED&&(this.grid.base.focus(),this._reqStatusPlaying())})),this._initializeControlsBar(),this._initializePlayersBar()}_resetGame(){this.currentGame.reset(),this.btn.pause.disabled=!1,this._wantsAutoPlayPause&&this._reqStatusPlaying()}_initializeControlsBar(){const e=r.R.html("div",[a.General.Class.CENTER_CONTENTS,a.General.Class.INPUT_GROUP,"fLS47QhRkscn0NK-vdINf"]);function t(t,s){return(s=null!=s?s:r.R.html("button")).classList.add(a.General.Class.INPUT_GROUP_ITEM),s.textContent=t,s.addEventListener("pointerenter",(e=>{s.focus()})),e.appendChild(s),s}e.setAttribute("role","menu"),e.addEventListener("pointerleave",(e=>{this.grid.base.focus()})),t("<Back Button Text>",this.nav.prev),this.btn=Object.freeze({pause:t(""),reset:t("Reset")}),r.R.propNoWrite(this,"btn"),this.btn.reset.onclick=this._resetGame.bind(this),this.baseElem.appendChild(e)}_initializePlayersBar(){r.R.propNoWrite(this),this.baseElem.appendChild(this.playersBar)}}(q||(q={})).createGridWrapper=function(){const e=a.General.Class,t=r.R.html("div",["_2jXbc7jisQYh8dGHBjQfoB"]);t.setAttribute("role","presentation");const s=r.R.html("div",["_3RnyB-FPnRJq2VQ-jJ1Fdy"],{tabIndex:0});s.setAttribute("role","textbox"),s.setAttribute("aria-label","Game Grid");const i=r.R.html("div",["_3To0VmRGhvAChHm1UecO55"]);i.setAttribute("role","presentation");const n=r.R.html("div",[e.FILL_PARENT,e.CENTER_CONTENTS,"_3RB2_LMTHSqVD3X5arzyV"],{});return n.appendChild(r.R.html("div",[],{textContent:"(Click to Unpause)"})),i.appendChild(n),s.appendChild(i),t.appendChild(s),Object.freeze({top:t,grid:s,intersectionRoot:i,implHost:i,pauseOl:n})},r.R.instNoEnum(q,"createGridWrapper"),Object.freeze(q),Object.freeze(q.prototype);var V,Y,K,X,Z=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},Q=(e,t,s)=>(Z(e,t,"read from private field"),s?s.call(e):t.get(e)),$=(e,t,s,a)=>(Z(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);class ee extends q{constructor(){super(...arguments),V.set(this,void 0),Y.set(this,void 0),K.set(this,void 0),X.set(this,void 0)}_abstractLazyLoad(){super._abstractLazyLoad(),$(this,Y,(()=>{if(this._wantsAutoPlayPause)if(document.hidden){if(void 0===Q(this,X)){const e=this.currentGame;(void 0===e||void 0!==e&&e.status!==J.l.Status.OVER)&&this._reqStatusPaused()}}else"page-hide"===Q(this,X)&&this._reqStatusPlaying()})),$(this,K,this._gridKeyDownCallback.bind(this))}async _abstractOnBeforeEnter(e,t){document.addEventListener("visibilitychange",Q(this,Y)),this.btn.pause.disabled=!0,this._statusBecomePaused();const s=$(this,V,await this._createNewGame(t));await s.reset(),this.grid.implHost.appendChild(s.grid.baseElem),this.btn.pause.onclick=this._reqStatusPlaying.bind(this),this.btn.pause.disabled=!1,this._wantsAutoPlayPause&&setTimeout((()=>{document.hidden||this._reqStatusPlaying()}),100),this.grid.base.addEventListener("keydown",Q(this,K),{capture:!0})}_abstractOnBeforeLeave(e){if(this._askConfirmBeforeLeave&&!this.top.confirm("Are you sure you would like to leave?"))return!1;document.removeEventListener("visibilitychange",Q(this,Y)),this.currentGame.statusBecomeOver();for(const e of[this.currentGame.grid.baseElem])e.textContent="",e.remove();return this.grid.base.removeEventListener("keydown",Q(this,K)),$(this,V,void 0),!0}get currentGame(){return Q(this,V)}get probeCurrentGame(){return Q(this,V)}_gridKeyDownCallback(e){if(e.stopPropagation(),!e.isTrusted)return!0;const t=this.currentGame;if(e.ctrlKey&&" "===e.key&&!e.repeat){const e=t.operators;t.setCurrentOperator((1+e.indexOf(t.currentOperator))%e.length)}else t.currentOperator.processKeyboardInput(e);return" "!==e.key||(e.preventDefault(),!1)}_reqStatusPlaying(){this._statusBecomePlaying()}_reqStatusPaused(){this._statusBecomePaused()}_statusBecomePlaying(){this.currentGame.statusBecomePlaying(),this.btn.pause.textContent="Pause",this.grid.pauseOl.style.visibility="hidden",$(this,X,void 0),this.btn.pause.onclick=this._reqStatusPaused.bind(this),this.btn.reset.disabled=!0,this.grid.base.focus()}_statusBecomePaused(){var e;null==(e=this.currentGame)||e.statusBecomePaused(),this.btn.pause.textContent="Unpause",this.grid.pauseOl.style.visibility="visible",$(this,X,document.hidden?"page-hide":"other"),this.btn.pause.onclick=this._reqStatusPlaying.bind(this),this.btn.reset.disabled=!1}_onGameBecomeOver(){this.btn.pause.disabled=!0,this.btn.reset.disabled=!1}}V=new WeakMap,Y=new WeakMap,K=new WeakMap,X=new WeakMap,r.R.protoNoEnum(ee,"probeCurrentGame","_statusBecomePlaying","_statusBecomePaused"),Object.freeze(ee),Object.freeze(ee.prototype);class te extends ee{constructor(){super(...arguments),this._wantsAutoPlayPause=!1,this._askConfirmBeforeLeave=!0}_abstractLazyLoad(){super._abstractLazyLoad(),Object.freeze(this),this.nav.prev.innerHTML="Back&nbsp;To Setup"}async _createNewGame(e){return new((await Promise.all([s.e(68),s.e(399),s.e(755)]).then(s.bind(s,145))).OfflineGame)(this._onGameBecomeOver.bind(this),e[0])}}Object.freeze(te),Object.freeze(te.prototype);var se=s(969);var ae,re=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};class ie extends m{constructor(){super(...arguments),ae.set(this,void 0),this.groupNameDataList=r.R.html("datalist",[],{id:a.ID.CURRENT_HOST_GROUPS})}get state(){return re(this,e=ae,"read from private field"),e.get(this);var e}_abstractLazyLoad(){this.baseElem.classList.add(a.General.Class.CENTER_CONTENTS,"_1mSAZ0WI6Dl-lgWbZngYuh");const e=this._initFormContents();this.baseElem.appendChild(this.groupNameDataList),this.nav.prev.classList.add(a.General.Class.INPUT_GROUP_ITEM),this.nav.next.classList.add(a.General.Class.INPUT_GROUP_ITEM),e.appendChild(this.nav.prev),e.appendChild(this.nav.next),this.nav.next.onclick=e=>{this.requestGoToScreen(m.Id.GROUP_LOBBY,void 0)},this._setFormState(ne.CHOOSING_SERVER),this.baseElem.appendChild(e)}_setFormState(e){if(this.state!==e){if(this.in.passphrase.disabled=!0,e===ne.IN_GROUP){if(this.state!==ne.CHOOSING_GROUP)throw new Error("never");this.nav.next.disabled=!1,this.nav.next.focus()}else this.nav.next.disabled=!0,this.in.passphrase.value="",e===ne.CHOOSING_SERVER?(this.in.groupName.disabled=!0,this.in.groupName.value="",this.groupNameDataList.textContent="",this.in.serverUrl.focus()):e===ne.CHOOSING_GROUP&&(this.in.groupName.disabled=!1,this.in.passphrase.disabled=!1,this.in.groupName.focus());var t,s;s=e,re(this,t=ae,"write to private field"),t.set(this,s)}}_initFormContents(){const e=r.R.html("div",[a.General.Class.INPUT_GROUP,"_3PpQNPHVO6NTNpgwU79ERL"],{});function t(t,s){const i=r.R.html("input",[a.General.Class.INPUT_GROUP_ITEM,s],{type:"text",autocomplete:"off",spellcheck:!1}),n=r.R.html("label",[],{textContent:t});return n.appendChild(i),e.appendChild(n),i}this.in=Object.freeze({serverUrl:Object.assign(t("Server URL","NgHzGx-miZPI-3fgl2oSY"),{type:"url",maxLength:128,autocomplete:"on",required:!0}),groupName:Object.assign(t("Group Name","_1JfrTGHJVK3NgMBs8AnnXZ"),{pattern:se.ZA.Name.REGEXP.source,minLength:1,maxLength:se.ZA.Name.MaxLength,autocomplete:"on",required:!0}),passphrase:Object.assign(t("Group Passphrase","_2tjc31lyon2RB1Ww3pt47Y"),{pattern:se.ZA.Passphrase.REGEXP.source,maxLength:se.ZA.Passphrase.MaxLength})}),this.in.groupName.setAttribute("list",a.ID.CURRENT_HOST_GROUPS);{this.in.serverUrl.setAttribute("list",a.ID.PUBLIC_GAME_SERVER_URLS);const e=qe.SiteServerTypeSuggestedGameServer[this.top.siteServerType];if(e){const t=r.R.html("option",[],{value:e.value,textContent:e.description});document.getElementById(a.ID.PUBLIC_GAME_SERVER_URLS).insertAdjacentElement("afterbegin",t),this.in.serverUrl.value=t.value}}return r.R.propNoWrite(this,"in","groupNameDataList"),e}}ae=new WeakMap,function(e){let t;var s;(s=t=e.State||(e.State={})).CHOOSING_SERVER="choosing-server",s.CHOOSING_GROUP="choosing-group",s.IN_GROUP="in-group"}(ie||(ie={}));const ne=ie.State;Object.freeze(ie),Object.freeze(ie.prototype);var oe,le,ce,de=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},he=(e,t,s)=>(de(e,t,"read from private field"),s?s.call(e):t.get(e)),pe=(e,t,s,a)=>(de(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);class ue extends ie{constructor(){super(...arguments),oe.set(this,!1),le.set(this,!1),ce.set(this,void 0)}get isHost(){return he(this,le)}get ws(){return this.top.webSocket}_abstractLazyLoad(){super._abstractLazyLoad(),pe(this,ce,(e=>{const[t,...s]=JSON.parse(e.data);switch(t){case se.oU.Create.NAME:this._onCreateResponse(s[0]);break;case se.oU.Exist.NAME:this._onNotifyGroupExist(s[0]);break;case se.oU.TryJoin.NAME:this._setFormState(me.IN_GROUP);break;case se.m4.CREATE_GAME:this.requestGoToScreen(m.Id.PLAY_ONLINE,[s[0],s[1]])}}));const e=this._initServerUrlCbs();this._initGroupNameCbs(e),this._initPassphraseCbs(),Object.seal(this)}getRecommendedFocusElem(){return void 0===this.ws?this.in.serverUrl:this.in.groupName}_initServerUrlCbs(){const e=this.top,t=this.in.serverUrl;t.addEventListener("input",(e=>{this._setFormState(me.CHOOSING_SERVER)}));const s=()=>{t.value&&t.validity.valid&&(void 0===this.ws||new URL(this.ws.url).hostname!==new URL(t.value).hostname?(this.top.setWebSocket(new WebSocket(t.value)),this.ws.addEventListener("open",(e=>{this._setFormState(me.CHOOSING_GROUP)})),this.ws.addEventListener("message",he(this,ce)),this.ws.addEventListener("close",(t=>{this.top.setWebSocket(void 0),this._setFormState(me.CHOOSING_SERVER),e.toast("You disconnected you from the server."),this.top.currentScreen!==this&&this.requestGoToScreen(m.Id.GROUP_JOINER,void 0)}),{once:!0})):he(this,oe)&&this._setFormState(me.CHOOSING_GROUP))};return t.addEventListener("keydown",(e=>{e.isTrusted&&"Enter"===e.key&&s()})),t.addEventListener("paste",(e=>{e.isTrusted&&window.setTimeout((()=>s()),0)})),t.addEventListener("change",(e=>{e.isTrusted&&s()})),s}_onCreateResponse(e){return e?(this.top.toast(`server accepted request to create new group "${this.in.groupName.value}".`),this.top.toast("connecting to new group..."),void this._attemptToJoinExistingGroup()):(pe(this,oe,!0),void this.top.toast(`The server rejected your request to create a new group "${this.in.groupName.value}".`))}_onNotifyGroupExist(e){const t=e=>{const t=r.R.html("option",[],{value:e});for(const e of s)if(t.value.localeCompare(e.value)<0){this.groupNameDataList.insertBefore(t,e);break}return t.parentElement||this.groupNameDataList.appendChild(t),t},s=Array.from(this.groupNameDataList.children);Object.entries(e).freeze().forEach((([e,a])=>{var r;const i=null!=(r=s.find((t=>t.value===e)))?r:t(e);switch(a){case se.oU.Exist.Status.IN_LOBBY:i.textContent="In Lobby";break;case se.oU.Exist.Status.IN_GAME:i.textContent="In Game";break;case se.oU.Exist.Status.DELETE:i.remove()}}))}_initGroupNameCbs(e){const t=this.in.groupName;t.addEventListener("input",(t=>{t.isTrusted&&(this.state===me.IN_GROUP&&e(),this.in.passphrase.value="",pe(this,le,!1))}));const s=()=>{t.value&&t.validity.valid&&(this.state===me.IN_GROUP?this.nav.next.focus():this.in.passphrase.focus())};t.addEventListener("keydown",(e=>{e.isTrusted&&"Enter"===e.key&&s()})),t.addEventListener("change",(e=>{e.isTrusted&&s()}))}_initPassphraseCbs(){const e=()=>{if(!this.in.passphrase.validity.valid)return;he(this,oe)&&this._setFormState(me.IN_GROUP);const e=this.in.groupName.value;Array.from(this.groupNameDataList.children).some((t=>t.value===e))?(pe(this,le,!1),this._attemptToJoinExistingGroup()):(pe(this,le,!0),this.ws.send(JSON.stringify([se.oU.Create.NAME,Object.freeze({groupName:this.in.groupName.value,passphrase:this.in.passphrase.value})])))};this.in.passphrase.addEventListener("keydown",(t=>{t.isTrusted&&"Enter"===t.key&&e()}))}_attemptToJoinExistingGroup(){this.ws.send(JSON.stringify([se.oU.TryJoin.NAME,{groupName:this.in.groupName.value,passphrase:this.in.passphrase.value,userInfo:i.getLastUserInfo()}]))}}oe=new WeakMap,le=new WeakMap,ce=new WeakMap;const me=ie.State;Object.freeze(ue),Object.freeze(ue.prototype);class ve extends H{_abstractLazyLoad(){super._abstractLazyLoad(),Object.freeze(this),this.nav.next.textContent="Start Game",this.nav.next.onclick=e=>{const t=this.parseArgsFromGui();this.top.clientIsGroupHost&&this.top.webSocket.send(JSON.stringify([se.m4.CREATE_GAME,t]))}}}Object.freeze(ve),Object.freeze(ve.prototype);var Ee,be=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},Oe=(e,t,s)=>(be(e,t,"read from private field"),s?s.call(e):t.get(e)),fe=(e,t,s,a)=>(be(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);const ge=class extends m{constructor(){super(...arguments),this.players=new Map,this.teamsElem=r.R.html("div",["_2eDnztFQPAJnFHoqcX6Rt8"]),this.teamElems=new Map,Ee.set(this,void 0)}get ws(){return this.top.webSocket}_abstractLazyLoad(){this.baseElem.classList.add("_1RjcsAfyK_99UIm77cgsi1"),this._createInputs(),fe(this,Ee,(e=>{const[t,...s]=JSON.parse(e.data);switch(t){case se.m4.UserInfo.NAME:this._onUserInfoChange(s[0])}})),Object.freeze(this),this.nav.prev.textContent="Return To Joiner",this.baseElem.appendChild(this.teamsElem),r.R.propNoWrite(this,"players","teamsElem","teamElems","in");{const e=this.nav.next;e.textContent="Setup Game",e.onclick=()=>{this.requestGoToScreen(m.Id.SETUP_ONLINE,void 0)},this.baseElem.appendChild(e)}}_createInputs(){const e=r.R.html("div",[a.General.Class.INPUT_GROUP,"_2hDNOGQoaqlmP3PIE18QwQ"]),t=r.R.html("input",[a.General.Class.INPUT_GROUP_ITEM],{type:"text",minLength:1,maxLength:n.J5.Username.MAX_LENGTH,pattern:n.J5.Username.REGEXP.source,spellcheck:!1,value:this.top.storage.Local.username,onchange:this._submitInputs.bind(this)});e.appendChild(t);const s=r.R.html("input",[a.General.Class.INPUT_GROUP_ITEM],{type:"number",min:"0",max:"0",step:"1",value:"0",onchange:this._submitInputs.bind(this)});s.classList.add(),e.appendChild(s);const i=r.R.html("select");this.in=Object.freeze({username:t,teamId:s,avatar:i}),this.baseElem.appendChild(e)}_submitInputs(){if(!this.in.username.validity.valid||!this.in.teamId.validity.valid)return;const e=this.top.storage.Local;e.username=this.in.username.value,e.avatar=this.in.avatar.value;const t={username:this.in.username.value,teamId:parseInt(this.in.teamId.value),avatar:n.J5.Avatar.GET_RANDOM()};this.ws.send(JSON.stringify([se.m4.UserInfo.NAME,t]))}async _abstractOnBeforeEnter(e,t){"forward"===e&&(this.nav.next.disabled=!this.top.clientIsGroupHost,this.players.clear(),this.teamElems.clear(),this.teamsElem.textContent="",this._submitInputs(),this.ws.addEventListener("message",Oe(this,Ee)))}getRecommendedFocusElem(){let e=this.in.username.validity.valid?this.in.teamId.validity.valid?void 0:this.in.teamId:this.in.username;return void 0===e&&(e=this.top.clientIsGroupHost?this.nav.next:this.in.teamId),e}_abstractOnBeforeLeave(e){return e===m.NavDir.BACKWARD&&this.ws.removeEventListener("message",Oe(this,Ee)),!0}_onUserInfoChange(e){Object.freeze(Object.entries(e)).forEach((([e,t])=>{const s=this.players.get(e);if(!s||1!==this.teamElems.get(s.teamId).childElementCount||null!==t&&t.teamId===s.teamId||(this.teamElems.get(s.teamId).remove(),this.teamElems.delete(s.teamId)),t&&!this.teamElems.has(t.teamId)){const e=r.R.html("div",["_1OhAwynz14tlCVrxxglqWC"]);this.teamElems.set(t.teamId,e),e.onclick=e=>{this.in.teamId.value=t.teamId.toString()},this.teamsElem.appendChild(e)}if(null===t)s.base.remove(),this.players.delete(e);else if(void 0===s){const s=new ge.UserInfo(t);this.players.set(e,s),this.teamElems.get(t.teamId).appendChild(s.base)}else s.update(t)})),this.in.teamId.max=Object.keys(this.players).length.toString()}};let _e=ge;var Se,ye,Ne,Te;Ee=new WeakMap,Se=_e||(_e={}),ye=new WeakMap,Ne=new WeakMap,Te=new WeakMap,Se.UserInfo=class{constructor(e){ye.set(this,void 0),Ne.set(this,void 0),Te.set(this,void 0),this.base=r.R.html("div",["_2jAbJY6xTuqckSRVnOPwG4"]);const t=()=>{const e=r.R.html("div");return this.base.appendChild(e),e};this.el=Object.freeze({username:t(),teamId:t(),avatar:t()}),this.el.username.classList.add("_3esbSTakuS113N38hp7-V4"),this.username=e.username,this.teamId=e.teamId,r.R.propNoWrite(this,"base","el")}update(e){this.username=e.username,this.teamId=e.teamId,this.avatar=e.avatar}get username(){return Oe(this,ye)}set username(e){this.el.username.textContent=e,fe(this,ye,e)}get teamId(){return Oe(this,Ne)}set teamId(e){this.el.teamId.textContent=e.toString(),fe(this,Ne,e)}get avatar(){return Oe(this,Te)}set avatar(e){fe(this,Te,e),this.el.avatar}},r.R.protoNoEnum(_e,"_createInputs","_submitInputs"),Object.freeze(_e),Object.freeze(_e.prototype);var Ie,Le=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},Re=(e,t,s)=>(Le(e,t,"read from private field"),s?s.call(e):t.get(e));class we extends ee{constructor(){super(...arguments),this._askConfirmBeforeLeave=!1,this._wantsAutoPlayPause=!1,Ie.set(this,void 0)}get ws(){return this.top.webSocket}_abstractLazyLoad(){var e,t;super._abstractLazyLoad(),Object.freeze(this),this.nav.prev.innerHTML="Back&nbsp;To Lobby",t=e=>{const[t,...s]=JSON.parse(e.data);switch(t){case se.JD.UNPAUSE:this._statusBecomePlaying();break;case se.JD.PAUSE:this._statusBecomePaused();break;case se.JD.RETURN_TO_LOBBY:void 0===s[0]&&this.nav.prev.click();break;default:this.currentGame.wsMessageCb(e)}},Le(this,e=Ie,"write to private field"),e.set(this,t),Object.seal(this)}_abstractOnBeforeLeave(e){const t=super._abstractOnBeforeLeave(e);return t&&void 0!==this.ws&&(this.ws.send(JSON.stringify([se.JD.RETURN_TO_LOBBY])),this.ws.removeEventListener("message",Re(this,Ie))),t}_reqStatusPlaying(){this.ws.send(JSON.stringify([se.JD.UNPAUSE]))}_reqStatusPaused(){this.ws.send(JSON.stringify([se.JD.PAUSE]))}async _createNewGame(e){const[t,a]=e,r=new((await Promise.all([s.e(68),s.e(399),s.e(775)]).then(s.bind(s,885))).OnlineGame)(this.top.webSocket,this._onGameBecomeOver.bind(this),t,a);return this.ws.addEventListener("message",Re(this,Ie)),Promise.resolve(r)}}Ie=new WeakMap,Object.freeze(we),Object.freeze(we.prototype);var Ce,Pe,Ge=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},Ae=(e,t,s)=>(Ge(e,t,"read from private field"),s?s.call(e):t.get(e)),Ue=(e,t,s,a)=>(Ge(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);class je{constructor(e,t){Ce.set(this,void 0),Pe.set(this,void 0),Ue(this,Pe,e.transition),t.setAttribute("role","presentation");const s=m.Id,a=Object.freeze({toplevel:e,parentElem:t,goToScreen:Object.freeze(this.goToScreen.bind(this))});this.dict=Object.freeze({[s.HOME]:new E(a,s.HOME),[s.HOW_TO_PLAY]:new b(a,s.HOW_TO_PLAY),[s.HOW_TO_HOST]:new O(a,s.HOW_TO_HOST),[s.SETTINGS]:new j(a,s.SETTINGS),[s.SETUP_OFFLINE]:new F(a,s.SETUP_OFFLINE),[s.PLAY_OFFLINE]:new te(a,s.PLAY_OFFLINE),[s.GROUP_JOINER]:new ue(a,s.GROUP_JOINER),[s.SETUP_ONLINE]:new ve(a,s.SETUP_ONLINE),[s.GROUP_LOBBY]:new _e(a,s.GROUP_LOBBY),[s.PLAY_ONLINE]:new we(a,s.PLAY_ONLINE)}),r.R.propNoWrite(this,"dict"),Object.seal(this);const i=m.NavTree[window.location.hash.slice(1)];window.setTimeout((()=>{var e;this.goToScreen(null!=(e=null==i?void 0:i.href)?e:m.Id.HOME,void 0)})),window.addEventListener("popstate",(e=>{this.goToScreen(window.history.state.screenId,{})}))}async goToScreen(e,t){const s=this.currentScreen,a=this.dict[e];if(s===a)throw new Error("never");const r=m.GET_NAV_DIR({curr:null==s?void 0:s.screenId,dest:e});return!(void 0!==s&&!s._leave(r)||(await Ae(this,Pe).do({whileBeforeUnblur:a._enter(r,t),beforeUnblur:()=>{var t;switch(e){case m.Id.GROUP_JOINER:this.dict[m.Id.GROUP_LOBBY].lazyLoad()}null==s||s._onAfterLeave(),a._onAfterEnter(),null==(t=a.getRecommendedFocusElem())||t.focus()}}),Ue(this,Ce,a),0))}get currentScreen(){return Ae(this,Ce)}}Ce=new WeakMap,Pe=new WeakMap,Object.freeze(je),Object.freeze(je.prototype);var ze,Me=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},ke=(e,t,s)=>(Me(e,t,"read from private field"),s?s.call(e):t.get(e));class xe{constructor(){this.baseElem=document.getElementById(a.Screen.Id.SCREEN_TINT),ze.set(this,Promise.resolve()),this.baseElem.tabIndex=-1,this.baseElem.addEventListener("keydown",(e=>{e.preventDefault()}),{capture:!0}),r.R.propNoWrite(this,"baseElem"),Object.seal(this)}do(e){var t,s,a;return t=this,s=ze,a=ke(this,ze).then((()=>this._atomicDo(e))),Me(t,s,"write to private field"),s.set(t,a),ke(this,ze)}async _atomicDo(e){const t=document.activeElement;this.baseElem.focus();const s=this.baseElem.style;await this._cssTransition((function(){s.pointerEvents="all",s.opacity="1.0"})),void 0!==e.intermediateTransitionTrigger&&await this._cssTransition((()=>{e.intermediateTransitionTrigger()})),await e.whileBeforeUnblur,t instanceof HTMLElement&&t.focus(),void 0!==e.beforeUnblur&&e.beforeUnblur(),await this._cssTransition((function(){s.pointerEvents="none",s.opacity="0.0"})),this.baseElem.blur()}_cssTransition(e){return new Promise((t=>{this.baseElem.addEventListener("transitionend",(()=>t()),{once:!0}),e()}))}}ze=new WeakMap,r.R.protoNoEnum(xe,"_atomicDo","_cssTransition"),Object.freeze(xe),Object.freeze(xe.prototype);var De,We,Be=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},He=(e,t,s)=>(Be(e,t,"read from private field"),s?s.call(e):t.get(e)),Fe=(e,t,s,a)=>(Be(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);const Je=class{constructor(){De.set(this,void 0),We.set(this,void 0),this.defaultDocTitle=document.title,this.siteServerType=window.location.hostname.match(/github\.io/)?Je.SiteServerType.GITHUB:window.location.protocol.startsWith("file")?Je.SiteServerType.FILESYSTEM:Je.SiteServerType.DEDICATED,r.R.propNoWrite(this,"defaultDocTitle","siteServerType"),this.storage=i,Fe(this,We,void 0),this.transition=new xe,r.R.propNoWrite(this,"storage","transition");const e=document.getElementById(a.Screen.Id.ALL_SCREENS);if(!e)throw new Error("never");r.R.Web.prependComment(e,"ALL SCREENS CONTAINER"),Fe(this,De,new je(this,e)),r.R.propNoWrite(this),Object.seal(this)}get webSocket(){return He(this,We)}setWebSocket(e){void 0!==this.webSocket&&this.webSocket.close(),Fe(this,We,e)}get clientIsGroupHost(){return He(this,De).dict["group-joiner"].isHost}toast(e){console.info(e)}confirm(e){return window.confirm(e)}get game(){var e;return null!=(e=He(this,De).dict["play-offline"].probeCurrentGame)?e:He(this,De).dict["play-online"].probeCurrentGame}get currentScreen(){return He(this,De).currentScreen}};let qe=Je;De=new WeakMap,We=new WeakMap,function(e){let t;var s;(s=t=e.SiteServerType||(e.SiteServerType={})).GITHUB="github",s.FILESYSTEM="filesystem",s.DEDICATED="dedicated",e.SiteServerTypeSuggestedGameServer=r.R.deepFreeze({[t.GITHUB]:void 0,[t.FILESYSTEM]:{value:"ws://localhost",description:"dev shortcut :)"},[t.DEDICATED]:{value:(()=>{var e;try{const t=new URL(null!=(e=window.location.origin)?e:"");return t.protocol="ws",t.toString()}catch(e){return}})(),description:"this page's server"}})}(qe||(qe={})),Object.freeze(qe),Object.freeze(qe.prototype);const Ve=new qe,Ye=void 0;function Ke(){return Ve.currentScreen}function Xe(){return Ve.game}console.info("%cü©∫ welcome! üêç","font:700 2.3em /1.5 monospace; margin:0.4em; border:0.3em solid black;padding:0.4em; color:white; background-color:#3f5e77; border-radius:0.7em;")},741:()=>{var e;Object.defineProperties(Array.prototype,{freeze:{value:function(){return Object.freeze(this)},enumerable:!0},seal:{value:function(){return Object.seal(this)},enumerable:!0}}),["Object","String","Number","RegExp","Date","Array","Map","Set","WeakMap","WeakSet","URL","HTMLElement","HTMLDivElement","HTMLSpanElement","HTMLPreElement","HTMLButtonElement","HTMLInputElement","HTMLSelectElement","HTMLOptionElement","HTMLScriptElement","HTMLStyleElement","HTMLLinkElement","HTMLAnchorElement","HTMLDocument","HTMLIFrameElement","HTMLCanvasElement"].forEach((e=>{Object.defineProperty(globalThis,e,{enumerable:!0,writable:!1,configurable:!1}),Object.freeze(globalThis[e]),Object.freeze(globalThis[e].prototype)})),window.addEventListener("onbeforeunload",(()=>{})),e="translate","translate"in Element.prototype||Object.defineProperty(Element.prototype,"translate",{configurable:!1,get:function(){return this.getAttribute(e)},set:function(t){this.setAttribute(e,t)}})},649:(e,t,s)=>{var a={"./murky-dive.css":85,"./smooth-stone.css":557};function r(e){return i(e).then(s)}function i(e){return s.e(122).then((()=>{if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}))}r.keys=()=>Object.keys(a),r.resolve=i,r.id=649,e.exports=r}},e=>{"use strict";var t=(88,e(e.s=88));capswalk=t}]);
//# sourceMappingURL=index.js.map