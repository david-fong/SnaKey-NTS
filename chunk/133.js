(self.webpackChunksnakey3=self.webpackChunksnakey3||[]).push([[133],{157:(e,t,r)=>{"use strict";var s;r.d(t,{u:()=>s}),function(e){let t;!function(e){e.EUCLID2="EUCLID2",e.BEEHIVE="BEEHIVE"}(t=e.System||(e.System={})),e.equals=function(e,t){return e._equals(t)}}(s||(s={})),Object.freeze(s)},110:(e,t,r)=>{"use strict";r.d(t,{r:()=>a});var s=r(632),i=r(983);class a{constructor(e){Object.defineProperty(this,"static",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tile",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.static=e.gridClass,this.dimensions=e.dimensions,this.tile=new i.N(this),s.R.propNoWrite(this,"static","dimensions","tile")}get area(){return this.static.getArea(this.dimensions)}reset(){this.forEachTile((e=>e.reset()))}getDestsFromSourcesTo(e){return Array.from(new Set(this.tile.sourcesTo(e).get.flatMap((e=>this.tile.destsFrom(e.coord).get))))}getRandomCoord(){return this.static.getRandomCoord(this.dimensions)}}!function(e){e.getImplementation=t=>e._Constructors[t]}(a||(a={}))},983:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});var s,i=r(903);class a{constructor(e){s.set(this,void 0),(0,i.YH)(this,s,e),Object.freeze(this)}get _source(){return(0,i.Q_)(this,s)}at(...e){return(0,i.Q_)(this,s)._getTileAt(...e)}destsFrom(...e){return new o((0,i.Q_)(this,s)._getTileDestsFrom(...e))}sourcesTo(...e){return new o((0,i.Q_)(this,s)._getTileSourcesTo(...e))}}s=new WeakMap,Object.freeze(a),Object.freeze(a.prototype);class o{constructor(e){Object.defineProperty(this,"contents",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.seal(this)}get occupied(){return this.contents=this.contents.filter((e=>e.isOccupied)),this}get unoccupied(){return this.contents=this.contents.filter((e=>!e.isOccupied)),this}get get(){return this.contents}}Object.freeze(o),Object.freeze(o.prototype)},254:(e,t,r)=>{"use strict";r.d(t,{v:()=>s});var s,i=r(632),a=r(110);!function(e){class t{constructor(e){Object.defineProperty(this,"dash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dash=e.dash,this.bash=e.bash,Object.freeze(this)}_equals(e){return this.dash===e.dash&&this.bash===e.bash}round(){const e=Math.floor(this.dash),r=Math.floor(this.bash),s=e-this.dash,i=r-this.bash;return s>2*i?new t({dash:e+1,bash:r}):s<.5*i?new t({dash:e,bash:r+1}):Math.min(s,i)>.5?new t({dash:e+1,bash:r+1}):new t({dash:e,bash:r})}add(e){return new t({dash:this.dash+e.dash,bash:this.bash+e.bash})}sub(e){return new t({dash:this.dash-e.dash,bash:this.bash-e.bash})}mul(e){return new t({dash:e*this.dash,bash:e*this.bash})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);class r extends a.r{constructor(e){super(e),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.grid=Object.freeze(void 0)}static getAmbiguityThreshold(){return 18}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e){let t=0;for(const r of this.grid)for(const s of r)e(s,t++)}shuffledForEachTile(e){this.grid.flat().sort(((e,t)=>Math.random()-.5)).forEach((t=>e(t)))}getUntToward(e,t){}getUntAwayFrom(e,t){return this.getUntToward(t.add(t.sub(e)),t)}getRandomCoordAround(e,t){}_getTileAt(e){}_getTileDestsFrom(e,t=1){}_getTileSourcesTo(e,t=1){}minMovesFromTo(e,t){}getDestsFromSourcesTo(e){return this._getTileDestsFrom(e,2)}static getSpawnCoords(e,t){}static getArea(e){const t=Math.min(e.fslash,e.bslash),r=Math.max(e.fslash,e.bslash),s=-1+e.dash+t;let i=2*t*(e.dash+s);return i+=(r-t-1)*s,i}static getDiameterOfLatticePatchHavingArea(e){if(e<.25)throw new RangeError("determinant of a radical will be strictly negative.");return 1+(-3+Math.sqrt(9-12*(1-e)))/6*2}static getRandomCoord(e){return new t(void 0)}}Object.defineProperty(r,"SIZE_LIMITS",{enumerable:!0,configurable:!0,writable:!0,value:Object.freeze({dash:Object.freeze({min:10,max:50}),bslash:Object.freeze({min:10,max:50}),fslash:Object.freeze({min:10,max:50})})}),e.Grid=r,i.R.protoNoEnum(r,"_getTileAt","_getTileDestsFrom","_getTileSourcesTo"),Object.freeze(r),Object.freeze(r.prototype)}(s||(s={})),Object.freeze(s)},692:(e,t,r)=>{"use strict";r.d(t,{i:()=>s});var s,i=r(632),a=r(110);!function(e){class t{constructor(e){Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.x=e.x,this.y=e.y,Object.freeze(this)}_equals(e){return this.x===e.x&&this.y===e.y}round(){return new t({x:Math.round(this.x),y:Math.round(this.y)})}oneNorm(e){return this.sub(e).originOneNorm()}originOneNorm(){return Math.abs(this.x)+Math.abs(this.y)}infNorm(e){return this.sub(e).originInfNorm()}originInfNorm(){return Math.max(Math.abs(this.x),Math.abs(this.y))}axialAlignment(e){return this.sub(e).originAxialAlignment()}originAxialAlignment(){return Math.abs(Math.abs(this.x)-Math.abs(this.y))/(Math.abs(this.x)+Math.abs(this.y))}add(e){return new t({x:this.x+e.x,y:this.y+e.y})}sub(e){return new t({x:this.x-e.x,y:this.y-e.y})}mul(e){return new t({x:e*this.x,y:e*this.y})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);class r extends a.r{constructor(e){super(e),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const r=[];for(let s=0;s<this.dimensions.height;s++){const i=[];for(let r=0;r<this.dimensions.width;r++){const a=new e.tileClass(new t({x:r,y:s}));i.push(a)}r.push(Object.freeze(i))}this.grid=Object.freeze(r)}static getAmbiguityThreshold(){return 24}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e){let t=0;for(const r of this.grid)for(const s of r)e(s,t++)}shuffledForEachTile(e){this.grid.flat().sort(((e,t)=>Math.random()-.5)).forEach((t=>e(t)))}getUntToward(e,t){const r=this.tile.destsFrom(t).unoccupied.get;if(0===r.length)return this.tile.at(t);if(1===r.length)return r[0];r.sort(((t,r)=>t.coord.oneNorm(e)-r.coord.oneNorm(e))).sort(((t,r)=>t.coord.infNorm(e)-r.coord.infNorm(e)));const s=r[0];for(let t=1;t<r.length;t++)if(r[t].coord.infNorm(e)>s.coord.infNorm(e)){r.splice(t);break}if(1===r.length)return r[0];if(s.coord.x-t.x==0||s.coord.y-t.y==0){if(t.axialAlignment(t.sub(e))-.5>0)return s;r.shift()}return r[Math.floor(r.length*Math.random())]}getUntAwayFrom(e,t){return this.getUntToward(t.add(t.sub(e)),t)}getDestsFromSourcesTo(e){return this._getTileDestsFrom(e,2)}getRandomCoordAround(e,r){return new t({x:e.x+Math.trunc(2*r*(Math.random()-.5)),y:e.y+Math.trunc(2*r*(Math.random()-.5))})}_getTileAt(e){return this.grid[e.y][e.x]}_getTileDestsFrom(e,t=1){let r=e.y-t,s=e.y+t+1,i=e.x-t,a=e.x+t+1;return r>=this.dimensions.height||s<0||i>=this.dimensions.width||a<0?[]:this.grid.slice(Math.max(0,r),Math.min(this.dimensions.height,s)).flatMap((e=>e.slice(Math.max(0,i),Math.min(this.dimensions.width,a))))}_getTileSourcesTo(e,t=1){return this._getTileDestsFrom(e,t)}minMovesFromTo(e,t){return Math.min(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}static getSpawnCoords(e,t){const s=[];return e.map((e=>{const i=[];for(;e>0;){let a;do{a=r.getRandomCoord(t)}while(s.find((e=>a._equals(e))));i.push(a),s.push(a),e--}return i}))}static getArea(e){return e.height*e.width}static getDiameterOfLatticePatchHavingArea(e){return Math.sqrt(e)}static getRandomCoord(e){const r=Math.floor(e.width*Math.random()),s=Math.floor(e.height*Math.random());return new t({x:r,y:s})}}Object.defineProperty(r,"SIZE_LIMITS",{enumerable:!0,configurable:!0,writable:!0,value:Object.freeze({height:Object.freeze({min:11,max:51}),width:Object.freeze({min:11,max:51})})}),e.Grid=r,i.R.protoNoEnum(r,"_getTileAt","_getTileDestsFrom","_getTileSourcesTo"),Object.freeze(r),Object.freeze(r.prototype)}(s||(s={})),Object.freeze(s)},364:(e,t,r)=>{"use strict";var s;r.d(t,{L:()=>s}),function(e){e.EVENT_ID_REJECT=-1}(s||(s={})),Object.freeze(s)},753:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});var s,i=r(364);!function(e){e.INITIAL_REQUEST_ID=-1,e.EVENT_NAME=Object.freeze({BUBBLE:"player-bubble",MOVEMENT:"player-movement"});class t{constructor(e,t){Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:i.L.EVENT_ID_REJECT}),Object.defineProperty(this,"playerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"playerLastAcceptedRequestId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"affectedNeighbours",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.playerId=e,this.playerLastAcceptedRequestId=t}}e.Bubble=t,e.Movement=class extends t{constructor(e,t,r,s){super(e,t),Object.defineProperty(this,"newPlayerHealth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"destModDesc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tileHealthModDescs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"playerHealthModDescs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.destModDesc={coord:r.coord,lastKnownUpdateId:r.lastKnownUpdateId},this.moveType=s}}}(s||(s={})),Object.freeze(s)},688:(e,t,r)=>{"use strict";r.d(t,{R:()=>f});var s,i,a,o,n=r(903),l=r(825),h=r(364),c=(r(753),r(632)),d=r(532),u=r(477),m=r(87);class p{constructor(e,t,r){Object.defineProperty(this,"gameType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),s.set(this,void 0),Object.defineProperty(this,"langFrontend",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"players",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"operators",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.set(this,void 0),Object.defineProperty(this,"teams",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.set(this,void 0),Object.defineProperty(this,"_playerStatusCtor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.gameType=e;const o=this._getGridImplementation(r.coordSys);this.grid=new o({gridClass:o,tileClass:t.tileClass,coordSys:r.coordSys,dimensions:r.gridDimensions}),(0,n.YH)(this,s,t.onGameBecomeOver),this.langFrontend=d.Uo.GET_FRONTEND_DESC_BY_ID(r.langId),this._playerStatusCtor=t.playerStatusCtor,this.players=this.createPlayers(r),this.operators=Object.freeze(this.players.filter((e=>e.isALocalOperator)));{const e=[];if(this.players.forEach((t=>{e[t.teamId]||(e[t.teamId]=[]),e[t.teamId].push(t)})),this.teams=e.map(((e,t)=>new m.S(t,e))),this.teams.every((e=>e.id===m.S.ElimOrder.IMMORTAL)))throw new Error("All teams are immortal. The game will never end.")}c.R.propNoWrite(this,"gameType","grid","langFrontend","players","operators","teams","_playerStatusCtor"),this.players.forEach((e=>e._afterAllPlayersConstruction())),this.setCurrentOperator(0)}reset(){return(0,n.mG)(this,void 0,void 0,(function*(){this.grid.reset(),(0,n.YH)(this,a,l.l.Status.PAUSED)}))}createPlayers(e){const t=e.playerDescs=this.gameType===l.l.Type.ONLINE?e.playerDescs:u.J5.CtorArgs.finalize(e.playerDescs);return Object.freeze(t.map((e=>e.familyId===u.J5.Family.HUMAN?e.isALocalOperator?this._createOperatorPlayer(e):new u.J5(this,e):this._createArtifPlayer(e))))}serializeResetState(){const e=[],t=this.players.map((e=>e.coord)),r=[];this.grid.forEachTile((t=>{t.lastKnownUpdateId++,e.push({char:t.langChar,seq:t.langSeq}),t.freeHealth&&r.push({coord:t.coord,health:t.freeHealth})}));const s={csps:e,playerCoords:t,healthCoords:r};return c.R.deepFreeze(s),s}deserializeResetState(e){c.R.deepFreeze(e),this.grid.forEachTile(((t,r)=>{t.setLangCharSeqPair(e.csps[r]),t.lastKnownUpdateId++})),e.playerCoords.forEach(((e,t)=>{this.players[t].reset(this.grid.tile.at(e))})),e.healthCoords.forEach((e=>{this.grid.tile.at(e.coord).freeHealth=e.health}))}get currentOperator(){return(0,n.Q_)(this,i)}setCurrentOperator(e){const t=this.operators[e];if(void 0===t)throw new Error("never");this.currentOperator!==t&&(t._notifyWillBecomeCurrent(),(0,n.YH)(this,i,t))}get status(){return(0,n.Q_)(this,a)}statusBecomePlaying(){if(this.status!==l.l.Status.PLAYING){if(this.status!==l.l.Status.PAUSED)throw new Error("Can only resume a game that is currently paused.");this.players.forEach((e=>{e._notifyGameNowPlaying()})),(0,n.YH)(this,a,l.l.Status.PLAYING)}else console.info("[statusBecomePlaying]: Game is already playing")}statusBecomePaused(){this.status!==l.l.Status.PAUSED?this.status!==l.l.Status.OVER&&(this.players.forEach((e=>{e._notifyGameNowPaused()})),(0,n.YH)(this,a,l.l.Status.PAUSED)):console.info("[statusBecomePaused]: Game is already paused")}statusBecomeOver(){this.status!==l.l.Status.OVER&&(this.players.forEach((e=>{e._notifyGameNowOver()})),(0,n.YH)(this,a,l.l.Status.OVER),(0,n.Q_)(this,s).call(this),console.info("game is over!"))}}s=new WeakMap,i=new WeakMap,a=new WeakMap,Object.freeze(p),Object.freeze(p.prototype);class f extends p{constructor(e,t,r){super(e,t,r),Object.defineProperty(this,"eventRecordBitmap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o.set(this,void 0),this.eventRecordBitmap=[],c.R.propNoWrite(this,"eventRecordBitmap")}reset(){const e=super.reset();return this.eventRecordBitmap.fill(!1,0,l.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH),(0,n.YH)(this,o,0),e}get nextUnusedEventId(){return(0,n.Q_)(this,o)}_recordEvent(e){const t=e.eventId,r=t%l.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH;this.eventRecordBitmap[r]=!0,this.eventRecordBitmap[(t+l.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH-l.l.K.EVENT_RECORD_FORWARD_WINDOW_LENGTH)%l.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH]=!1,(0,n.YH)(this,o,+(0,n.Q_)(this,o)+1)}executeTileModEvent(e,t=!0){c.R.deepFreeze(e);const r=this.grid.tile.at(e.coord);return r.lastKnownUpdateId>e.lastKnownUpdateId||(e.newCharSeqPair&&(r.setLangCharSeqPair(e.newCharSeqPair),t&&this.operators.filter((e=>e.tile.destsFrom().get.includes(r))).forEach((e=>e.seqBufferAcceptKey("")))),r.lastKnownUpdateId=e.lastKnownUpdateId,r.freeHealth=e.newFreeHealth),r}executePlayerMoveEvent(e){var t;c.R.deepFreeze(e);const r=this.players[e.playerId],s=e.playerLastAcceptedRequestId-r.lastAcceptedRequestId;if(e.eventId===h.L.EVENT_ID_REJECT)return void(0===s&&(r.requestInFlight=!1));this._recordEvent(e);const i=this.executeTileModEvent(e.destModDesc,r!==this.currentOperator);if(null===(t=e.tileHealthModDescs)||void 0===t||t.forEach((e=>{this.executeTileModEvent(e)})),!(s>1)){if(r.requestInFlight=!1,!(r===this.currentOperator?1===s:s<=1))throw new RangeError("never");r.status.health=e.newPlayerHealth.health,r.moveTo(i),r.lastAcceptedRequestId=e.playerLastAcceptedRequestId}}executePlayerBubbleEvent(e){this.players[e.playerId].requestInFlight=!1,e.eventId!==h.L.EVENT_ID_REJECT&&this._recordEvent(e)}}o=new WeakMap,c.R.protoNoEnum(f,"nextUnusedEventId","_recordEvent"),Object.freeze(f),Object.freeze(f.prototype)},477:(e,t,r)=>{"use strict";r.d(t,{J5:()=>c});var s,i=r(632),a=(r(825),r(753)),o=r(903),n=r(532),l=r(983);class h extends n.J5{constructor(e,t){if(super(),Object.defineProperty(this,"playerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isALocalOperator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"game",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),s.set(this,void 0),Object.defineProperty(this,"tile",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Math.trunc(t.playerId)!==t.playerId)throw new RangeError("Player ID's must be integer values.");this.playerId=t.playerId,this.isALocalOperator=t.isALocalOperator,this.game=e,this.status=new this.game._playerStatusCtor(this,t.noCheckGameOver),this.tile=new l.N(new h.TileGetterSource(this)),i.R.instNoEnum(this,"game"),i.R.propNoWrite(this,"playerId","isALocalOperator","game","status","tile")}_afterAllPlayersConstruction(){this.status._afterAllPlayersConstruction()}reset(e){(0,o.YH)(this,s,e),this.hostTile._setOccupant(this.playerId,this.status.immigrantInfo)}get coord(){return this.hostTile.coord}get hostTile(){return(0,o.Q_)(this,s)}moveTo(e){this.hostTile.occupantId!==this.playerId||this.hostTile.evictOccupant(),e.isOccupied||((0,o.YH)(this,s,e),e._setOccupant(this.playerId,this.status.immigrantInfo))}}s=new WeakMap,function(e){var t,r;class s{constructor(e){t.set(this,void 0),r.set(this,void 0),(0,o.YH)(this,t,e),(0,o.YH)(this,r,e.game.grid.tile._source)}_getTileAt(){return(0,o.Q_)(this,r)._getTileAt((0,o.Q_)(this,t).coord)}_getTileDestsFrom(){return(0,o.Q_)(this,r)._getTileDestsFrom((0,o.Q_)(this,t).coord)}_getTileSourcesTo(){return(0,o.Q_)(this,r)._getTileSourcesTo((0,o.Q_)(this,t).coord)}}t=new WeakMap,r=new WeakMap,e.TileGetterSource=s,Object.freeze(s),Object.freeze(s.prototype)}(h||(h={})),i.R.protoNoEnum(h,"_afterAllPlayersConstruction"),Object.freeze(h),Object.freeze(h.prototype),r(865);class c extends h{constructor(e,t){var r;super(e,t),Object.defineProperty(this,"familyId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"teamId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"username",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"avatar",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lastAcceptedRequestId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestInFlight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.familyId=t.familyId,this.teamId=t.teamId,this.username=t.username,this.avatar=null!==(r=t.avatar)&&void 0!==r?r:c.Avatar.GET_RANDOM(),i.R.propNoWrite(this,"familyId","teamId","username","avatar")}reset(e){super.reset(e),this.status.reset(),this.lastAcceptedRequestId=a.a.INITIAL_REQUEST_ID,this.requestInFlight=!1}_notifyGameNowPlaying(){}_notifyGameNowPaused(){}_notifyGameNowOver(){}makeMovementRequest(e,t){this.requestInFlight=!0,this.game.processMoveRequest(new a.a.Movement(this.playerId,this.lastAcceptedRequestId,e,t))}get team(){return this.game.teams[this.teamId]}isTeamedWith(e){return this.team.members.includes(e)}}!function(e){let t;!function(e){e.finalize=function(e){const t=Array.from(new Set(e.map((e=>e.teamId)))).sort(((e,t)=>e-t)).reduce(((e,t,r)=>(e[t]=r,e)),[]);return e.slice().sort(((e,r)=>t[e.teamId]-t[r.teamId])).map(((e,r)=>Object.assign({},e,{playerId:r,teamId:t[e.teamId]})))}}(t=e.CtorArgs||(e.CtorArgs={})),Object.freeze(t)}(c||(c={})),i.R.protoNoEnum(c,"_notifyGameNowPaused","_notifyGameNowPlaying","_notifyGameNowOver"),Object.freeze(c),Object.freeze(c.prototype)},865:(e,t,r)=>{"use strict";r.d(t,{c:()=>n});var s,i=r(903),a=r(632),o=r(87);class n{constructor(e,t){Object.defineProperty(this,"player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"noCheckGameOver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),s.set(this,void 0),this.player=e,this.noCheckGameOver=t,a.R.instNoEnum(this,"player")}reset(){this.health=0}_afterAllPlayersConstruction(){}get immigrantInfo(){}get health(){return(0,i.Q_)(this,s)}set health(e){const t=this.isDowned;if((0,i.YH)(this,s,e),t||!this.isDowned||this.noCheckGameOver)return;const r=this.player.team,a=this.player.game.teams;if(r.elimOrder===o.S.ElimOrder.STANDING&&r.members.every((e=>e.status.noCheckGameOver||e.status.isDowned))){const e=1+a.filter((e=>e.elimOrder!==o.S.ElimOrder.STANDING)).length;r.elimOrder=1+a.filter((e=>e.elimOrder!==o.S.ElimOrder.STANDING&&e.elimOrder!==o.S.ElimOrder.IMMORTAL)).length,e===a.length&&this.player.game.statusBecomeOver()}}get isDowned(){return this.health<0}}s=new WeakMap,a.R.protoNoEnum(n,"_afterAllPlayersConstruction"),Object.freeze(n),Object.freeze(n.prototype)},87:(e,t,r)=>{"use strict";r.d(t,{S:()=>o});var s,i=r(903),a=r(632);class o{constructor(e,t){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"members",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),s.set(this,void 0),0===t.length)throw new Error("Teams must have at least one member.");this.id=e,this.members=t,(0,i.YH)(this,s,this.members.every((e=>e.status.noCheckGameOver))?o.ElimOrder.IMMORTAL:o.ElimOrder.STANDING),a.R.propNoWrite(this,"id","members")}reset(){this.elimOrder!==o.ElimOrder.IMMORTAL&&(this.elimOrder=o.ElimOrder.STANDING)}get elimOrder(){return(0,i.Q_)(this,s)}set elimOrder(e){if(this.elimOrder===o.ElimOrder.IMMORTAL)throw new TypeError("Cannot change the elimination status of an immortal team.");(0,i.YH)(this,s,e)}}s=new WeakMap,function(e){let t;!function(e){e.IMMORTAL=-1,e.STANDING=0}(t=e.ElimOrder||(e.ElimOrder={}))}(o||(o={})),Object.freeze(o),Object.freeze(o.prototype)},242:(e,t,r)=>{"use strict";r.d(t,{qM:()=>L,lA:()=>h.l,RQ:()=>l.R,J5:()=>w.J5,Ko:()=>A,gx:()=>f});var s,i,a,o,n,l=r(632),h=r(825),c=r(903),d=r(749),u=r(912),m=r(532);class p{constructor(e){Object.defineProperty(this,"coord",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),s.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),Object.defineProperty(this,"lastKnownUpdateId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.coord=e,l.R.propNoWrite(this,"coord"),(0,c.YH)(this,s,m.J5.Id.NULL)}reset(){this.evictOccupant(),this.lastKnownUpdateId=0,this.freeHealth=0,this.setLangCharSeqPair(m.Uo.CharSeqPair.NULL)}_setOccupant(e,t){(0,c.YH)(this,s,e)}get isOccupied(){return this.occupantId!==m.J5.Id.NULL}evictOccupant(){(0,c.YH)(this,s,m.J5.Id.NULL)}get occupantId(){return(0,c.Q_)(this,s)}get freeHealth(){return(0,c.Q_)(this,i)}set freeHealth(e){(0,c.YH)(this,i,e)}setLangCharSeqPair(e){(0,c.YH)(this,a,e.char),(0,c.YH)(this,o,e.seq)}get langChar(){return(0,c.Q_)(this,a)}get langSeq(){return(0,c.Q_)(this,o)}}s=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,Object.freeze(p),Object.freeze(p.prototype);class f extends p{constructor(e){super(e),n.set(this,void 0),Object.defineProperty(this,"langCharElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.YH)(this,n,l.R.mkEl("div",[u.Y.General.Class.CENTER_CONTENTS,u.Y.General.Class.STACK_CONTENTS,d.Z.this])).setAttribute("aria-label","Tile");{const e=l.R.mkEl("div",[d.Z.char]);e.setAttribute("role","presentation");const t=this.langCharElem=l.R.mkEl("div",[]);e.appendChild(t),(0,c.Q_)(this,n).appendChild(e)}l.R.propNoWrite(this,"langCharElem")}_addToDom(e){e.appendChild((0,c.Q_)(this,n))}_setOccupant(e,t){super._setOccupant(e,t),this.langCharElem.parentElement.insertAdjacentElement("beforebegin",t.playerElem)}set freeHealth(e){super.freeHealth=e,this.freeHealth>0?(0,c.Q_)(this,n).dataset[u.Y.Tile.Dataset.HEALTH]=this.freeHealth.toString():delete(0,c.Q_)(this,n).dataset[u.Y.Tile.Dataset.HEALTH]}get freeHealth(){return super.freeHealth}setLangCharSeqPair(e){super.setLangCharSeqPair(e),this.langCharElem.textContent=this.langChar}}n=new WeakMap,l.R.protoNoEnum(f,"_addToDom"),Object.freeze(f),Object.freeze(f.prototype);var b,g=r(601),y=r(415);!function(e){e.getImplementation=t=>e._Constructors[t]}(b||(b={}));class v{_superVisibleGrid(e,t){if(e.tileClass!==f)throw new TypeError("never");t.setAttribute("role","presentation"),t.translate=!1,t.spellcheck=!1;const r=(this.baseElem=l.R.mkEl("div",[g.Z["impl-body"]])).attachShadow({mode:"closed"});t.classList.add(g.Z["impl-body"]),r.appendChild(t),r.appendChild(l.R.mkEl("link",[],{rel:"stylesheet",href:"css-common.css"})),r.appendChild(l.R.mkEl("link",[],{rel:"stylesheet",href:"chunk/game-css.css"}));const s=l.R.mkEl("div",[y.Z["spotlight-short"]]),i=l.R.mkEl("div",[y.Z["spotlight-long"]]);this.spotlightElems=Object.freeze([s,i])}}Object.freeze(v),Object.freeze(v.prototype);var O,E,w=r(477),_=r(157);class T extends w.J5{constructor(e,t){super(e,t),O.set(this,void 0),E.set(this,void 0),Object.defineProperty(this,"prevCoord",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.YH)(this,E,this.game.langFrontend.remapFunc)}reset(e){super.reset(e),this.prevCoord=e.coord,(0,c.YH)(this,O,"")}processKeyboardInput(e){this.game.status===h.l.Status.PLAYING&&(this.requestInFlight||(" "===e.key?_.u.equals(this.coord,this.prevCoord)||this.makeMovementRequest(this.game.grid.getUntAwayFrom(this.prevCoord,this.coord),w.J5.MoveType.BOOST):1!==e.key.length||e.repeat||this.seqBufferAcceptKey(e.key)))}seqBufferAcceptKey(e){const t=this.tile.destsFrom().unoccupied.get;if(0!==t.length)if(e){e=(0,c.Q_)(this,E).call(this,e);for(let r=this.seqBuffer+e;r.length;r=r.substring(1)){const e=t.find((e=>e.langSeq.startsWith(r)));if(e)return(0,c.YH)(this,O,r),void(e.langSeq===r&&this.makeMovementRequest(e,w.J5.MoveType.NORMAL))}(0,c.YH)(this,O,""),this.status.visualBell()}else t.find((e=>e.langSeq.startsWith(this.seqBuffer)))||(0,c.YH)(this,O,"")}moveTo(e){(0,c.YH)(this,O,""),this.prevCoord=this.coord,super.moveTo(e)}_notifyWillBecomeCurrent(){this.status._notifyWillBecomeCurrent(this.game.grid.spotlightElems)}get seqBuffer(){return(0,c.Q_)(this,O)}}O=new WeakMap,E=new WeakMap,l.R.protoNoEnum(T,"_notifyWillBecomeCurrent"),Object.freeze(T),Object.freeze(T.prototype);var I,j,C,R=r(865);class A extends R.c{constructor(e,t){super(e,t),I.set(this,void 0),j.set(this,void 0),C.set(this,void 0),(0,c.YH)(this,I,l.R.mkEl("div",[u.Y.General.Class.CENTER_CONTENTS,u.Y.General.Class.STACK_CONTENTS,y.Z.this]));{const e=l.R.mkEl("div",[y.Z.face],{});(0,c.YH)(this,j,this.player.isALocalOperator?[e.animate({filter:["brightness(0.7)","brightness(1.0)"]},{duration:300,easing:"ease-in",delay:1}),e.animate({transform:A.makeWiggleAnimation(10,2)},{duration:270,easing:"ease-out",delay:1})]:[]).forEach((e=>e.pause())),e.appendChild(l.R.mkEl("div",[y.Z["downed-overlay"]])),(0,c.Q_)(this,I).appendChild(e)}}_afterAllPlayersConstruction(){(0,c.YH)(this,C,Object.freeze({playerElem:(0,c.Q_)(this,I),username:this.player.username}))}reset(){super.reset();const e=u.Y.Player.Dataset.DOWNED;(0,c.Q_)(this,I).dataset[e.KEY]=e.VALUES.NO}get immigrantInfo(){return(0,c.Q_)(this,C)}_notifyWillBecomeCurrent(e){const t=this.player.game.currentOperator,r=this.player;r.teamId!==(null==t?void 0:t.teamId)&&r.game.players.forEach((e=>{const t=e.teamId===r.teamId;(0,c.Q_)(e.status,I).dataset[u.Y.Player.Dataset.FACE_SWATCH]=e.isALocalOperator?t?"me":"meOppo":t?"teammate":"opponent"})),e.forEach((e=>{(0,c.Q_)(this,I).appendChild(e)})),r.status.immigrantInfo.playerElem.scrollIntoView(m.Bl)}visualBell(){(0,c.Q_)(this,j),window.requestAnimationFrame((e=>{(0,c.Q_)(this,j).forEach((e=>e.play()))}))}get health(){return super.health}set health(e){const t=this.isDowned;if(super.health=e,t!==this.isDowned){const e=u.Y.Player.Dataset.DOWNED;(0,c.Q_)(this,I).dataset[e.KEY]=this.isDowned?this.player.team.elimOrder?e.VALUES.TEAM:e.VALUES.SELF:e.VALUES.NO}}}I=new WeakMap,j=new WeakMap,C=new WeakMap,function(e){var t,r,s;e.makeWiggleAnimation=function(e,t){const r=Array(2*t).fill(e);return r.unshift(0),r.push(0),r.map(((e,t)=>`translate(${t%2?e:-e}%)`))},t=new WeakMap,r=new WeakMap,s=new WeakMap,e.Card=class{constructor(e){Object.defineProperty(this,"baseElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.set(this,void 0),r.set(this,void 0),s.set(this,void 0),this.baseElem=l.R.mkEl("div",[]),this.baseElem.setAttribute("label","Player");const i=(0,c.YH)(this,t,l.R.mkEl("div",[],{textContent:e}));this.baseElem.appendChild(i)}}}(A||(A={})),l.R.protoNoEnum(A,"_afterAllPlayersConstruction"),Object.freeze(A),Object.freeze(A.prototype);var M=r(518),N=r(692);class P extends N.i.Grid{constructor(e){super(e);const t=l.R.mkEl("div",[]);t.style.setProperty("--euclid2-grid-width",this.dimensions.width.toString());for(const e of this.grid)for(const r of e)r._addToDom(t);this._superVisibleGrid(e,t),t.classList.add(M.Z.grid)}}l.R.applyMixins(P,[v]),Object.freeze(P),Object.freeze(P.prototype);var S=r(344),z=r(254);class D extends z.v.Grid{constructor(e){super(e);const t=void 0;this._superVisibleGrid(e,t),t.classList.add(S.Z.grid)}}l.R.applyMixins(D,[v]),Object.freeze(D),Object.freeze(D.prototype),(()=>{const e=b;e._Constructors=Object.freeze({EUCLID2:P,BEEHIVE:D}),Object.freeze(e)})();class L{constructor(){Object.defineProperty(this,"htmlElements",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_ctorBrowserGame(){this.htmlElements=Object.freeze({grid:this.grid.baseElem,playersBar:document.createElement("div")}),l.R.propNoWrite(this,"htmlElements")}_getGridImplementation(e){return b.getImplementation(e)}_createOperatorPlayer(e){return new T(this,e)}}l.R.protoNoEnum(L,"_getGridImplementation"),Object.freeze(L),Object.freeze(L.prototype)}}]);
//# sourceMappingURL=133.js.map