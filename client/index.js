var snakey3;snakey3=(self.webpackChunksnakey3=self.webpackChunksnakey3||[]).push([[826],{632:(e,t,s)=>{"use strict";s.d(t,{R:()=>r});const n=Object.freeze({enumerable:!1}),i=Object.freeze({writable:!1});var r;!function(e){let t;function s(e,t,s){t.forEach((t=>{Object.defineProperty(e,t,s)}))}e.applyMixins=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((s=>{Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s))}))}))},e.deepFreeze=function e(t){return function(t){for(const s of Object.getOwnPropertyNames(t)){const n=t[s];"object"==typeof n&&e(n)}Object.freeze(t)}(t),t},function(e){let t;!function(e){e.access=function(e,t,s){s.enumerable=!1},e.cyclic=function(e,t,s){s.enumerable=!1}}(t=e.NonEnumerable||(e.NonEnumerable={}))}(t=e.Decor||(e.Decor={})),e.protoNoEnum=function(e,...t){t.forEach((t=>{Object.defineProperty(e.prototype,t,n)}))},e.instNoEnum=function(e,...t){s(e,t,n)},e.propNoWrite=function(e,...t){s(e,t,i)},e.prependComment=function(e,t){e.parentNode.insertBefore(document.createComment(" "+t+" "),e)},e.camelCaseTransforms=function(e){const t=e.replace(/[A-Z]/g,(e=>" "+e.toLowerCase()));return Object.freeze({spaceyLowercase:t,spaceyUppercase:t.toUpperCase(),spaceyCapitalized:t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ")})},e.mkEl=function(e,t,s){const n=document.createElement(e);try{Object.seal(n)}catch(e){}return t.length&&n.classList.add(...t),"button"===e?n.type="button":"a"===e&&(n.rel="noopener"),void 0!==s&&Object.assign(n,s),n}}(r||(r={})),Object.freeze(r)},912:(e,t,s)=>{"use strict";s.d(t,{Y:()=>n});var n,i=s(632);!function(e){let t,s,n,i;e.GLOBAL_IDS={PUBLIC_GAME_HOST_URLS:"public-game-hosts-list",CURRENT_HOST_GROUPS:"current-host-groups-list"},function(e){e.Class={TEXT_SELECT_DISABLED:"text-select-disabled",FILL_PARENT:"fill-parent",CENTER_CONTENTS:"center-contents",STACK_CONTENTS:"stack-contents",INPUT_GROUP:"sk-input-group",INPUT_GROUP_ITEM:"sk-input-group-item"},e.Dataset={COLOUR_SCHEME:"skColourScheme"}}(t=e.General||(e.General={})),function(e){e.Dataset={HEALTH:"health"}}(s=e.Tile||(e.Tile={})),function(e){e.Dataset={DOWNED:{KEY:"downed",VALUES:{TEAM:"team",SELF:"self",NO:"no"}},FACE_SWATCH:"face"}}(n=e.Player||(e.Player={})),function(e){let t;e.Id={ALL_SCREENS:"all-screens-container",SCREEN_TINT:"screen-tint"},e.Class={BASE:"sk-screen",NAV_NEXT:"screen--next-button",NAV_PREV:"screen--prev-button"},e.Dataset={CURRENT:"current"},function(e){let t;!function(e){e.Id={LANG_WEIGHT_EXAGGERATION_LIST:"screen-setup--lang-weight-exaggeration-list"}}(t=e.Setup||(e.Setup={}))}(t=e.Impl||(e.Impl={}))}(i=e.Screen||(e.Screen={}))}(n||(n={})),i.R.deepFreeze(n)},804:(e,t,s)=>{"use strict";s.d(t,{b4:()=>n,ZA:()=>i,m4:()=>r,JD:()=>a});class n{}!function(e){let t;e.PROTOCOL="http://",e.DEFAULT_PORT=80,function(e){e.GROUP_JOINER="/joiner.",e.GROUP_LOBBY_PREFIX="/group.",e.GROUP_GAME_PREFIX="/group-game."}(t=e.Nsps||(e.Nsps={}))}(n||(n={})),Object.freeze(n),Object.freeze(n.prototype);class i{}var r,a;!function(e){let t,s,n,i;!function(e){let t;!function(e){e.EVENT_NAME="group-lobby-user-info-change"}(t=e.UserInfoChange||(e.UserInfoChange={}))}(t=e.Socket||(e.Socket={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]+)/,e.MaxLength=30}(s=e.Name||(e.Name={})),function(e){e.REGEXP=/(?:[a-zA-Z0-9:-]*)/,e.MaxLength=30}(n=e.Passphrase||(e.Passphrase={})),e.GameServerReconnectionAttempts=2,e.DEFAULT_TTL=20,function(e){e.EVENT_NAME="group-exist";class t{constructor(e,t){Object.defineProperty(this,"groupName",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"passphrase",{enumerable:!0,configurable:!0,writable:!0,value:t})}}let s;e.RequestCreate=t,function(e){let t;!function(e){e.OKAY="okay",e.NOPE="nope"}(t=e.Response||(e.Response={}))}(t=e.RequestCreate||(e.RequestCreate={})),function(e){e.IN_LOBBY="in-lobby",e.IN_GAME="in-game",e.DELETE="delete"}(s=e.Status||(e.Status={}))}(i=e.Exist||(e.Exist={}))}(i||(i={})),Object.freeze(i),Object.freeze(i.prototype),function(e){e.CREATE_GAME="group-game-create"}(r||(r={})),function(e){e.CREATE_GAME="game-create",e.RESET="game-reset",e.UNPAUSE="game-unpause",e.PAUSE="game-pause",e.RETURN_TO_LOBBY="game-return-to-lobby"}(a||(a={}))},532:(e,t,s)=>{"use strict";s.d(t,{Uo:()=>c,J5:()=>l,Bl:()=>o});var n=s(632);const i=Object.freeze({IDENT:e=>e,LOWER:e=>e.toLowerCase()}),r={"engl-low":{module:"English",export:"Lowercase",numLeaves:26,remapFunc:i.LOWER,displayName:"English Lowercase (qwerty)",blurb:""},"engl-mix":{module:"English",export:"MixedCase",numLeaves:52,remapFunc:i.IDENT,displayName:"English Mixed-Case (Querty)",blurb:""},"japn-hir":{module:"Japanese",export:"Hiragana",numLeaves:71,remapFunc:i.LOWER,displayName:"Japanese Hiragana",blurb:""},"japn-kat":{module:"Japanese",export:"Katakana",numLeaves:69,remapFunc:i.LOWER,displayName:"Japanese Katakana",blurb:""},"kore-dub":{module:"Korean",export:"Dubeolsik",numLeaves:8778,remapFunc:i.IDENT,displayName:"Korean Dubeolsik (두벌식 키보드)",blurb:"The most common keyboard layout, and South Korea's only Hangul standard since 1969. Consonants are on the left, and vowels on the right."},"kore-sub":{module:"Korean",export:"Sebeolsik",numLeaves:10206,remapFunc:i.IDENT,displayName:"Korean Sebeolsik (세벌식 최종 키보드)",blurb:"Another Hangul keyboard layout used in South Korea, and the final Sebeolsik layout designed by Dr. Kong Byung Woo, hence the name. Syllable-initial consonants are on the right, final consonants on the left, and vowels in the middle. It is more ergonomic than the dubeolsik, but not widely used."},"kore-rom":{module:"Korean",export:"Romanization",numLeaves:3990,remapFunc:i.LOWER,displayName:"Korean Revised Romanization",blurb:"The Revised Romanization of Korean (국어의 로마자 표기법; 國語의 로마字 表記法) is the official South Korean language romanization system. It was developed by the National Academy of the Korean Language from 1995, and was released on 7 July 2000 by South Korea's Ministry of Culture and Tourism"},"engl-cell-enc":{module:"English",export:"OldCellphone.Encode",numLeaves:8,remapFunc:i.IDENT,displayName:"Old Cellphone Keyboard",blurb:""},"mors-enc":{module:"English",export:"Morse.Encode",numLeaves:20,remapFunc:e=>e,displayName:"Morse Encoder",blurb:""},"mors-dec":{module:"English",export:"Morse.Decode",numLeaves:41,remapFunc:i.LOWER,displayName:"Morse Decoder",blurb:""},ngram2:{module:"Ngrams",export:"Ngram2",numLeaves:200,remapFunc:i.LOWER,displayName:"English Bigrams",blurb:""},ngram3:{module:"Ngrams",export:"Ngram3",numLeaves:401,remapFunc:i.LOWER,displayName:"English Trigrams",blurb:""},numpad:{module:"Numpad",export:"Numpad",numLeaves:100,remapFunc:i.LOWER,displayName:"Number Pad",blurb:""}};Object.entries(r).forEach((([e,t])=>{t.id=e})),n.R.deepFreeze(r);const a=r,o=Object.freeze({behavior:"smooth",block:"center",inline:"center"});class l{}!function(e){let t,s,n;e.Family=Object.freeze({HUMAN:"HUMAN",CHASER:"CHASER"}),e.Family,function(e){e.NULL=void 0}(t=e.Id||(e.Id={})),function(e){e.REGEXP=/[ a-zA-Z0-9:-]+/,e.MAX_LENGTH=15}(s=e.Username||(e.Username={})),function(e){e.LOREM_IPSUM="lorem-ipsum"}(n=e.Avatar||(e.Avatar={})),function(e){const t=Object.values(e).filter((e=>"string"==typeof e));e.GET_RANDOM=function(){return t[Math.floor(Math.random()*t.length)]}}(n=e.Avatar||(e.Avatar={})),e.MoveType=Object.freeze({NORMAL:"NORMAL",BOOST:"BOOST"}),e.MoveType}(l||(l={})),Object.freeze(l),Object.freeze(l.prototype);class c{}!function(e){let t,s,n;!function(e){e.REGEXP=new RegExp("^[a-zA-Z0-9!@#$%^&*()-_=+;:'\"\\|,.<>/?]+$")}(t=e.Seq||(e.Seq={})),function(e){e.NULL=Object.freeze({char:"",seq:""})}(s=e.CharSeqPair||(e.CharSeqPair={})),function(e){e.MAX=4}(n=e.WeightExaggeration||(e.WeightExaggeration={})),e.CHAR_HIT_COUNT_SEED_CEILING=5,e.FrontendDescs=a,e.GET_FRONTEND_DESC_BY_ID=function(t){return e.FrontendDescs[t]}}(c||(c={})),Object.freeze(c),Object.freeze(c.prototype)},825:(e,t,s)=>{"use strict";var n;s.d(t,{l:()=>n}),function(e){let t,s;!function(e){e.SERVER="SERVER",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(t=e.Type||(e.Type={})),Object.freeze(t),function(e){e.PLAYING="PLAYING",e.PAUSED="PAUSED",e.OVER="OVER"}(s=e.Status||(e.Status={})),Object.freeze(s),e.K=Object.freeze({HEALTH_UPDATE_CHANCE:.1,AVERAGE_HEALTH_TO_SPAWN_ON_TILE:1,PORTION_OF_MOVES_THAT_ARE_BOOST:.4,HEALTH_COST_OF_BOOST(e,t){const s=t(this.AVERAGE_HEALTH_TO_SPAWN_ON_TILE/e);return this.AVERAGE_HEALTH_TO_SPAWN_ON_TILE/s/this.PORTION_OF_MOVES_THAT_ARE_BOOST},HEALTH_EFFECT_FOR_DOWNED_PLAYER:.6,EVENT_RECORD_WRAPPING_BUFFER_LENGTH:50,EVENT_RECORD_FORWARD_WINDOW_LENGTH:25})}(n||(n={})),Object.freeze(n)},897:(e,t,s)=>{"use strict";s.r(t),s.d(t,{OmHooks:()=>l.Y,game:()=>X,screen:()=>K,top:()=>q});var n,i,r,a=s(903),o=s(632),l=s(912),c=s(532);!function(e){let t;function s(e,t){const s={};return Object.keys(t).forEach((t=>{Object.defineProperty(s,t,{enumerable:!0,get:()=>{const s=e.getItem(t);return null===s?void 0:JSON.parse(s)},set:s=>{e.setItem(t,JSON.stringify(s))}})})),Object.freeze(s),s}e.Local=s(localStorage,{musicVolume:1,sfxVolume:1,colourSchemeId:"",colourSchemeStyleLiteral:"",gamePresetId:"",username:"",avatar:""}),e.getLastUserInfo=function(){var t,s;return Object.freeze({username:null!==(t=e.Local.username)&&void 0!==t?t:"unnamed player",teamId:0,avatar:null!==(s=e.Local.avatar)&&void 0!==s?s:c.J5.Avatar.GET_RANDOM()})},e.Session=s(localStorage,Object.freeze({})),function(e){let t;e.DB_NAME="snakeyDB",function(e){e.STORE_NAME="userGamePresets"}(t=e.UserGamePresetStore||(e.UserGamePresetStore={})),Object.freeze(t)}(t=e.IDB||(e.IDB={})),Object.freeze(t)}(n||(n={})),Object.freeze(n);const u=l.Y.Screen.Class;class d{constructor(e,t,s,n){Object.defineProperty(this,"screenId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"screenNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"top",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.set(this,void 0),Object.defineProperty(this,"baseElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.set(this,void 0),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestGoToScreen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.screenId=e,this.screenNames=o.R.camelCaseTransforms(e),this.top=t,(0,a.YH)(this,i,s),this.requestGoToScreen=n,this.baseElem=o.R.mkEl("div",[u.BASE]),(0,a.YH)(this,r,!1),this.nav=Object.freeze({prev:o.R.mkEl("button",[]),next:o.R.mkEl("button",[])}),o.R.propNoWrite(this,"screenId","top","baseElem","nav","requestGoToScreen"),this.nav.prev.classList.add(u.NAV_PREV),this.nav.next.classList.add(u.NAV_NEXT),this.nav.prev.textContent="Back",this.nav.next.textContent="Next",this.nav.prev.onclick=t=>{const s=d.NavTree,n=s[this.screenId];s[n.prev].href===n.href?this.requestGoToScreen(d.NavTree[e].prev,{}):window.history.back()}}_enter(e,t){var s;return(0,a.mG)(this,void 0,void 0,(function*(){if(document.title=`${this.screenNames.spaceyCapitalized} | ${this.top.defaultDocTitle}`,e===d.NavDir.FORWARD){const e=new window.URL(window.location.href),t=e.hash=d.NavTree[this.screenId].href,n=[{screenId:this.screenId},"",e.href];(null===(s=window.history.state)||void 0===s?void 0:s.screenId)!==t&&(d.NavTree[this.screenId].prev===this.screenId?history.replaceState(...n):history.pushState(...n))}(0,a.Q_)(this,r)||(this._lazyLoad(),(0,a.Q_)(this,i).appendChild(this.baseElem),o.R.prependComment(this.baseElem,`${this.screenNames.spaceyUppercase} SCREEN`),this.baseElem.setAttribute("aria-label",this.screenNames.spaceyCapitalized+" Screen"),(0,a.YH)(this,r,!0)),yield this._abstractOnBeforeEnter(e,t)}))}_leave(e){return!!this._abstractOnBeforeLeave(e)}_onAfterEnter(){this.baseElem.dataset[l.Y.Screen.Dataset.CURRENT]="",this.baseElem.setAttribute("aria-hidden","false")}_onAfterLeave(){delete this.baseElem.dataset[l.Y.Screen.Dataset.CURRENT],this.baseElem.setAttribute("aria-hidden","true")}getRecommendedFocusElem(){}_abstractOnBeforeEnter(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){}))}_abstractOnBeforeLeave(e){return!0}}i=new WeakMap,r=new WeakMap,function(e){let t,s;!function(e){e.HOME="home",e.HOW_TO_PLAY="howToPlay",e.HOW_TO_HOST="howToHost",e.COLOUR_CTRL="colourControl",e.SETUP_OFFLINE="setupOffline",e.PLAY_OFFLINE="playOffline",e.GROUP_JOINER="groupJoiner",e.SETUP_ONLINE="setupOnline",e.GROUP_LOBBY="groupLobby",e.PLAY_ONLINE="playOnline"}(t=e.Id||(e.Id={})),Object.freeze(t),e.NavTree=Object.freeze({[t.HOME]:{prev:t.HOME,href:t.HOME},[t.HOW_TO_PLAY]:{prev:t.HOME,href:t.HOW_TO_PLAY},[t.HOW_TO_HOST]:{prev:t.HOME,href:t.HOW_TO_HOST},[t.COLOUR_CTRL]:{prev:t.HOME,href:t.COLOUR_CTRL},[t.SETUP_OFFLINE]:{prev:t.HOME,href:t.SETUP_OFFLINE},[t.PLAY_OFFLINE]:{prev:t.SETUP_OFFLINE,href:t.SETUP_OFFLINE},[t.GROUP_JOINER]:{prev:t.HOME,href:t.GROUP_JOINER},[t.GROUP_LOBBY]:{prev:t.GROUP_JOINER,href:t.GROUP_JOINER},[t.SETUP_ONLINE]:{prev:t.GROUP_LOBBY,href:t.GROUP_JOINER},[t.PLAY_ONLINE]:{prev:t.GROUP_LOBBY,href:t.GROUP_JOINER}}),function(e){e.FORWARD="forward",e.BACKWARD="backward"}(s=e.NavDir||(e.NavDir={})),e.GET_NAV_DIR=function(t){const{curr:s,dest:n}=t;if(void 0===s)return e.NavDir.FORWARD;let i=s;for(;i!==e.NavTree[i].prev;)if(i=e.NavTree[i].prev,i===n)return e.NavDir.BACKWARD;return e.NavDir.FORWARD}}(d||(d={})),Object.freeze(d),Object.freeze(d.prototype);const p={this:"style-m_this_2fw8L",nav:"style-m_nav_3bXQ_","nav--play-offline":"style-m_nav--play-offline_27pYK","nav--play-online":"style-m_nav--play-online_1cZmp","nav--how-to-play":"style-m_nav--how-to-play_29Ok3","nav--how-to-host":"style-m_nav--how-to-host_1Me42","nav--colour-scheme":"style-m_nav--colour-scheme_31wBm","nav--goto-repo":"style-m_nav--goto-repo_2mwhS","nav--report-issue":"style-m_nav--report-issue_QdLSQ"};class h extends d{constructor(){super(...arguments),Object.defineProperty(this,"navElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_lazyLoad(){this.baseElem.classList.add(l.Y.General.Class.CENTER_CONTENTS,p.this);const e=this.navElem=o.R.mkEl("div",[l.Y.General.Class.TEXT_SELECT_DISABLED,l.Y.General.Class.INPUT_GROUP,p.nav]);e.setAttribute("role","navigation"),e.addEventListener("pointerleave",(()=>{var t;(null===(t=document.activeElement)||void 0===t?void 0:t.parentElement)===e&&document.activeElement.blur()}));const t=(t,s)=>{t.classList.add(l.Y.General.Class.CENTER_CONTENTS,l.Y.General.Class.INPUT_GROUP_ITEM,s.cssClass),t.textContent=s.text,t.addEventListener("pointerenter",(()=>{window.requestAnimationFrame((e=>{t.focus()}))})),e.appendChild(t)};[{text:"Offline Single-player",cssClass:p["nav--play-offline"],screenId:d.Id.SETUP_OFFLINE},{text:"Online Multi-player",cssClass:p["nav--play-online"],screenId:d.Id.GROUP_JOINER},{text:"How To Play",cssClass:p["nav--how-to-play"],screenId:d.Id.HOW_TO_PLAY},{text:"How To Host",cssClass:p["nav--how-to-host"],screenId:d.Id.HOW_TO_HOST},{text:"Colour Schemes",cssClass:p["nav--colour-scheme"],screenId:d.Id.COLOUR_CTRL}].map((e=>Object.freeze(e))).forEach((e=>{const s=o.R.mkEl("button",[]);s.onclick=e.screenId instanceof Function?e.screenId:()=>{this.requestGoToScreen(e.screenId,{})},t(s,e)})),[{text:"Visit\nRepo",cssClass:p["nav--goto-repo"],href:new window.URL("https://github.com/david-fong/snakey3")},{text:"Report\nIssue",cssClass:p["nav--report-issue"],href:new window.URL("https://github.com/david-fong/snakey3/issues")}].map((e=>Object.freeze(e))).forEach((e=>{const s=o.R.mkEl("a",[],{href:e.href.toString(),target:"_blank"});t(s,e)})),this.baseElem.appendChild(e)}}Object.freeze(h),Object.freeze(h.prototype);class m extends d{_lazyLoad(){}}Object.freeze(m),Object.freeze(m.prototype);class b extends d{_lazyLoad(){}}!function(e){e.INSTRUCTIONS_STEPS=Object.freeze(["$ npm install 'https://github.com/david-fong/snakey3#gh-pages'","$ npm run start","send the url to your friends"])}(b||(b={})),Object.freeze(b),Object.freeze(b.prototype);var E,v,O,_;class f{constructor(){Object.defineProperty(this,"baseElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),E.set(this,void 0),v.set(this,void 0),O.set(this,void 0);const e=o.R.mkEl("div",["skpickone-m_this_1P7KX"],{tabIndex:0});e.setAttribute("role","listbox"),e.addEventListener("keydown",this._onKeyDown.bind(this)),e.addEventListener("pointerenter",(t=>{window.requestAnimationFrame((t=>{e.focus()}))})),this.baseElem=e,this.options=[]}addOption(e){this.options.push(e),this.baseElem.appendChild(e.baseElem),e.baseElem.addEventListener("pointerenter",this.hoverOpt.bind(this,e)),e.baseElem.addEventListener("click",this.selectOpt.bind(this,e,!0)),e._registerParent(this._onOptDisabledChange.bind(this))}hoverOpt(e){var t;this.hoveredOpt!==e&&(null===(t=this.hoveredOpt)||void 0===t||t.baseElem.setAttribute("aria-active-descendant","false"),(0,a.YH)(this,v,e),this.hoveredOpt.baseElem.setAttribute("aria-active-descendant","true"))}selectOpt(e,t=!0){var s;if(!e)throw new Error("opt must be defined");this.hoverOpt(e),this.confirmedOpt!==e&&(null===(s=this.confirmedOpt)||void 0===s||s.baseElem.setAttribute("aria-selected","false"),(0,a.YH)(this,E,e),this.confirmedOpt.baseElem.setAttribute("aria-selected","true"),t&&this._onSelectOpt(e))}get confirmedOpt(){return(0,a.Q_)(this,E)}get hoveredOpt(){return(0,a.Q_)(this,v)}_onOptDisabledChange(e){this.confirmedOpt===e&&(this._isValid=!e.disabled)}set _isValid(e){this._isValid!==e&&(this.baseElem.setAttribute("aria-invalid",e?"false":"true"),(0,a.YH)(this,O,e))}get _isValid(){return(0,a.Q_)(this,O)}_onKeyDown(e){if(" "===e.key||"Enter"===e.key)return this.selectOpt(this.hoveredOpt),e.preventDefault(),!1;{const t=this.options.indexOf(this.hoveredOpt);if("ArrowDown"===e.key||"Down"===e.key)for(let s=t+1;s<this.options.length;s++){const t=this.options[s];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}else if("ArrowUp"===e.key||"Up"===e.key)for(let s=t-1;s>=0;s--){const t=this.options[s];if(!t.disabled)return this.hoverOpt(t),e.preventDefault(),!1}}return!0}}E=new WeakMap,v=new WeakMap,O=new WeakMap,function(e){var t,s;t=new WeakMap,s=new WeakMap,e._Option=class{constructor(){Object.defineProperty(this,"baseElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.set(this,void 0),s.set(this,void 0),(this.baseElem=o.R.mkEl("div",["skpickone-m_opt_3w8x7"])).setAttribute("role","option"),(0,a.YH)(this,t,!1)}_registerParent(e){(0,a.YH)(this,s,e)}get disabled(){return(0,a.Q_)(this,t)}set disabled(e){this.disabled!==e&&(this.baseElem.setAttribute("aria-disabled",e?"true":"false"),(0,a.YH)(this,t,e),(0,a.Q_)(this,s).call(this,this))}},Object.freeze(e),Object.freeze(e.prototype)}(f||(f={})),Object.freeze(f),Object.freeze(f.prototype);class g extends d{constructor(){super(...arguments),Object.defineProperty(this,"sel",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_lazyLoad(){this.baseElem.classList.add("style-m_this_2usro"),this.baseElem.appendChild(this.nav.prev);const e=this.sel=new g.PickOne(this.top.storage.Local,this.top.transition);o.R.propNoWrite(this,"sel"),this.baseElem.appendChild(e.baseElem);const t=this.top.storage.Local.colourSchemeId;t&&this.sel.selectOpt(this.sel.getOptById(t),!1)}}!function(e){var t,s,n;class i extends f{constructor(e,r){var o;super(),t.set(this,void 0),s.set(this,void 0),n.set(this,void 0),(0,a.YH)(this,t,!0),(0,a.YH)(this,s,e),(0,a.YH)(this,n,r),_.Schemes.forEach((e=>{this.addOption(new i.Option(e))})),this.selectOpt(this.getOptById(null!==(o=(0,a.Q_)(this,s).colourSchemeId)&&void 0!==o?o:"snakey"),!1)}_onHoverOpt(e){}_onSelectOpt(e){(0,a.Q_)(this,s).colourSchemeId=e.desc.id,(0,a.Q_)(this,s).colourSchemeStyleLiteral=e.cssLiteral;const i=(0,a.Q_)(this,t);(0,a.YH)(this,t,!1),(0,a.Q_)(this,n).do({intermediateTransitionTrigger:()=>{document.documentElement.dataset[l.Y.General.Dataset.COLOUR_SCHEME]=e.desc.id;const t=document.documentElement.style;if(i)for(const e of _.Swatch){const s="--colour-"+e;t.setProperty(s,"")}}})}getOptById(e){return this.options.find((t=>t.desc.id===e))}}t=new WeakMap,s=new WeakMap,n=new WeakMap,e.PickOne=i,function(e){class t extends f._Option{constructor(e){super(),Object.defineProperty(this,"desc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cssLiteral",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.desc=e;const s=this.baseElem;s.classList.add("style-m_opt_2GxiP"),s.dataset[l.Y.General.Dataset.COLOUR_SCHEME]=e.id;const n=o.R.mkEl("span",["style-m_opt-label_2nPC6"]);n.appendChild(o.R.mkEl("div",["style-m_opt-label--title_3GbE2"],{textContent:e.displayName})),n.appendChild(o.R.mkEl("div",["style-m_opt-label--author_3LTv3"],{textContent:"by "+e.author})),s.appendChild(n);for(let e=0;e<t.NUM_PREVIEW_SLOTS-1;e++)s.appendChild(o.R.mkEl("span",[]));document.body.appendChild(s);let i="";const r=window.getComputedStyle(s);for(const e of _.Swatch){const t="--colour-"+e;i+=t+":"+r.getPropertyValue(t)+";"}this.cssLiteral=i}}e.Option=t,function(e){e.NUM_PREVIEW_SLOTS=8}(t=e.Option||(e.Option={})),Object.freeze(t),Object.freeze(t.prototype)}(i=e.PickOne||(e.PickOne={})),Object.freeze(i),Object.freeze(i.prototype)}(g||(g={})),Object.freeze(g),Object.freeze(g.prototype),function(e){e.Swatch=Object.freeze(["mainFg","mainBg","tileFg","tileBg","tileBd","healthFg","healthBg","pFaceMe","pFaceMeOppo","pFaceTeammate","pFaceImtlTeammate","pFaceOpponent","pFaceImtlOpponent"]),e.Schemes=Object.freeze([{id:"snakey",displayName:"Snakey",author:"N.W."},{id:"smooth-stone",displayName:"Smooth Stone",author:"Dav"},{id:"murky-dive",displayName:"Murky Dive",author:"Stressed Dav"}].map((e=>Object.freeze(e))))}(_||(_={})),Object.freeze(_);class y extends d{constructor(){super(...arguments),Object.defineProperty(this,"langSel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"langWeightExaggeration",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_lazyLoad(){this.baseElem.classList.add("style-m_this_18T-R"),this.baseElem.appendChild(this.nav.prev),this.langSel=new y.LangPickOne,this.baseElem.appendChild(this.langSel.baseElem),this._createLangWeightExaggerationInput(),o.R.propNoWrite(this,"langSel","langWeightExaggeration"),this.baseElem.appendChild(this.nav.next),this._loadLastUsedPreset()}_createLangWeightExaggerationInput(){const e=this.langWeightExaggeration=o.R.mkEl("input",["style-m_lang-weight-exagg_3vawC"],{type:"range",min:"0",max:c.Uo.WeightExaggeration.MAX.toString(),step:"any",value:"1"});{const e=o.R.mkEl("datalist",[]);e.id=l.Y.Screen.Impl.Setup.Id.LANG_WEIGHT_EXAGGERATION_LIST,[{val:0,label:"0"},{val:1,label:"1"}].forEach((t=>{e.appendChild(o.R.mkEl("option",[],{value:t.val.toString(),label:t.label}))})),this.baseElem.appendChild(e)}e.setAttribute("list",l.Y.Screen.Impl.Setup.Id.LANG_WEIGHT_EXAGGERATION_LIST),this.baseElem.appendChild(e)}getRecommendedFocusElem(){return this.nav.next}_loadLastUsedPreset(){this.top.storage.Local.gamePresetId}parseArgsFromGui(){const e=Object.assign({},y.DEFAULT_PRESET());return e.langId=this.langSel.confirmedOpt.desc.id,e.langWeightExaggeration=parseFloat(this.langWeightExaggeration.value),e}}!function(e){e.DEFAULT_PRESET=()=>({coordSys:"EUCLID2",gridDimensions:{height:21,width:21},averageFreeHealthPerTile:1/45,langWeightExaggeration:1,langId:"engl-low",playerDescs:[{isALocalOperator:!1,familyId:"CHASER",teamId:1,clientId:void 0,username:"chaser1",avatar:void 0,noCheckGameOver:!0,familyArgs:{}},{isALocalOperator:!1,familyId:"CHASER",teamId:1,clientId:void 0,username:"chaser2",avatar:void 0,noCheckGameOver:!0,familyArgs:{fearDistance:6,bloodThirstDistance:5,healthReserve:5,keyPressesPerSecond:1.8}}]});class t extends f{constructor(){super(),this.baseElem.classList.add("style-m_lang-sel_2PZpD"),Object.values(c.Uo.FrontendDescs).forEach((e=>{this.addOption(new t.Option(e))})),this.selectOpt(this.options[0])}_onHoverOpt(e){}_onSelectOpt(e){}}e.LangPickOne=t,function(e){class t extends f._Option{constructor(e){super(),Object.defineProperty(this,"desc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.desc=e,this.baseElem.textContent=e.displayName}}e.Option=t,Object.freeze(t),Object.freeze(t.prototype)}(t=e.LangPickOne||(e.LangPickOne={}))}(y||(y={})),Object.freeze(y),Object.freeze(y.prototype);class T extends y{_lazyLoad(){super._lazyLoad(),this.nav.next.onclick=e=>{const t=this.parseArgsFromGui();this.requestGoToScreen(d.Id.PLAY_OFFLINE,t)}}parseArgsFromGui(){const e=super.parseArgsFromGui();return e.playerDescs.splice(e.playerDescs.length,0,{isALocalOperator:!0,familyId:"HUMAN",teamId:0,clientId:void 0,username:"hello1",avatar:void 0,noCheckGameOver:!1,familyArgs:{}},{isALocalOperator:!0,familyId:"HUMAN",teamId:1,clientId:void 0,username:"hello2",avatar:void 0,noCheckGameOver:!1,familyArgs:{}}),e}}Object.freeze(T),Object.freeze(T.prototype);var N=s(825);var S,L,R,I;class P extends d{constructor(){super(...arguments),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"playersBar",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"btn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),S.set(this,void 0),Object.defineProperty(this,"wantsAutoPlayPause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"askConfirmBeforeLeave",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),L.set(this,void 0),R.set(this,void 0),I.set(this,void 0)}_lazyLoad(){this.baseElem.classList.add(l.Y.General.Class.CENTER_CONTENTS,"style-m_this_1euFn");const e=P.createGridWrapper();this.grid=Object.freeze({base:e.top,implHost:e.implHost,pauseOl:e.pauseOl}),o.R.propNoWrite(this,"grid"),o.R.prependComment(this.grid.implHost,"grid impl host"),this.grid.implHost.appendChild(document.createComment("grid impl")),this.baseElem.appendChild(e.top),e.pauseOl.addEventListener("focus",(e=>{const t=this.currentGame;void 0!==t&&t.status===N.l.Status.PAUSED&&(this.grid.base.focus(),this._reqStatusPlaying())})),this._initializeControlsBar(),this._initializePlayersBar(),(0,a.YH)(this,L,(()=>{if(this.wantsAutoPlayPause)if(document.hidden){if(void 0===(0,a.Q_)(this,I)){const e=this.currentGame;(void 0===e||void 0!==e&&e.status!==N.l.Status.OVER)&&this._reqStatusPaused()}}else"page-hide"===(0,a.Q_)(this,I)&&this._reqStatusPlaying()})),(0,a.YH)(this,R,this._gridKeyDownCallback.bind(this))}_abstractOnBeforeEnter(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){document.addEventListener("visibilitychange",(0,a.Q_)(this,L)),this.btn.pause.disabled=!0,this._statusBecomePaused();const e=(0,a.YH)(this,S,yield this._createNewGame(t));yield e.reset(),this.grid.implHost.appendChild(e.htmlElements.grid),this.playersBar.appendChild(e.htmlElements.playersBar),this.btn.pause.onclick=this._reqStatusPlaying.bind(this),this.btn.pause.disabled=!1,this.wantsAutoPlayPause&&setTimeout((()=>{document.hidden||this._reqStatusPlaying()}),500),this.grid.base.addEventListener("keydown",(0,a.Q_)(this,R),{capture:!0})}))}_abstractOnBeforeLeave(e){if(this.askConfirmBeforeLeave&&!this.top.confirm("Are you sure you would like to leave?"))return!1;document.removeEventListener("visibilitychange",(0,a.Q_)(this,L)),this.currentGame.statusBecomeOver();for(const e of Object.values(this.currentGame.htmlElements))e.textContent="",e.remove();return this.grid.base.removeEventListener("keydown",(0,a.Q_)(this,R)),(0,a.YH)(this,S,void 0),!0}get currentGame(){return(0,a.Q_)(this,S)}get probeCurrentGame(){return(0,a.Q_)(this,S)}_gridKeyDownCallback(e){if(e.stopPropagation(),!e.isTrusted)return!0;const t=this.currentGame;if(e.ctrlKey&&" "===e.key&&!e.repeat){const e=t.operators;t.setCurrentOperator((1+e.indexOf(t.currentOperator))%e.length)}else t.currentOperator.processKeyboardInput(e);return" "!==e.key||(e.preventDefault(),!1)}_reqStatusPlaying(){this._statusBecomePlaying()}_reqStatusPaused(){this._statusBecomePaused()}_statusBecomePlaying(){this.currentGame.statusBecomePlaying(),this.btn.pause.textContent="Pause",this.grid.pauseOl.style.visibility="hidden",(0,a.YH)(this,I,void 0),this.btn.pause.onclick=this._reqStatusPaused.bind(this),this.btn.reset.disabled=!0,this.grid.base.focus()}_statusBecomePaused(){var e;null===(e=this.currentGame)||void 0===e||e.statusBecomePaused(),this.btn.pause.textContent="Unpause",this.grid.pauseOl.style.visibility="visible",(0,a.YH)(this,I,document.hidden?"page-hide":"other"),this.btn.pause.onclick=this._reqStatusPlaying.bind(this),this.btn.reset.disabled=!1}_onGameBecomeOver(){this.btn.pause.disabled=!0,this.btn.reset.disabled=!1}_resetGame(){this.currentGame.reset(),this.btn.pause.disabled=!1,this.wantsAutoPlayPause&&this._reqStatusPlaying()}_initializeControlsBar(){const e=o.R.mkEl("div",[l.Y.General.Class.CENTER_CONTENTS,l.Y.General.Class.INPUT_GROUP,"style-m_controls-bar_fLS47"]);function t(t,s){return(s=null!=s?s:o.R.mkEl("button",[])).classList.add(l.Y.General.Class.INPUT_GROUP_ITEM),s.textContent=t,s.addEventListener("pointerenter",(e=>{s.focus()})),e.appendChild(s),s}e.setAttribute("role","menu"),e.addEventListener("pointerleave",(e=>{this.grid.base.focus()})),t("<Back Button Text>",this.nav.prev),this.btn=Object.freeze({pause:t(""),reset:t("Reset")}),o.R.propNoWrite(this,"btn"),this.btn.reset.onclick=this._resetGame.bind(this),this.baseElem.appendChild(e)}_initializePlayersBar(){const e=this.playersBar=o.R.mkEl("div",["style-m_players-bar_BDHhb"]);o.R.propNoWrite(this,"playersBar"),this.baseElem.appendChild(e)}}S=new WeakMap,L=new WeakMap,R=new WeakMap,I=new WeakMap,function(e){e.createGridWrapper=function(){const e=l.Y.General.Class,t=o.R.mkEl("div",["style-m_grid-wrapper_2jXbc"]);t.setAttribute("role","presentation");const s=o.R.mkEl("div",[e.TEXT_SELECT_DISABLED,"grid-m_this_3RnyB"],{tabIndex:0});s.setAttribute("role","textbox"),s.setAttribute("aria-label","Game Grid");const n=o.R.mkEl("div",["grid-m_scroll-outer_3To0V"]);n.setAttribute("role","presentation");const i=o.R.mkEl("div",[e.FILL_PARENT,e.CENTER_CONTENTS,"grid-m_pause-overlay_3RB2_"],{});return i.appendChild(o.R.mkEl("div",[],{textContent:"(Click to Unpause)"})),n.appendChild(i),s.appendChild(n),t.appendChild(s),Object.freeze({top:t,grid:s,intersectionRoot:n,implHost:n,pauseOl:i})}}(P||(P={})),o.R.protoNoEnum(P,"probeCurrentGame","_statusBecomePlaying","_statusBecomePaused"),o.R.instNoEnum(P,"createGridWrapper"),Object.freeze(P),Object.freeze(P.prototype);class C extends P{constructor(){super(...arguments),Object.defineProperty(this,"wantsAutoPlayPause",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"askConfirmBeforeLeave",{enumerable:!0,configurable:!0,writable:!0,value:!0})}_lazyLoad(){super._lazyLoad(),this.nav.prev.innerHTML="Return To&nbsp;Setup"}_createNewGame(e){return(0,a.mG)(this,void 0,void 0,(function*(){return new((yield Promise.all([s.e(68),s.e(133),s.e(755)]).then(s.bind(s,765))).OfflineGame)(this._onGameBecomeOver.bind(this),e)}))}}Object.freeze(C),Object.freeze(C.prototype);var k=s(804);var w,A;class G extends d{constructor(){super(...arguments),w.set(this,void 0),Object.defineProperty(this,"in",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"groupNameDataList",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),A.set(this,!1)}get clientIsGroupHost(){return(0,a.Q_)(this,A)}get loginInfo(){if(void 0===this.in)throw new Error("never");return Object.freeze({name:this.in.groupName.value,passphrase:this.in.passphrase.value})}_lazyLoad(){this.baseElem.classList.add(l.Y.General.Class.CENTER_CONTENTS,"style-m_this_1mSAZ");const e=this._initializeFormContents(),t=this._initializeHostUrlHandlers();this._initializeGroupNameHandlers(t),this._initializePassphraseHandlers(),this.nav.next.onclick=e=>{s()};const s=()=>{this.requestGoToScreen(d.Id.GROUP_LOBBY,{})};this._setFormState(H.CHOOSING_HOST),this.baseElem.appendChild(e)}getRecommendedFocusElem(){return void 0!==this.groupSocket?this.in.groupName:this.in.hostUrl}get state(){return(0,a.Q_)(this,w)}_setFormState(e){if(this.state!==e){if(e===H.IN_GROUP){if(this.state!==H.CHOOSING_GROUP)throw new Error("never");this.in.passphrase.disabled=!0,this.nav.next.disabled=!1,this.nav.next.focus()}else this.nav.next.disabled=!0,this.in.passphrase.value="",e===H.CHOOSING_HOST?(this.in.groupName.disabled=!0,this.in.groupName.value="",this.groupNameDataList.textContent="",this.in.passphrase.disabled=!0,this.in.hostUrl.focus()):e===H.CHOOSING_GROUP&&(this.in.groupName.disabled=!1,this.in.passphrase.disabled=!1,(0,a.YH)(this,A,!1),this.in.groupName.focus());(0,a.YH)(this,w,e)}}_initializeHostUrlHandlers(){const e=this.top,t=this.in.hostUrl,s=()=>(0,a.mG)(this,void 0,void 0,(function*(){var s,n;if(!t.value||!t.validity.valid)return;const i=new window.URL(t.value);if((null===(s=this.groupSocket)||void 0===s?void 0:s.io.opts.hostname)===i.hostname)return void(this.groupSocket.connected&&this._setFormState(H.CHOOSING_GROUP));null===(n=this.joinerSocket)||void 0===n||n.disconnect();const r=yield this.top.sockets.joinerSocketConnect({serverUrl:i});r.on("connect",(()=>{this._setFormState(H.CHOOSING_GROUP),r.on(k.ZA.Exist.EVENT_NAME,this._onNotifyGroupExist.bind(this))})).on("connect_error",(e=>{this.top.toast("Unable to connected to the specified server.")})).on("disconnect",(s=>{"io server disconnect"===s&&(this._setFormState(H.CHOOSING_HOST),t.value="",e.toast("The server disconnected you from the group joiner."))}))}));return t.oninput=e=>this._setFormState(H.CHOOSING_HOST),t.onkeydown=e=>{e.isTrusted&&"Enter"===e.key&&s()},t.onpaste=e=>{e.isTrusted&&window.setTimeout((()=>s()),0)},t.onchange=e=>{e.isTrusted&&s()},s}_onNotifyGroupExist(e){if(e===k.ZA.Exist.RequestCreate.Response.NOPE)return void this.top.toast(`The server rejected your request to create a new group "${this.in.groupName.value}".`);if(e===k.ZA.Exist.RequestCreate.Response.OKAY)return this.top.toast(`server accepted request to create new group "${this.in.groupName.value}".`),this.top.toast("connecting to new group..."),void this._attemptToJoinExistingGroup();const t=this.groupNameDataList,s=Array.from(t.children);Object.entries(e).forEach((([e,n])=>{const i=s.find((t=>t.value===e))||(e=>{const n=o.R.mkEl("option",[],{value:e});for(const e of s)if(n.value.localeCompare(e.value)<0){t.insertBefore(n,e);break}return n.parentElement||t.appendChild(n),n})(e);switch(n){case k.ZA.Exist.Status.IN_LOBBY:i.textContent="In Lobby";break;case k.ZA.Exist.Status.IN_GAME:i.textContent="In Game";break;case k.ZA.Exist.Status.DELETE:i.remove()}}))}_initializeGroupNameHandlers(e){const t=this.in.groupName,s=()=>{t.value&&t.validity.valid&&(this.state===H.IN_GROUP?this.nav.next.focus():this.in.passphrase.focus())};this.in.groupName.oninput=t=>(0,a.mG)(this,void 0,void 0,(function*(){t.isTrusted&&(this.state===H.IN_GROUP&&(yield e()),this.in.passphrase.value="",(0,a.YH)(this,A,!1))})),t.onkeydown=e=>{e.isTrusted&&"Enter"===e.key&&s()},t.onchange=e=>{e.isTrusted&&s()}}_initializePassphraseHandlers(){const e=()=>(0,a.mG)(this,void 0,void 0,(function*(){if(this.in.passphrase.validity.valid)return void 0!==this.groupSocket&&this.groupSocket.nsp===k.b4.Nsps.GROUP_LOBBY_PREFIX+this.in.groupName.value?this.groupSocket.connected?(this._setFormState(H.IN_GROUP),void this.nav.next.focus()):void 0:void(Array.from(this.groupNameDataList.children).some((e=>e.value===this.in.groupName.value))?((0,a.YH)(this,A,!1),this._attemptToJoinExistingGroup()):((0,a.YH)(this,A,!0),this.joinerSocket.emit(k.ZA.Exist.EVENT_NAME,new k.ZA.Exist.RequestCreate(this.in.groupName.value,this.in.passphrase.value))))}));this.in.passphrase.onkeydown=t=>{t.isTrusted&&"Enter"===t.key&&e()}}_attemptToJoinExistingGroup(){var e;null===(e=this.groupSocket)||void 0===e||e.disconnect();const t=this.top,s=n.getLastUserInfo();this.top.sockets.groupSocketConnect(this.in.groupName.value,{passphrase:this.in.passphrase.value,userInfo:s}).on("connect",(()=>{this._setFormState(H.IN_GROUP)})).on("connect_error",(e=>{this._setFormState(H.CHOOSING_GROUP),t.toast("Unable to connect to the specified group.")})).on("disconnect",(e=>{this._setFormState(H.CHOOSING_GROUP),"io server disconnect"===e&&(t.toast("The server disconnected you from your group."),this.top.currentScreen!==this?this.requestGoToScreen(d.Id.GROUP_JOINER,{}):this.in.passphrase.focus())}))}get joinerSocket(){return this.top.sockets.joinerSocket}get groupSocket(){return this.top.sockets.groupSocket}_initializeFormContents(){this.in={};const e=o.R.mkEl("div",[l.Y.General.Class.INPUT_GROUP,"style-m_content-wrapper_3PpQN"],{});function t(t,s){const n=o.R.mkEl("input",[l.Y.General.Class.INPUT_GROUP_ITEM,s],{type:"text",autocomplete:"off",spellcheck:!1}),i=o.R.mkEl("label",[],{textContent:t});return i.appendChild(n),e.appendChild(i),n}this.nav.prev.classList.add(l.Y.General.Class.INPUT_GROUP_ITEM),e.appendChild(this.nav.prev);{const e=this.in.hostUrl=Object.assign(t("Host URL","style-m_host-url_1TIpa"),{type:"url",maxLength:128,autocomplete:"on",required:!0});e.setAttribute("list",l.Y.GLOBAL_IDS.PUBLIC_GAME_HOST_URLS);const s=G.SUGGEST_HOST(this.top.webpageHostType);if(s){const t=o.R.mkEl("option",[],{value:s.value,textContent:s.description});document.getElementById(l.Y.GLOBAL_IDS.PUBLIC_GAME_HOST_URLS).insertAdjacentElement("afterbegin",t),e.value=t.value}}{const e=this.in.groupName=Object.assign(t("Group Name","style-m_group-name_1JfrT"),{pattern:k.ZA.Name.REGEXP.source,minLength:1,maxLength:k.ZA.Name.MaxLength,autocomplete:"on",required:!0}),s=this.groupNameDataList=o.R.mkEl("datalist",[],{id:l.Y.GLOBAL_IDS.CURRENT_HOST_GROUPS});this.baseElem.appendChild(s),e.setAttribute("list",s.id)}{const e=this.in.passphrase=t("Group Passphrase","style-m_passphrase_2tjc3");e.pattern=k.ZA.Passphrase.REGEXP.source,e.maxLength=k.ZA.Passphrase.MaxLength}return this.nav.next.classList.add(l.Y.General.Class.INPUT_GROUP_ITEM),e.appendChild(this.nav.next),o.R.propNoWrite(this,"in","groupNameDataList"),Object.freeze(this.in),e}}w=new WeakMap,A=new WeakMap,function(e){let t;!function(e){e.CHOOSING_HOST="choosing-host",e.CHOOSING_GROUP="choosing-group",e.IN_GROUP="in-group"}(t=e.State||(e.State={})),e.SUGGEST_HOST=function(e){switch(e){case"github":return;case"filesystem":return{value:"localhost:"+k.b4.DEFAULT_PORT,description:"dev shortcut :)"};case"sk-server":return{value:window.location.origin,description:"this page's server"};default:return}}}(G||(G={}));const H=G.State;Object.freeze(G),Object.freeze(G.prototype);class U extends y{_lazyLoad(){super._lazyLoad(),this.nav.next.textContent="Start Game",this.nav.next.onclick=e=>{const t=this.parseArgsFromGui();this.top.clientIsGroupHost&&this.top.sockets.groupSocket.emit(k.m4.CREATE_GAME,t)}}}Object.freeze(U),Object.freeze(U.prototype);class j extends d{constructor(){super(...arguments),Object.defineProperty(this,"_players",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"teamsElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"teamElems",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"in",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}get socket(){return this.top.sockets.groupSocket}_lazyLoad(){this.baseElem.classList.add("style-m_this_1Rjcs"),this._players=new Map,this._createInputs(),this.nav.prev.textContent="Return To Joiner",this.teamsElem=o.R.mkEl("div",["style-m_teams-section_2eDnz"]),this.baseElem.appendChild(this.teamsElem),this.teamElems=new Map,o.R.propNoWrite(this,"_players","teamsElem","teamElems","in");{const e=this.nav.next;e.textContent="Setup Game",e.onclick=()=>{this.requestGoToScreen(d.Id.SETUP_ONLINE,{})},this.baseElem.appendChild(e)}}_createInputs(){var e;const t=o.R.mkEl("div",[l.Y.General.Class.INPUT_GROUP,"style-m_client-info-section_2hDNO"]),s=o.R.mkEl("input",[l.Y.General.Class.INPUT_GROUP_ITEM],{type:"text",minLength:1,maxLength:c.J5.Username.MAX_LENGTH,pattern:c.J5.Username.REGEXP.source,spellcheck:!1,value:null!==(e=this.top.storage.Local.username)&&void 0!==e?e:"",onchange:this._submitInputs.bind(this)});t.appendChild(s);const n=o.R.mkEl("input",[l.Y.General.Class.INPUT_GROUP_ITEM],{type:"number",inputMode:"numeric",min:"0",max:"0",step:"1",value:"0",onchange:this._submitInputs.bind(this)});n.classList.add(),t.appendChild(n);const i=o.R.mkEl("select",[]);this.in=Object.freeze({username:s,teamId:n,avatar:i}),this.baseElem.appendChild(t)}_submitInputs(){this.in.username.validity.valid&&this.in.teamId.validity.valid&&(this.top.storage.Local.username=this.in.username.value,this.top.storage.Local.avatar=this.in.avatar.value,this.socket.emit(k.ZA.Socket.UserInfoChange.EVENT_NAME,{username:this.in.username.value,teamId:parseInt(this.in.teamId.value),avatar:c.J5.Avatar.LOREM_IPSUM}))}_abstractOnBeforeEnter(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){"forward"===e&&(this.nav.next.disabled=!this.top.clientIsGroupHost,this._players.clear(),this.teamElems.clear(),this.teamsElem.textContent="",this._submitInputs(),this.socket.off(k.ZA.Socket.UserInfoChange.EVENT_NAME).on(k.ZA.Socket.UserInfoChange.EVENT_NAME,this._onUserInfoChange.bind(this))),this.socket.once(k.m4.CREATE_GAME,(()=>{const e=this.top.groupLoginInfo;console.log("group create game socket. now waiting for ctor args. "),this.top.sockets.gameSocketConnect(e.name,{passphrase:e.passphrase}).once(k.JD.CREATE_GAME,(e=>{this.requestGoToScreen(d.Id.PLAY_ONLINE,e)}))}))}))}getRecommendedFocusElem(){let e=this.in.username.validity.valid?this.in.teamId.validity.valid?void 0:this.in.teamId:this.in.username;return void 0===e&&(e=this.top.clientIsGroupHost?this.nav.next:this.in.teamId),e}_abstractOnBeforeLeave(e){return e===d.NavDir.BACKWARD&&this.socket.off(k.m4.CREATE_GAME),!0}_onUserInfoChange(e){Object.entries(e).forEach((([e,t])=>{const s=this._players.get(e);if(!s||1!==this.teamElems.get(s.teamId).childElementCount||void 0!==t&&t.teamId===s.teamId||(this.teamElems.get(s.teamId).remove(),this.teamElems.delete(s.teamId)),t&&!this.teamElems.has(t.teamId)){const e=o.R.mkEl("div",["style-m_team_1OhAw"]);this.teamElems.set(t.teamId,e),e.onclick=e=>{this.in.teamId.value=t.teamId.toString()},this.teamsElem.appendChild(e)}if(void 0===t)s.base.remove(),this._players.delete(e);else if(void 0===s){const s=new j.UserInfo(t);this._players.set(e,s),this.teamElems.get(t.teamId).appendChild(s.base)}else s.update(t)})),this.in.teamId.max=Object.keys(this._players).length.toString()}}!function(e){var t,s,n;t=new WeakMap,s=new WeakMap,n=new WeakMap,e.UserInfo=class{constructor(e){t.set(this,void 0),s.set(this,void 0),n.set(this,void 0),Object.defineProperty(this,"base",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"el",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.base=o.R.mkEl("div",["style-m_player_2jAbJ"]);const i=()=>{const e=o.R.mkEl("div",[]);return this.base.appendChild(e),e};this.el=Object.freeze({username:i(),teamId:i(),avatar:i()}),this.el.username.classList.add("style-m_player__name_3esbS"),this.username=e.username,this.teamId=e.teamId,o.R.propNoWrite(this,"base","el")}update(e){this.username=e.username,this.teamId=e.teamId,this.avatar=e.avatar}get username(){return(0,a.Q_)(this,t)}set username(e){this.el.username.textContent=e,(0,a.YH)(this,t,e)}get teamId(){return(0,a.Q_)(this,s)}set teamId(e){this.el.teamId.textContent=e.toString(),(0,a.YH)(this,s,e)}get avatar(){return(0,a.Q_)(this,n)}set avatar(e){(0,a.YH)(this,n,e),this.el.avatar}}}(j||(j={})),o.R.protoNoEnum(j,"_createInputs","_submitInputs"),Object.freeze(j),Object.freeze(j.prototype);class x extends P{constructor(){super(...arguments),Object.defineProperty(this,"askConfirmBeforeLeave",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"wantsAutoPlayPause",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get socket(){return this.top.sockets.gameSocket}_lazyLoad(){super._lazyLoad(),this.nav.prev.innerHTML="Return To&nbsp;Lobby"}_abstractOnBeforeLeave(e){const t=super._abstractOnBeforeLeave(e);return t&&void 0!==this.socket&&(this.socket.emit(k.JD.RETURN_TO_LOBBY),this.socket.offAny(),this.socket.disconnect()),t}_reqStatusPlaying(){this.socket.emit(k.JD.UNPAUSE)}_reqStatusPaused(){this.socket.emit(k.JD.PAUSE)}_createNewGame(e){return(0,a.mG)(this,void 0,void 0,(function*(){const t=new((yield Promise.all([s.e(68),s.e(133),s.e(775)]).then(s.bind(s,92))).OnlineGame)(this._onGameBecomeOver.bind(this),this.top.sockets.gameSocket,e);return this.socket.on(k.JD.UNPAUSE,(()=>{this._statusBecomePlaying()})).on(k.JD.PAUSE,(()=>{this._statusBecomePaused()})).on(k.JD.RETURN_TO_LOBBY,(e=>{void 0===e&&this.nav.prev.click()})),Promise.resolve(t)}))}_onGameBecomeOver(){super._onGameBecomeOver()}}var z,M,D,B,F;Object.freeze(x),Object.freeze(x.prototype);class W{constructor(e,t){Object.defineProperty(this,"dict",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),z.set(this,void 0),M.set(this,void 0),(0,a.YH)(this,M,e.transition),t.setAttribute("role","presentation");const s=d.Id,n=e,i=t,r=Object.freeze(this.goToScreen.bind(this));this.dict=Object.freeze({[s.HOME]:new h(s.HOME,n,i,r),[s.HOW_TO_PLAY]:new m(s.HOW_TO_PLAY,n,i,r),[s.HOW_TO_HOST]:new b(s.HOW_TO_HOST,n,i,r),[s.COLOUR_CTRL]:new g(s.COLOUR_CTRL,n,i,r),[s.SETUP_OFFLINE]:new T(s.SETUP_OFFLINE,n,i,r),[s.PLAY_OFFLINE]:new C(s.PLAY_OFFLINE,n,i,r),[s.GROUP_JOINER]:new G(s.GROUP_JOINER,n,i,r),[s.SETUP_ONLINE]:new U(s.SETUP_ONLINE,n,i,r),[s.GROUP_LOBBY]:new j(s.GROUP_LOBBY,n,i,r),[s.PLAY_ONLINE]:new x(s.PLAY_ONLINE,n,i,r)}),o.R.propNoWrite(this,"dict");const l=d.NavTree[window.location.hash.slice(1)];window.setTimeout((()=>{var e;this.goToScreen(null!==(e=null==l?void 0:l.href)&&void 0!==e?e:d.Id.HOME,{})}),75),window.addEventListener("popstate",(e=>{this.goToScreen(window.history.state.screenId,{})}))}goToScreen(e,t){return(0,a.mG)(this,void 0,void 0,(function*(){const s=this.currentScreen,n=this.dict[e];(0,a.YH)(this,z,n);const i=d.GET_NAV_DIR({curr:null==s?void 0:s.screenId,dest:e});return!(void 0!==s&&!s._leave(i)||(yield(0,a.Q_)(this,M).do({beforeUnblurAwait:n._enter(i,t),beforeUnblur:()=>{var e;null==s||s._onAfterLeave(),n._onAfterEnter(),null===(e=n.getRecommendedFocusElem())||void 0===e||e.focus()}}),0))}))}get currentScreen(){return(0,a.Q_)(this,z)}}z=new WeakMap,M=new WeakMap,Object.freeze(W),Object.freeze(W.prototype);class Y{constructor(){Object.defineProperty(this,"baseElem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),D.set(this,void 0),this.baseElem=document.getElementById(l.Y.Screen.Id.SCREEN_TINT),(0,a.YH)(this,D,void 0),o.R.propNoWrite(this,"baseElem")}do(e){var t;return(0,a.YH)(this,D,(null!==(t=(0,a.Q_)(this,D))&&void 0!==t?t:Promise.resolve()).then((()=>this._atomicDo(e)))),(0,a.Q_)(this,D)}_atomicDo(e){return(0,a.mG)(this,void 0,void 0,(function*(){const t=this.baseElem.style;yield this._triggerCssTransition((()=>{t.pointerEvents="all",t.opacity="1.0"})),void 0!==e.intermediateTransitionTrigger&&(yield this._triggerCssTransition((()=>{e.intermediateTransitionTrigger()}))),yield e.beforeUnblurAwait,void 0!==e.beforeUnblur&&e.beforeUnblur(),yield this._triggerCssTransition((()=>{t.pointerEvents="none",t.opacity="0.0"}))}))}_triggerCssTransition(e){return new Promise(((t,s)=>{this.baseElem.addEventListener("transitionend",(()=>t()),{once:!0}),e()}))}}D=new WeakMap,o.R.protoNoEnum(Y,"_atomicDo","_triggerCssTransition"),Object.freeze(Y),Object.freeze(Y.prototype);class Q{constructor(){B.set(this,void 0),(0,a.YH)(this,B,{joiner:void 0,group:void 0,game:void 0})}get joinerSocket(){return(0,a.Q_)(this,B).joiner}get groupSocket(){return(0,a.Q_)(this,B).group}get gameSocket(){return(0,a.Q_)(this,B).game}joinerSocketConnect(e){return(0,a.mG)(this,void 0,void 0,(function*(){const t=new((yield s.e(307).then(s.t.bind(s,307,23))).default.Manager)(e.serverUrl.toString(),{reconnectionAttempts:k.ZA.GameServerReconnectionAttempts,autoConnect:!1,transports:["websocket"]}).socket(k.b4.Nsps.GROUP_JOINER);return this._registerSocket(t,"joiner"),t.connect()}))}groupSocketConnect(e,t){return this._groupSocketHelper("group",e,t).connect()}gameSocketConnect(e,t){if(void 0===e||void 0===t.passphrase)throw new TypeError("never");return this._groupSocketHelper("game",e,t).connect()}_groupSocketHelper(e,t,s){let n;switch(e){case"group":n=k.b4.Nsps.GROUP_LOBBY_PREFIX;break;case"game":n=k.b4.Nsps.GROUP_GAME_PREFIX;break;default:throw new TypeError("never")}const i=this.joinerSocket.io.socket(n+t,{auth:s});return this._registerSocket(i,e),i}_registerSocket(e,t){(0,a.Q_)(this,B)[t]=e;const s=()=>{e.offAny(),(0,a.Q_)(this,B)[t]=void 0};e.on("connect_error",(e=>{console.warn(e),s()})).on("disconnect",(e=>{"io server disconnect"!==e&&"io client disconnect"!==e||(console.info(e),s())}))}}B=new WeakMap,o.R.protoNoEnum(Q,"joinerSocketConnect","groupSocketConnect","gameSocketConnect","_groupSocketHelper","_registerSocket"),Object.freeze(Q),Object.freeze(Q.prototype);class J{constructor(){Object.defineProperty(this,"defaultDocTitle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webpageHostType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"storage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"transition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),F.set(this,void 0),Object.defineProperty(this,"sockets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultDocTitle=document.title,this.webpageHostType=window.location.hostname.match(/github\.io/)?J.WebpageHostType.GITHUB:window.location.protocol.startsWith("file")?J.WebpageHostType.FILESYSTEM:J.WebpageHostType.SNAKEY_SERVER,o.R.propNoWrite(this,"defaultDocTitle","webpageHostType"),this.storage=n,this.sockets=new Q,this.transition=new Y,o.R.propNoWrite(this,"storage","sockets","transition");const e=document.getElementById(l.Y.Screen.Id.ALL_SCREENS);if(!e)throw new Error("never");o.R.prependComment(e,"ALL SCREENS CONTAINER"),(0,a.YH)(this,F,new W(this,e)),o.R.propNoWrite(this)}get clientIsGroupHost(){return(0,a.Q_)(this,F).dict.groupJoiner.clientIsGroupHost}get groupLoginInfo(){return(0,a.Q_)(this,F).dict.groupJoiner.loginInfo}toast(e){console.info(e)}confirm(e){return window.confirm(e)}get game(){var e;return null!==(e=(0,a.Q_)(this,F).dict.playOffline.probeCurrentGame)&&void 0!==e?e:(0,a.Q_)(this,F).dict.playOnline.probeCurrentGame}get currentScreen(){return(0,a.Q_)(this,F).currentScreen}}F=new WeakMap,function(e){let t;!function(e){e.GITHUB="github",e.FILESYSTEM="filesystem",e.SNAKEY_SERVER="sk-server"}(t=e.WebpageHostType||(e.WebpageHostType={}))}(J||(J={})),Object.freeze(J),Object.freeze(J.prototype),[Object,Array,Map,Set,WeakMap,WeakSet,String,Number,RegExp,HTMLElement,HTMLDivElement,HTMLSpanElement,HTMLPreElement,HTMLButtonElement,HTMLInputElement,HTMLSelectElement,HTMLOptionElement,HTMLScriptElement,HTMLStyleElement,HTMLLinkElement,HTMLAnchorElement,HTMLDocument,HTMLIFrameElement,HTMLCanvasElement].forEach((e=>{Object.freeze(e),Object.freeze(null==e?void 0:e.prototype)}));const V=new J,q=void 0;function K(){return V.currentScreen}function X(){return V.game}console.info("%c🩺 welcome! 🐍","font:700 2.3em /1.5 monospace; margin:0.4em; border:0.3em solid black;padding:0.4em; color:white; background-color:#3f5e77; border-radius:0.7em; "),V.webpageHostType===J.WebpageHostType.GITHUB&&"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/ServiceWorker.js").then((e=>{console.info("ServiceWorker registration successful with scope: ",e.scope)}),(e=>{console.info("ServiceWorker registration failed: ",e)}))}))},903:(e,t,s)=>{"use strict";function n(e,t,s,n){return new(s||(s=Promise))((function(i,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))}function i(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function r(e,t,s){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,s),s}s.d(t,{mG:()=>n,Q_:()=>i,YH:()=>r}),Object.create,Object.create}},0,[[897,280]]]);
//# sourceMappingURL=index.js.map