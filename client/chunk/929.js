(self.webpackChunksnakey3=self.webpackChunksnakey3||[]).push([[929],{173:(e,t,s)=>{"use strict";s.r(t)},305:(e,t,s)=>{"use strict";var r;s.d(t,{u:()=>r}),function(e){let t;!function(e){e.EUCLID2="EUCLID2",e.BEEHIVE="BEEHIVE"}(t=e.System||(e.System={})),e.equals=function(e,t){return e._equals(t)}}(r||(r={})),Object.freeze(r)},985:(e,t,s)=>{"use strict";s.d(t,{r:()=>a});var r=s(406),i=s(495);class a{constructor(e){this.static=e.gridClass,this.dimensions=e.dimensions,this.tile=new i.N(this),r.R.propNoWrite(this,["static","dimensions","tile"])}get area(){return this.static.getArea(this.dimensions)}reset(){this.forEachTile((e=>e.reset()))}getDestsFromSourcesTo(e){return Array.from(new Set(this.tile.sourcesTo(e).get.flatMap((e=>this.tile.destsFrom(e.coord).get))))}getRandomCoord(){return this.static.getRandomCoord(this.dimensions)}}!function(e){e.getImplementation=t=>e._Constructors[t]}(a||(a={}))},495:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});var r,i=s(655);class a{constructor(e){r.set(this,void 0),(0,i.YH)(this,r,e),Object.freeze(this)}get _source(){return(0,i.Q_)(this,r)}at(...e){return(0,i.Q_)(this,r)._getTileAt(...e)}destsFrom(...e){return new o((0,i.Q_)(this,r)._getTileDestsFrom(...e))}sourcesTo(...e){return new o((0,i.Q_)(this,r)._getTileSourcesTo(...e))}}r=new WeakMap,Object.freeze(a),Object.freeze(a.prototype);class o{constructor(e){this.contents=e,Object.seal(this)}get occupied(){return this.contents=this.contents.filter((e=>e.isOccupied)),this}get unoccupied(){return this.contents=this.contents.filter((e=>!e.isOccupied)),this}get get(){return this.contents}}Object.freeze(o),Object.freeze(o.prototype)},329:(e,t,s)=>{"use strict";s.d(t,{T:()=>r,z:()=>n});var r,i=s(80),a=s(406),o=s(780);!function(e){e.getImplementation=t=>e._Constructors[t]}(r||(r={}));class n{_superVisibleGrid(e,t){if(e.tileClass!==o.g)throw new TypeError("never");const s=i.Y.Grid;t.setAttribute("role","presentation"),t.classList.add(s.Class.IMPL_BODY),t.dataset[s.Dataset.IMPL_COORD_SYS]=e.coordSys,t.translate=!1,t.spellcheck=!1,this.baseElem=t;const r=a.R.mkEl("div",[i.Y.Player.Class.SHORT_SPOTLIGHT]),n=a.R.mkEl("div",[i.Y.Player.Class.LONG_SPOTLIGHT]);this.spotlightElems=Object.freeze([r,n])}}Object.freeze(n),Object.freeze(n.prototype)},780:(e,t,s)=>{"use strict";s.d(t,{g:()=>m});var r,i,a,o,n,h=s(655),l=s(406),c=s(80),d=s(951);class u{constructor(e){r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),this.coord=e,l.R.propNoWrite(this,["coord"]),(0,h.YH)(this,r,d.J5.Id.NULL)}reset(){this.evictOccupant(),this.lastKnownUpdateId=0,this.freeHealth=0,this.setLangCharSeqPair(d.Uo.CharSeqPair.NULL)}_setOccupant(e,t){(0,h.YH)(this,r,e)}get isOccupied(){return this.occupantId!==d.J5.Id.NULL}evictOccupant(){(0,h.YH)(this,r,d.J5.Id.NULL)}get occupantId(){return(0,h.Q_)(this,r)}get freeHealth(){return(0,h.Q_)(this,i)}set freeHealth(e){(0,h.YH)(this,i,e)}setLangCharSeqPair(e){(0,h.YH)(this,a,e.char),(0,h.YH)(this,o,e.seq)}get langChar(){return(0,h.Q_)(this,a)}get langSeq(){return(0,h.Q_)(this,o)}}r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,Object.freeze(u),Object.freeze(u.prototype);class m extends u{constructor(e){super(e),n.set(this,void 0),(0,h.YH)(this,n,l.R.mkEl("div",[c.Y.General.Class.CENTER_CONTENTS,c.Y.General.Class.STACK_CONTENTS,c.Y.Tile.Class.BASE])).setAttribute("aria-label","Tile");{const e=l.R.mkEl("div",[c.Y.Tile.Class.POINTER_HB]);e.setAttribute("aria-hidden","true"),(0,h.Q_)(this,n).appendChild(e)}{const e=l.R.mkEl("div",[c.Y.Tile.Class.LANG_CHAR_WRAP]);e.setAttribute("role","presentation");const t=this.langCharElem=l.R.mkEl("div",[]);e.appendChild(t),(0,h.Q_)(this,n).appendChild(e)}{const e=this.langSeqElem=l.R.mkEl("div",[c.Y.Tile.Class.LANG_SEQ]);e.setAttribute("role","tooltip"),(0,h.Q_)(this,n).appendChild(e)}l.R.propNoWrite(this,["langCharElem","langSeqElem"])}_addToDom(e){e.appendChild((0,h.Q_)(this,n))}_setOccupant(e,t){super._setOccupant(e,t),this.langCharElem.parentElement.insertAdjacentElement("beforebegin",t.playerElem),this.langSeqElem.textContent=t.username}evictOccupant(){super.evictOccupant(),this.langSeqElem.textContent=this.langSeq}set freeHealth(e){super.freeHealth=e,this.freeHealth>0?(0,h.Q_)(this,n).dataset[c.Y.Tile.Dataset.HEALTH]=this.freeHealth.toString():delete(0,h.Q_)(this,n).dataset[c.Y.Tile.Dataset.HEALTH]}get freeHealth(){return super.freeHealth}setLangCharSeqPair(e){super.setLangCharSeqPair(e),this.langCharElem.textContent=this.langChar,this.langSeqElem.textContent=this.langSeq}}n=new WeakMap,l.R.protoNoEnum(m,["_addToDom"]),Object.freeze(m),Object.freeze(m.prototype)},886:(e,t,s)=>{"use strict";s.d(t,{v:()=>r,y:()=>n});var r,i=s(406),a=s(985),o=s(329);!function(e){class t{constructor(e){this.dash=e.dash,this.bash=e.bash,Object.freeze(this)}_equals(e){return this.dash===e.dash&&this.bash===e.bash}round(){const e=Math.floor(this.dash),s=Math.floor(this.bash),r=e-this.dash,i=s-this.bash;return r>2*i?new t({dash:e+1,bash:s}):r<.5*i?new t({dash:e,bash:s+1}):Math.min(r,i)>.5?new t({dash:e+1,bash:s+1}):new t({dash:e,bash:s})}add(e){return new t({dash:this.dash+e.dash,bash:this.bash+e.bash})}sub(e){return new t({dash:this.dash-e.dash,bash:this.bash-e.bash})}mul(e){return new t({dash:e*this.dash,bash:e*this.bash})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);class s extends a.r{constructor(e){super(e),this.grid=Object.freeze(void 0)}static getAmbiguityThreshold(){return 18}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e){let t=0;for(const s of this.grid)for(const r of s)e(r,t++)}shuffledForEachTile(e){this.grid.flat().sort(((e,t)=>Math.random()-.5)).forEach((t=>e(t)))}getUntToward(e,t){}getUntAwayFrom(e,t){return this.getUntToward(t.add(t.sub(e)),t)}getRandomCoordAround(e,t){}_getTileAt(e){}_getTileDestsFrom(e,t=1){}_getTileSourcesTo(e,t=1){}minMovesFromTo(e,t){}getDestsFromSourcesTo(e){return this._getTileDestsFrom(e,2)}static getSpawnCoords(e,t){}static getArea(e){const t=Math.min(e.fslash,e.bslash),s=Math.max(e.fslash,e.bslash),r=-1+e.dash+t;let i=2*t*(e.dash+r);return i+=(s-t-1)*r,i}static getDiameterOfLatticePatchHavingArea(e){if(e<.25)throw new RangeError("determinant of a radical will be strictly negative.");return 1+(-3+Math.sqrt(9-12*(1-e)))/6*2}static getRandomCoord(e){return new t(void 0)}}s.SIZE_LIMITS=Object.freeze({dash:Object.freeze({min:10,max:50}),bslash:Object.freeze({min:10,max:50}),fslash:Object.freeze({min:10,max:50})}),e.Grid=s,i.R.protoNoEnum(s,["_getTileAt","_getTileDestsFrom","_getTileSourcesTo"]),Object.freeze(s),Object.freeze(s.prototype)}(r||(r={})),Object.freeze(r);class n extends r.Grid{constructor(e){super(e),this._superVisibleGrid(e,void 0)}}i.R.applyMixins(n,[o.z]),Object.freeze(n),Object.freeze(n.prototype)},358:(e,t,s)=>{"use strict";s.d(t,{i:()=>r,G:()=>n});var r,i=s(406),a=s(985),o=s(329);!function(e){class t{constructor(e){this.x=e.x,this.y=e.y,Object.freeze(this)}_equals(e){return this.x===e.x&&this.y===e.y}round(){return new t({x:Math.round(this.x),y:Math.round(this.y)})}oneNorm(e){return this.sub(e).originOneNorm()}originOneNorm(){return Math.abs(this.x)+Math.abs(this.y)}infNorm(e){return this.sub(e).originInfNorm()}originInfNorm(){return Math.max(Math.abs(this.x),Math.abs(this.y))}axialAlignment(e){return this.sub(e).originAxialAlignment()}originAxialAlignment(){return Math.abs(Math.abs(this.x)-Math.abs(this.y))/(Math.abs(this.x)+Math.abs(this.y))}add(e){return new t({x:this.x+e.x,y:this.y+e.y})}sub(e){return new t({x:this.x-e.x,y:this.y-e.y})}mul(e){return new t({x:e*this.x,y:e*this.y})}}e.Coord=t,Object.freeze(t),Object.freeze(t.prototype);class s extends a.r{constructor(e){super(e);const s=[];for(let r=0;r<this.dimensions.height;r++){const i=[];for(let s=0;s<this.dimensions.width;s++){const a=new e.tileClass(new t({x:s,y:r}));i.push(a)}s.push(Object.freeze(i))}this.grid=Object.freeze(s)}static getAmbiguityThreshold(){return 24}static getSizeLimits(){return this.SIZE_LIMITS}forEachTile(e){let t=0;for(const s of this.grid)for(const r of s)e(r,t++)}shuffledForEachTile(e){this.grid.flat().sort(((e,t)=>Math.random()-.5)).forEach((t=>e(t)))}getUntToward(e,t){const s=this.tile.destsFrom(t).unoccupied.get;if(0===s.length)return this.tile.at(t);if(1===s.length)return s[0];s.sort(((t,s)=>t.coord.oneNorm(e)-s.coord.oneNorm(e))).sort(((t,s)=>t.coord.infNorm(e)-s.coord.infNorm(e)));for(let t=1;t<s.length;t++)if(s[t].coord.infNorm(e)>s[0].coord.infNorm(e)){s.splice(t);break}if(1===s.length)return s[0];if(s[0].coord.x-t.x==0||s[0].coord.y-t.y==0){if(t.axialAlignment(t.sub(e))-.5>0)return s[0];s.shift()}return s[Math.floor(s.length*Math.random())]}getUntAwayFrom(e,t){return this.getUntToward(t.add(t.sub(e)),t)}getDestsFromSourcesTo(e){return this._getTileDestsFrom(e,2)}getRandomCoordAround(e,s){return new t({x:e.x+Math.trunc(2*s*(Math.random()-.5)),y:e.y+Math.trunc(2*s*(Math.random()-.5))})}_getTileAt(e){return this.grid[e.y][e.x]}_getTileDestsFrom(e,t=1){let s=e.y-t,r=e.y+t+1,i=e.x-t,a=e.x+t+1;return s>=this.dimensions.height||r<0||i>=this.dimensions.width||a<0?[]:this.grid.slice(Math.max(0,s),Math.min(this.dimensions.height,r)).flatMap((e=>e.slice(Math.max(0,i),Math.min(this.dimensions.width,a))))}_getTileSourcesTo(e,t=1){return this._getTileDestsFrom(e,t)}minMovesFromTo(e,t){return Math.min(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}static getSpawnCoords(e,t){const r=[];return e.map((e=>{const i=[];for(;e>0;){let a;do{a=s.getRandomCoord(t)}while(r.find((e=>a._equals(e))));i.push(a),r.push(a),e--}return i}))}static getArea(e){return e.height*e.width}static getDiameterOfLatticePatchHavingArea(e){return Math.sqrt(e)}static getRandomCoord(e){const s=Math.floor(e.width*Math.random()),r=Math.floor(e.height*Math.random());return new t({x:s,y:r})}}s.SIZE_LIMITS=Object.freeze({height:Object.freeze({min:11,max:51}),width:Object.freeze({min:11,max:51})}),e.Grid=s,i.R.protoNoEnum(s,["_getTileAt","_getTileDestsFrom","_getTileSourcesTo"]),Object.freeze(s),Object.freeze(s.prototype)}(r||(r={})),Object.freeze(r);class n extends r.Grid{constructor(e){super(e);const t=i.R.mkEl("div",[]);t.style.setProperty("--euclid2-grid-width",this.dimensions.width.toString());for(const e of this.grid)for(const s of e)s._addToDom(t);this._superVisibleGrid(e,t)}}i.R.applyMixins(n,[o.z]),Object.freeze(n),Object.freeze(n.prototype)},671:(e,t,s)=>{"use strict";var r;s.d(t,{L:()=>r}),function(e){e.EVENT_ID_REJECT=-1}(r||(r={})),Object.freeze(r)},699:(e,t,s)=>{"use strict";s.d(t,{a:()=>r});var r,i=s(671);!function(e){e.INITIAL_REQUEST_ID=-1,e.EVENT_NAME=Object.freeze({BUBBLE:"player-bubble",MOVEMENT:"player-movement"});class t{constructor(e,t){this.eventId=i.L.EVENT_ID_REJECT,this.affectedNeighbours=void 0,this.playerId=e,this.playerLastAcceptedRequestId=t}}e.Bubble=t,e.Movement=class extends t{constructor(e,t,s,r){super(e,t),this.newPlayerHealth=void 0,this.tileHealthModDescs=void 0,this.destModDesc={coord:s.coord,lastKnownUpdateId:s.lastKnownUpdateId,newCharSeqPair:void 0,newFreeHealth:void 0},this.moveType=r}}}(r||(r={})),Object.freeze(r)},191:(e,t,s)=>{"use strict";s.d(t,{R:()=>f});var r,i,a,o,n=s(655),h=s(504),l=s(671),c=(s(699),s(406)),d=s(951),u=s(926),m=s(473);class p{constructor(e,t,s){r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),this.gameType=e;const o=this._getGridImplementation(s.coordSys);this.grid=new o({gridClass:o,tileClass:t.tileClass,coordSys:s.coordSys,dimensions:s.gridDimensions}),(0,n.YH)(this,r,t.onGameBecomeOver),this.langFrontend=d.Uo.GET_FRONTEND_DESC_BY_ID(s.langId),this._playerStatusCtor=t.playerStatusCtor,this.players=this.createPlayers(s),this.operators=Object.freeze(this.players.filter((e=>e.isALocalOperator))),this.setCurrentOperator(0);{const e=[];if(this.players.forEach((t=>{e[t.teamId]||(e[t.teamId]=[]),e[t.teamId].push(t)})),this.teams=e.map(((e,t)=>new m.S(t,e))),this.teams.every((e=>e.id===m.S.ElimOrder.IMMORTAL)))throw new Error("All teams are immortal. The game will never end.")}c.R.propNoWrite(this,["gameType","grid","langFrontend","players","operators","teams","_playerStatusCtor"]),this.players.forEach((e=>e._afterAllPlayersConstruction()))}reset(){return(0,n.mG)(this,void 0,void 0,(function*(){this.grid.reset(),(0,n.YH)(this,a,h.l.Status.PAUSED)}))}createPlayers(e){const t=e.playerDescs=this.gameType===h.l.Type.ONLINE?e.playerDescs:u.J5.CtorArgs.finalize(e.playerDescs);return Object.freeze(t.map((e=>e.familyId===u.J5.Family.HUMAN?e.isALocalOperator?this._createOperatorPlayer(e):new u.J5(this,e):this._createArtifPlayer(e))))}serializeResetState(){const e=[],t=this.players.map((e=>e.coord)),s=[];return this.grid.forEachTile((t=>{t.lastKnownUpdateId++,e.push({char:t.langChar,seq:t.langSeq}),t.freeHealth&&s.push({coord:t.coord,health:t.freeHealth})})),{csps:e,playerCoords:t,healthCoords:s}}deserializeResetState(e){this.grid.forEachTile(((t,s)=>{t.setLangCharSeqPair(e.csps[s]),t.lastKnownUpdateId++})),e.playerCoords.forEach(((e,t)=>{this.players[t].reset(this.grid.tile.at(e))})),e.healthCoords.forEach((e=>{this.grid.tile.at(e.coord).freeHealth=e.health}))}get currentOperator(){return(0,n.Q_)(this,i)}setCurrentOperator(e){const t=this.operators[e];this.currentOperator!==t&&(t._notifyWillBecomeCurrent(),(0,n.YH)(this,i,t))}get status(){return(0,n.Q_)(this,a)}statusBecomePlaying(){if(this.status!==h.l.Status.PLAYING){if(this.status!==h.l.Status.PAUSED)throw new Error("Can only resume a game that is currently paused.");this.players.forEach((e=>{e._notifyGameNowPlaying()})),(0,n.YH)(this,a,h.l.Status.PLAYING)}else console.info("[statusBecomePlaying]: Game is already playing")}statusBecomePaused(){this.status!==h.l.Status.PAUSED?this.status!==h.l.Status.OVER&&(this.players.forEach((e=>{e._notifyGameNowPaused()})),(0,n.YH)(this,a,h.l.Status.PAUSED)):console.info("[statusBecomePaused]: Game is already paused")}statusBecomeOver(){this.status!==h.l.Status.OVER&&(this.players.forEach((e=>{e._notifyGameNowOver()})),(0,n.YH)(this,a,h.l.Status.OVER),(0,n.Q_)(this,r).call(this),console.info("game is over!"))}}r=new WeakMap,i=new WeakMap,a=new WeakMap,c.R.protoNoEnum(p,[]),Object.freeze(p),Object.freeze(p.prototype);class f extends p{constructor(e,t,s){super(e,t,s),o.set(this,void 0),this.eventRecordBitmap=[]}reset(){const e=super.reset();return this.eventRecordBitmap.fill(!1,0,h.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH),(0,n.YH)(this,o,0),e}get nextUnusedEventId(){return(0,n.Q_)(this,o)}_recordEvent(e){const t=e.eventId,s=t%h.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH;if(t===l.L.EVENT_ID_REJECT)throw new TypeError("Do not try to record events for rejected requests.");if(t<0||t!==Math.trunc(t))throw new RangeError("Event ID's must only be assigned positive, integer values.");if(this.eventRecordBitmap[s])throw new Error("Event ID's must be assigned unique values.");this.eventRecordBitmap[s]=!0,this.eventRecordBitmap[(t+h.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH-h.l.K.EVENT_RECORD_FORWARD_WINDOW_LENGTH)%h.l.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH]=!1,(0,n.YH)(this,o,+(0,n.Q_)(this,o)+1)}executeTileModEvent(e,t=!0){Object.freeze(e);const s=this.grid.tile.at(e.coord);if(s.lastKnownUpdateId>e.lastKnownUpdateId)return s;if(s.lastKnownUpdateId===e.lastKnownUpdateId)throw new RangeError("never");return e.newCharSeqPair&&(s.setLangCharSeqPair(e.newCharSeqPair),t&&this.operators.filter((e=>e.tile.destsFrom().get.includes(s))).forEach((e=>e.seqBufferAcceptKey("")))),s.lastKnownUpdateId=e.lastKnownUpdateId,s.freeHealth=e.newFreeHealth,s}executePlayerMoveEvent(e){var t;const s=this.players[e.playerId],r=e.playerLastAcceptedRequestId-s.lastAcceptedRequestId;if(e.eventId===l.L.EVENT_ID_REJECT)return void(0===r&&(s.requestInFlight=!1));this._recordEvent(e);const i=this.executeTileModEvent(e.destModDesc,s!==this.currentOperator);if(null===(t=e.tileHealthModDescs)||void 0===t||t.forEach((e=>{this.executeTileModEvent(e)})),r>1){if(s===this.currentOperator)throw new Error("never")}else{if(s.requestInFlight=!1,!(s===this.currentOperator?1===r:r<=1))throw new RangeError("never");s.status.health=e.newPlayerHealth.health,s.moveTo(i),s.lastAcceptedRequestId=e.playerLastAcceptedRequestId}}executePlayerBubbleEvent(e){this.players[e.playerId].requestInFlight=!1,e.eventId!==l.L.EVENT_ID_REJECT&&this._recordEvent(e)}}o=new WeakMap,Object.freeze(f),Object.freeze(f.prototype)},926:(e,t,s)=>{"use strict";s.d(t,{J5:()=>d});var r,i=s(406),a=s(504),o=s(699),n=s(655),h=s(951),l=s(495);class c extends h.J5{constructor(e,t){if(super(),r.set(this,void 0),Math.trunc(t.playerId)!==t.playerId)throw new RangeError("Player ID's must be integer values.");this.playerId=t.playerId,this.isALocalOperator=t.isALocalOperator,this.game=e,this.status=new this.game._playerStatusCtor(this,t.noCheckGameOver),this.tile=new l.N(new c.TileGetterSource(this)),i.R.instNoEnum(this,["game"]),i.R.propNoWrite(this,["playerId","isALocalOperator","game","status","tile"])}_afterAllPlayersConstruction(){this.status._afterAllPlayersConstruction()}reset(e){(0,n.YH)(this,r,e),this.hostTile._setOccupant(this.playerId,this.status.immigrantInfo)}get coord(){return this.hostTile.coord}get hostTile(){return(0,n.Q_)(this,r)}moveTo(e){if(this.hostTile.occupantId!==this.playerId){if(this.game.gameType!==a.l.Type.ONLINE)throw new Error("Linkage between player and occupied tile disagrees.")}else this.hostTile.evictOccupant();if(e.isOccupied){if(this.game.gameType!==a.l.Type.ONLINE)throw new Error("Only one player can occupy a tile at a time.")}else(0,n.YH)(this,r,e),e._setOccupant(this.playerId,this.status.immigrantInfo)}}r=new WeakMap,function(e){var t,s;class r{constructor(e){t.set(this,void 0),s.set(this,void 0),(0,n.YH)(this,t,e),(0,n.YH)(this,s,e.game.grid.tile._source)}_getTileAt(){return(0,n.Q_)(this,s)._getTileAt((0,n.Q_)(this,t).coord)}_getTileDestsFrom(){return(0,n.Q_)(this,s)._getTileDestsFrom((0,n.Q_)(this,t).coord)}_getTileSourcesTo(){return(0,n.Q_)(this,s)._getTileSourcesTo((0,n.Q_)(this,t).coord)}}t=new WeakMap,s=new WeakMap,e.TileGetterSource=r,Object.freeze(r),Object.freeze(r.prototype)}(c||(c={})),i.R.protoNoEnum(c,["_afterAllPlayersConstruction"]),Object.freeze(c),Object.freeze(c.prototype),s(448);class d extends c{constructor(e,t){var s;super(e,t),this.familyId=t.familyId,this.teamId=t.teamId,this.username=t.username,this.avatar=null!==(s=t.avatar)&&void 0!==s?s:d.Avatar.GET_RANDOM(),i.R.propNoWrite(this,["familyId","teamId","username","avatar"])}reset(e){super.reset(e),this.status.reset(),this.lastAcceptedRequestId=o.a.INITIAL_REQUEST_ID,this.requestInFlight=!1}_notifyGameNowPlaying(){}_notifyGameNowPaused(){}_notifyGameNowOver(){}makeMovementRequest(e,t){if(this.game.status!==a.l.Status.PLAYING)throw new Error("This is not a necessary precondition, but we're doing it anyway.");if(this.requestInFlight)throw new Error("Only one request should ever be in flight at a time.");this.requestInFlight=!0,this.game.processMoveRequest(new o.a.Movement(this.playerId,this.lastAcceptedRequestId,e,t))}get team(){return this.game.teams[this.teamId]}isTeamedWith(e){return this.team.members.includes(e)}}!function(e){let t;!function(e){e.finalize=function(e){const t=Array.from(new Set(e.map((e=>e.teamId)))).sort(((e,t)=>e-t)).reduce(((e,t,s)=>(e[t]=s,e)),[]);return e.slice().sort(((e,s)=>t[e.teamId]-t[s.teamId])).map(((e,s)=>Object.assign({},e,{playerId:s,teamId:t[e.teamId]})))}}(t=e.CtorArgs||(e.CtorArgs={})),Object.freeze(t)}(d||(d={})),i.R.protoNoEnum(d,["_notifyGameNowPaused","_notifyGameNowPlaying","_notifyGameNowOver"]),Object.freeze(d),Object.freeze(d.prototype)},448:(e,t,s)=>{"use strict";s.d(t,{c:()=>n});var r,i=s(655),a=s(406),o=s(473);class n{constructor(e,t){r.set(this,void 0),this.player=e,this.noCheckGameOver=t,a.R.instNoEnum(this,["player"])}reset(){this.health=0}_afterAllPlayersConstruction(){}get immigrantInfo(){}get health(){return(0,i.Q_)(this,r)}set health(e){const t=this.isDowned;if((0,i.YH)(this,r,e),t||!this.isDowned||this.noCheckGameOver)return;const s=this.player.team,a=this.player.game.teams;if(s.elimOrder===o.S.ElimOrder.STANDING&&s.members.every((e=>e.status.noCheckGameOver||e.status.isDowned))){const e=1+a.filter((e=>e.elimOrder!==o.S.ElimOrder.STANDING)).length;s.elimOrder=1+a.filter((e=>e.elimOrder!==o.S.ElimOrder.STANDING&&e.elimOrder!==o.S.ElimOrder.IMMORTAL)).length,e===a.length&&this.player.game.statusBecomeOver()}}get isDowned(){return this.health<0}}r=new WeakMap,a.R.protoNoEnum(n,["_afterAllPlayersConstruction"]),Object.freeze(n),Object.freeze(n.prototype)},473:(e,t,s)=>{"use strict";s.d(t,{S:()=>o});var r,i=s(655),a=s(406);class o{constructor(e,t){if(r.set(this,void 0),0===t.length)throw new Error("Teams must have at least one member.");this.id=e,this.members=t,(0,i.YH)(this,r,this.members.every((e=>e.status.noCheckGameOver))?o.ElimOrder.IMMORTAL:o.ElimOrder.STANDING),a.R.propNoWrite(this,["id","members"])}reset(){this.elimOrder!==o.ElimOrder.IMMORTAL&&(this.elimOrder=o.ElimOrder.STANDING)}get elimOrder(){return(0,i.Q_)(this,r)}set elimOrder(e){if(this.elimOrder===o.ElimOrder.IMMORTAL)throw new TypeError("Cannot change the elimination status of an immortal team.");(0,i.YH)(this,r,e)}}r=new WeakMap,function(e){let t;!function(e){e.IMMORTAL=-1,e.STANDING=0}(t=e.ElimOrder||(e.ElimOrder={}))}(o||(o={})),Object.freeze(o),Object.freeze(o.prototype)},153:(e,t,s)=>{"use strict";s.d(t,{qM:()=>b,lA:()=>o.l,RQ:()=>a.R,J5:()=>l.J5,Ko:()=>O,gx:()=>n.g});var r,i,a=s(406),o=s(504),n=s(780),h=s(329),l=s(926),c=s(655),d=s(951),u=s(305);class m extends l.J5{constructor(e,t){super(e,t),r.set(this,void 0),i.set(this,void 0),(0,c.YH)(this,i,this.game.langFrontend.remapFunc)}reset(e){super.reset(e),this.prevCoord=e.coord,(0,c.YH)(this,r,"")}processKeyboardInput(e){this.game.status===o.l.Status.PLAYING&&(this.requestInFlight||(" "===e.key?u.u.equals(this.coord,this.prevCoord)||this.makeMovementRequest(this.game.grid.getUntAwayFrom(this.prevCoord,this.coord),l.J5.MoveType.BOOST):1!==e.key.length||e.repeat||this.seqBufferAcceptKey(e.key)))}seqBufferAcceptKey(e){const t=this.tile.destsFrom().unoccupied.get;if(0!==t.length)if(e){if(e=(0,c.Q_)(this,i).call(this,e),d.Uo.Seq.REGEXP.test(e)){for(let s=this.seqBuffer+e;s.length;s=s.substring(1)){const e=t.find((e=>e.langSeq.startsWith(s)));if(e)return(0,c.YH)(this,r,s),void(e.langSeq===s&&this.makeMovementRequest(e,l.J5.MoveType.NORMAL))}(0,c.YH)(this,r,""),this.status.visualBell()}}else t.find((e=>e.langSeq.startsWith(this.seqBuffer)))||(0,c.YH)(this,r,"")}moveTo(e){(0,c.YH)(this,r,""),this.prevCoord=this.coord,super.moveTo(e)}_notifyWillBecomeCurrent(){this.status._notifyWillBecomeCurrent(this.game.grid.spotlightElems)}get seqBuffer(){return(0,c.Q_)(this,r)}}r=new WeakMap,i=new WeakMap,a.R.protoNoEnum(m,["_notifyWillBecomeCurrent"]),Object.freeze(m),Object.freeze(m.prototype);var p,f,g,E=s(80),y=s(448);class O extends y.c{constructor(e,t){super(e,t),p.set(this,void 0),f.set(this,void 0),g.set(this,void 0),(0,c.YH)(this,p,a.R.mkEl("div",[E.Y.General.Class.CENTER_CONTENTS,E.Y.General.Class.STACK_CONTENTS,E.Y.Player.Class.BASE]));{const e=a.R.mkEl("div",[E.Y.Player.Class.FACE],{});(0,c.YH)(this,f,this.player.isALocalOperator?[e.animate({filter:["brightness(0.7)","brightness(1.0)"]},{duration:300,easing:"ease-in",delay:1}),e.animate({transform:O.makeWiggleAnimation(10,2)},{duration:270,easing:"ease-out",delay:1})]:[]).forEach((e=>e.pause())),e.appendChild(a.R.mkEl("div",[E.Y.Player.Class.DOWNED_OVERLAY])),(0,c.Q_)(this,p).appendChild(e)}}_afterAllPlayersConstruction(){(0,c.YH)(this,g,Object.freeze({playerElem:(0,c.Q_)(this,p),username:this.player.username}))}reset(){super.reset();const e=E.Y.Player.Dataset.DOWNED;(0,c.Q_)(this,p).dataset[e.KEY]=e.VALUES.NO}get immigrantInfo(){return(0,c.Q_)(this,g)}_notifyWillBecomeCurrent(e){const t=this.player.game.currentOperator,s=this.player;requestAnimationFrame((t=>{e.forEach((e=>{(0,c.Q_)(this,p).appendChild(e)})),s.status.immigrantInfo.playerElem.scrollIntoView(d.Bl)})),s.teamId!==(null==t?void 0:t.teamId)&&s.game.players.forEach((e=>{const t=e.teamId===s.teamId;(0,c.Q_)(e.status,p).dataset[E.Y.Player.Dataset.FACE_SWATCH]=e.isALocalOperator?t?"me":"meOppo":t?"teammate":"opponent"}))}visualBell(){(0,c.Q_)(this,f),window.requestAnimationFrame((e=>{(0,c.Q_)(this,f).forEach((e=>e.play()))}))}get health(){return super.health}set health(e){const t=this.isDowned;if(super.health=e,t!==this.isDowned){const e=E.Y.Player.Dataset.DOWNED;(0,c.Q_)(this,p).dataset[e.KEY]=this.isDowned?this.player.team.elimOrder?e.VALUES.TEAM:e.VALUES.SELF:e.VALUES.NO}}}p=new WeakMap,f=new WeakMap,g=new WeakMap,function(e){var t,s,r;e.makeWiggleAnimation=function(e,t){const s=Array(2*t).fill(e);return s.unshift(0),s.push(0),s.map(((e,t)=>`translate(${t%2?e:-e}%)`))},t=new WeakMap,s=new WeakMap,r=new WeakMap,e.Card=class{constructor(e){t.set(this,void 0),s.set(this,void 0),r.set(this,void 0),this.baseElem=a.R.mkEl("div",[]),this.baseElem.setAttribute("label","Player");const i=(0,c.YH)(this,t,a.R.mkEl("div",[],{textContent:e}));this.baseElem.appendChild(i)}}}(O||(O={})),a.R.protoNoEnum(O,["_afterAllPlayersConstruction"]),Object.freeze(O),Object.freeze(O.prototype);var _=s(358),T=s(886);s(173),(()=>{const e=h.T;e._Constructors=Object.freeze({EUCLID2:_.G,BEEHIVE:T.y}),Object.freeze(e)})();class b{_ctorBrowserGame(){this.htmlElements=Object.freeze({gridImpl:this.grid.baseElem,playersBar:document.createElement("div")}),a.R.propNoWrite(this,["htmlElements"])}_getGridImplementation(e){return h.T.getImplementation(e)}_createOperatorPlayer(e){return new m(this,e)}}a.R.protoNoEnum(b,["_getGridImplementation"]),Object.freeze(b),Object.freeze(b.prototype)}}]);
//# sourceMappingURL=929.js.map